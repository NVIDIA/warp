

<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Python Reference &#8212; Warp 1.9.1</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/nvidia-sphinx-theme.css?v=df3ac72c" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=8524295a" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=60b3a732"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=fd10adb8"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'modules/runtime';</script>
    <link rel="icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Built-Ins Reference" href="functions.html" />
    <link rel="prev" title="Profiling" href="../profiling.html" />

  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="1.9.1" />


  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/nvidia-logo-horiz-rgb-blk-for-screen.svg" class="logo__image only-light" alt="Warp 1.9.1 - Home"/>
    <img src="../_static/nvidia-logo-horiz-rgb-wht-for-screen.svg" class="logo__image only-dark pst-js-only" alt="Warp 1.9.1 - Home"/>
  
  
    <p class="title logo__title">Warp 1.9.1</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/NVIDIA/warp" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/warp-lang" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-python fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        



  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/nvidia-logo-horiz-rgb-blk-for-screen.svg" class="logo__image only-light" alt="Warp 1.9.1 - Home"/>
    <img src="../_static/nvidia-logo-horiz-rgb-wht-for-screen.svg" class="logo__image only-dark pst-js-only" alt="Warp 1.9.1 - Home"/>
  
  
    <p class="title logo__title">Warp 1.9.1</p>
  
</a>


  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/NVIDIA/warp" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/warp-lang" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-python fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">



<nav class="bd-docs-nav bd-links"
     aria-label="Table of Contents">
  <p class="bd-links__title" role="heading" aria-level="1">Table of Contents</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">User's Guide</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basics.html">Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="devices.html">Devices</a></li>
<li class="toctree-l1"><a class="reference internal" href="differentiability.html">Differentiability</a></li>
<li class="toctree-l1"><a class="reference internal" href="generics.html">Generics</a></li>
<li class="toctree-l1"><a class="reference internal" href="tiles.html">Tiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="interoperability.html">Interoperability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../debugging.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../limitations.html">Limitations</a></li>
<li class="toctree-l1"><a class="reference internal" href="contribution_guide.html">Contribution Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../publications.html">Publications using Warp</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Advanced Topics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../codegen.html">Code Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="allocators.html">Allocators</a></li>
<li class="toctree-l1"><a class="reference internal" href="concurrency.html">Concurrency</a></li>
<li class="toctree-l1"><a class="reference internal" href="../profiling.html">Profiling</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Core Reference</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Python Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="functions.html">Built-Ins Reference</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Simulation Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="sim.html">warp.sim</a></li>
<li class="toctree-l1"><a class="reference internal" href="sparse.html">warp.sparse</a></li>
<li class="toctree-l1"><a class="reference internal" href="fem.html">warp.fem</a></li>
<li class="toctree-l1"><a class="reference internal" href="render.html">warp.render</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Project Links</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://github.com/NVIDIA/warp">GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pypi.org/project/warp-lang">PyPI</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>



      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Python Reference</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="python-reference">
<h1>Python Reference<a class="headerlink" href="#python-reference" title="Link to this heading">#</a></h1>
<p>This section describes the Warp Python runtime API, how to manage memory, launch kernels, and high-level functionality
for dealing with objects such as meshes and volumes. The APIs described in this section are intended to be used at
the <em>Python Scope</em> and run inside the CPython interpreter. For a comprehensive list of functions available at
the <em>Kernel Scope</em>, please see the <a class="reference internal" href="functions.html"><span class="doc">Built-Ins Reference</span></a> section.</p>
<section id="kernels">
<h2>Kernels<a class="headerlink" href="#kernels" title="Link to this heading">#</a></h2>
<p>Kernels are defined via Python functions that are annotated with the <a class="reference internal" href="#warp.kernel" title="warp.kernel"><code class="xref py py-func docutils literal notranslate"><span class="pre">&#64;wp.kernel</span></code></a> decorator.
All arguments of the Python function must be annotated with their respective type.
The following example shows a simple kernel that adds two arrays together:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">warp</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">wp</span>

<span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">add_kernel</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">),</span> <span class="n">b</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">),</span> <span class="n">c</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)):</span>
    <span class="n">tid</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">tid</span><span class="p">()</span>
    <span class="n">c</span><span class="p">[</span><span class="n">tid</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">tid</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="n">tid</span><span class="p">]</span>
</pre></div>
</div>
<p>Kernels are launched with the <a class="reference internal" href="#warp.launch" title="warp.launch"><code class="xref py py-func docutils literal notranslate"><span class="pre">wp.launch()</span></code></a> function on a specific device (CPU/GPU):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wp</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span><span class="n">add_kernel</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">],</span> <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="n">c</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that all the kernel inputs and outputs must live on the target device or a runtime exception will be raised.</p>
<p>Unless you are using the <a class="reference internal" href="differentiability.html#visualizing-computation-graphs"><span class="std std-ref">Graph visualization tool</span></a>, the <code class="docutils literal notranslate"><span class="pre">outputs</span></code> argument is optional – all kernel
arguments may be passed as inputs, but for readability it is sometimes useful to distinguish between the
kernel arguments that are read from (<code class="docutils literal notranslate"><span class="pre">inputs</span></code>) and the kernel arguments that are written to (<code class="docutils literal notranslate"><span class="pre">outputs</span></code>).
So in the above example, it would be equally valid to write <code class="docutils literal notranslate"><span class="pre">inputs=[a,</span> <span class="pre">b,</span> <span class="pre">c]</span></code> but since we are writing to <code class="docutils literal notranslate"><span class="pre">c</span></code>,
we list it in the <code class="docutils literal notranslate"><span class="pre">outputs</span></code> argument. Note that the combined <code class="docutils literal notranslate"><span class="pre">inputs</span></code> followed by <code class="docutils literal notranslate"><span class="pre">outputs</span></code> list
should match the ordering of the kernel arguments.</p>
<p>Kernels may be launched with multi-dimensional grid bounds.
In this case, threads are not assigned a single index, but a coordinate in an n-dimensional grid, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wp</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span><span class="n">complex_kernel</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>Launches a 3D grid of threads with dimension 128 x 128 x 3. To retrieve the 3D index for each thread, use the following syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">tid</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently, kernels launched on CPU devices will be executed in serial.
Kernels launched on CUDA devices will be launched in parallel with a fixed block-size.</p>
</div>
<p>In the Warp <a class="reference internal" href="../basics.html#compilation-model"><span class="std std-ref">Compilation Model</span></a>, kernels are just-in-time compiled into dynamic libraries and PTX using
C++/CUDA as an intermediate representation.
To avoid excessive runtime recompilation of kernel code, these files are stored in a cache directory
named with a module-dependent hash to allow for the reuse of previously compiled modules.
The location of the kernel cache is printed when Warp is initialized.
<a class="reference internal" href="#warp.clear_kernel_cache" title="warp.clear_kernel_cache"><code class="xref py py-func docutils literal notranslate"><span class="pre">wp.clear_kernel_cache()</span></code></a> can be used to clear the kernel cache of previously
generated compilation artifacts as Warp does not automatically try to keep the cache below a certain size.</p>
<dl class="py function">
<dt class="sig sig-object py" id="warp.kernel">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_backward</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L1069-L1142"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.kernel" title="Link to this definition">#</a></dt>
<dd><p>Decorator to register a Warp kernel from a Python function.
The function must be defined with type annotations for all arguments.
The function must not return anything.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">my_kernel</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">),</span> <span class="n">b</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)):</span>
    <span class="n">tid</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">tid</span><span class="p">()</span>
    <span class="n">b</span><span class="p">[</span><span class="n">tid</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">tid</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1.0</span>


<span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">enable_backward</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">my_kernel_no_backward</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
    <span class="c1"># the backward pass will not be generated</span>
    <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">tid</span><span class="p">()</span>
    <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>


<span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="s2">&quot;unique&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">my_kernel_unique_module</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">),</span> <span class="n">b</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)):</span>
    <span class="c1"># the kernel will be registered in new unique module created just for this</span>
    <span class="c1"># kernel and its dependent functions and structs</span>
    <span class="n">tid</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">tid</span><span class="p">()</span>
    <span class="n">b</span><span class="p">[</span><span class="n">tid</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">tid</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1.0</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><em>Callable</em></a><em> | </em><em>None</em>) – The function to be registered as a kernel.</p></li>
<li><p><strong>enable_backward</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a><em> | </em><em>None</em>) – If False, the backward pass will not be generated.</p></li>
<li><p><strong>module</strong> (<em>Module</em><em> | </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'unique'</em><em>] </em><em>| </em><em>None</em>) – The <code class="xref py py-class docutils literal notranslate"><span class="pre">warp.context.Module</span></code> to which the kernel belongs. Alternatively, if a string <cite>“unique”</cite> is provided, the kernel is assigned to a new module named after the kernel name and hash. If None, the module is inferred from the function’s module.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The registered kernel.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.launch">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">launch</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">adj_inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">adj_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">adjoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">record_tape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">record_cmd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">max_blocks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">block_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L6125-L6358"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.launch" title="Link to this definition">#</a></dt>
<dd><p>Launch a Warp kernel on the target device</p>
<p>Kernel launches are asynchronous with respect to the calling Python thread.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kernel</strong> – The name of a Warp kernel function, decorated with the <code class="docutils literal notranslate"><span class="pre">&#64;wp.kernel</span></code> decorator</p></li>
<li><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em>) – The number of threads to launch the kernel, can be an integer or a
sequence of integers with a maximum of 4 dimensions.</p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><em>Sequence</em></a>) – The input parameters to the kernel (optional)</p></li>
<li><p><strong>outputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><em>Sequence</em></a>) – The output parameters (optional)</p></li>
<li><p><strong>adj_inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><em>Sequence</em></a>) – The adjoint inputs (optional)</p></li>
<li><p><strong>adj_outputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><em>Sequence</em></a>) – The adjoint outputs (optional)</p></li>
<li><p><strong>device</strong> (<a class="reference internal" href="devices.html#warp.context.Device" title="warp.context.Device"><em>Device</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – The device to launch on.</p></li>
<li><p><strong>stream</strong> (<a class="reference internal" href="#warp.Stream" title="warp.context.Stream"><em>Stream</em></a><em> | </em><em>None</em>) – The stream to launch on.</p></li>
<li><p><strong>adjoint</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – Whether to run forward or backward pass (typically use <code class="docutils literal notranslate"><span class="pre">False</span></code>).</p></li>
<li><p><strong>record_tape</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – When <code class="docutils literal notranslate"><span class="pre">True</span></code>, the launch will be recorded the global
<a class="reference internal" href="differentiability.html#warp.Tape" title="warp.Tape"><code class="xref py py-class docutils literal notranslate"><span class="pre">wp.Tape()</span></code></a> object when present.</p></li>
<li><p><strong>record_cmd</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – When <code class="docutils literal notranslate"><span class="pre">True</span></code>, the launch will return a <a class="reference internal" href="#warp.Launch" title="warp.Launch"><code class="xref py py-class docutils literal notranslate"><span class="pre">Launch</span></code></a>
object. The launch will not occur until the user calls
<a class="reference internal" href="#warp.Launch.launch" title="warp.Launch.launch"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Launch.launch()</span></code></a>.</p></li>
<li><p><strong>max_blocks</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The maximum number of CUDA thread blocks to use.
Only has an effect for CUDA kernel launches.
If negative or zero, the maximum hardware value will be used.</p></li>
<li><p><strong>block_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The number of threads per block (always 1 for “cpu” devices).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.launch_tiled">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">launch_tiled</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L6360-L6420"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.launch_tiled" title="Link to this definition">#</a></dt>
<dd><p>A helper method for launching a grid with an extra trailing dimension equal to the block size.</p>
<p>For example, to launch a 2D grid, where each element has 64 threads assigned you would use the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">wp</span><span class="o">.</span><span class="n">launch_tiled</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="p">[</span><span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">],</span> <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="o">...</span><span class="p">],</span> <span class="n">block_dim</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
</pre></div>
</div>
<p>Which is equivalent to the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">wp</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="p">[</span><span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="mi">64</span><span class="p">],</span> <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="o">...</span><span class="p">],</span> <span class="n">block_dim</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
</pre></div>
</div>
<p>Inside your kernel code you can retrieve the first two indices of the thread as usual, ignoring the implicit third dimension if desired:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">()</span>

    <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">tid</span><span class="p">()</span>

    <span class="o">...</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.clear_kernel_cache">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">clear_kernel_cache</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/build.py#L146-L166"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.clear_kernel_cache" title="Link to this definition">#</a></dt>
<dd><p>Clear the kernel cache directory of previously generated source code and compiler artifacts.</p>
<p>Only directories beginning with <code class="docutils literal notranslate"><span class="pre">wp_</span></code> will be deleted.
This function only clears the cache for the current Warp version.
LTO artifacts are not affected.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<section id="runtime-kernel-creation">
<span id="id1"></span><h3>Runtime Kernel Creation<a class="headerlink" href="#runtime-kernel-creation" title="Link to this heading">#</a></h3>
<p>Warp allows generating kernels on-the-fly with various customizations, including closure support.
Refer to the <a class="reference internal" href="../codegen.html#code-generation"><span class="std std-ref">Code Generation</span></a> section for the latest features.</p>
</section>
<section id="launch-objects">
<h3>Launch Objects<a class="headerlink" href="#launch-objects" title="Link to this heading">#</a></h3>
<p><a class="reference internal" href="#warp.Launch" title="warp.Launch"><code class="xref py py-class docutils literal notranslate"><span class="pre">Launch</span></code></a> objects are one way to reduce the overhead of launching a kernel multiple times.
<a class="reference internal" href="#warp.Launch" title="warp.Launch"><code class="xref py py-class docutils literal notranslate"><span class="pre">Launch</span></code></a> objects are returned from calling <a class="reference internal" href="#warp.launch" title="warp.launch"><code class="xref py py-func docutils literal notranslate"><span class="pre">wp.launch()</span></code></a> with <code class="docutils literal notranslate"><span class="pre">record_cmd=True</span></code>.
This stores the results of various overhead operations that are needed to launch a kernel
but defers the actual kernel launch until the <a class="reference internal" href="#warp.Launch.launch" title="warp.Launch.launch"><code class="xref py py-func docutils literal notranslate"><span class="pre">Launch.launch()</span></code></a> method is called.</p>
<p>In contrast to <a class="reference internal" href="#graphs"><span class="std std-ref">Graphs</span></a>, <a class="reference internal" href="#warp.Launch" title="warp.Launch"><code class="xref py py-class docutils literal notranslate"><span class="pre">Launch</span></code></a> objects only record the launch of a single kernel
and do not reduce the driver overhead of preparing the kernel for execution on a GPU.
On the other hand, <a class="reference internal" href="#warp.Launch" title="warp.Launch"><code class="xref py py-class docutils literal notranslate"><span class="pre">Launch</span></code></a> objects do not have the storage and initialization
overheads of CUDA graphs and also allow for the modification of launch
dimensions with <a class="reference internal" href="#warp.Launch.set_dim" title="warp.Launch.set_dim"><code class="xref py py-func docutils literal notranslate"><span class="pre">Launch.set_dim()</span></code></a> and
kernel parameters with functions such as <a class="reference internal" href="#warp.Launch.set_params" title="warp.Launch.set_params"><code class="xref py py-func docutils literal notranslate"><span class="pre">Launch.set_params()</span></code></a> and
<a class="reference internal" href="#warp.Launch.set_param_by_name" title="warp.Launch.set_param_by_name"><code class="xref py py-func docutils literal notranslate"><span class="pre">Launch.set_param_by_name()</span></code></a>.
Additionally, <a class="reference internal" href="#warp.Launch" title="warp.Launch"><code class="xref py py-class docutils literal notranslate"><span class="pre">Launch</span></code></a> objects can also be used to reduce the overhead of launching kernels running on the CPU.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Kernels launched via <a class="reference internal" href="#warp.Launch" title="warp.Launch"><code class="xref py py-class docutils literal notranslate"><span class="pre">Launch</span></code></a> objects currently do not get recorded onto the <a class="reference internal" href="differentiability.html#warp.Tape" title="warp.Tape"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tape</span></code></a>.</p>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="warp.Launch">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">Launch</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">device</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">hooks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">params_addr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">max_blocks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">block_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">adjoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L5896-L6123"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Launch" title="Link to this definition">#</a></dt>
<dd><p>Represents all data required for a kernel launch so that launches can be replayed quickly.</p>
<p>Users should not directly instantiate this class, instead use
<code class="docutils literal notranslate"><span class="pre">wp.launch(...,</span> <span class="pre">record_cmd=True)</span></code> to record a launch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> (<a class="reference internal" href="devices.html#warp.context.Device" title="warp.context.Device"><em>Device</em></a>)</p></li>
<li><p><strong>hooks</strong> (<em>KernelHooks</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>params</strong> (<em>Sequence</em><em>[</em><em>Any</em><em>] </em><em>| </em><em>None</em>)</p></li>
<li><p><strong>params_addr</strong> (<em>Sequence</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/ctypes.html#ctypes.c_void_p" title="(in Python v3.13)"><em>ctypes.c_void_p</em></a><em>] </em><em>| </em><em>None</em>)</p></li>
<li><p><strong>bounds</strong> (<em>launch_bounds_t</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>max_blocks</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>block_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>adjoint</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="warp.Launch.device">
<span class="sig-name descname"><span class="pre">device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="devices.html#warp.context.Device" title="warp.context.Device"><span class="pre">Device</span></a></em><a class="headerlink" href="#warp.Launch.device" title="Link to this definition">#</a></dt>
<dd><p>The device to launch on.
This should not be changed after the launch object is created.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.Launch.bounds">
<span class="sig-name descname"><span class="pre">bounds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">launch_bounds_t</span></em><a class="headerlink" href="#warp.Launch.bounds" title="Link to this definition">#</a></dt>
<dd><p>The launch bounds. Update with <a class="reference internal" href="#warp.Launch.set_dim" title="warp.Launch.set_dim"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_dim()</span></code></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.Launch.max_blocks">
<span class="sig-name descname"><span class="pre">max_blocks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#warp.Launch.max_blocks" title="Link to this definition">#</a></dt>
<dd><p>The maximum number of CUDA thread blocks to use.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.Launch.block_dim">
<span class="sig-name descname"><span class="pre">block_dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#warp.Launch.block_dim" title="Link to this definition">#</a></dt>
<dd><p>The number of threads per block.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.Launch.adjoint">
<span class="sig-name descname"><span class="pre">adjoint</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><span class="pre">bool</span></a></em><a class="headerlink" href="#warp.Launch.adjoint" title="Link to this definition">#</a></dt>
<dd><p>Whether to run the adjoint kernel instead of the forward kernel.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.Launch.set_dim">
<span class="sig-name descname"><span class="pre">set_dim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L5980-L5994"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Launch.set_dim" title="Link to this definition">#</a></dt>
<dd><p>Set the launch dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>...</em><em>]</em>) – The dimensions of the launch.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.Launch.set_param_at_index">
<span class="sig-name descname"><span class="pre">set_param_at_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adjoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L5995-L6017"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Launch.set_param_at_index" title="Link to this definition">#</a></dt>
<dd><p>Set a kernel parameter at an index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The index of the param to set.</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a>) – The value to set the param to.</p></li>
<li><p><strong>adjoint</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.Launch.set_param_at_index_from_ctype">
<span class="sig-name descname"><span class="pre">set_param_at_index_from_ctype</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L6018-L6035"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Launch.set_param_at_index_from_ctype" title="Link to this definition">#</a></dt>
<dd><p>Set a kernel parameter at an index without any type conversion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The index of the param to set.</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/ctypes.html#ctypes.Structure" title="(in Python v3.13)"><em>Structure</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The value to set the param to.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.Launch.set_param_by_name">
<span class="sig-name descname"><span class="pre">set_param_by_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adjoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L6036-L6050"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Launch.set_param_by_name" title="Link to this definition">#</a></dt>
<dd><p>Set a kernel parameter by argument name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The name of the argument to set.</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a>) – The value to set the argument to.</p></li>
<li><p><strong>adjoint</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, set the adjoint of this parameter instead of the forward parameter.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.Launch.set_param_by_name_from_ctype">
<span class="sig-name descname"><span class="pre">set_param_by_name_from_ctype</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L6051-L6062"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Launch.set_param_by_name_from_ctype" title="Link to this definition">#</a></dt>
<dd><p>Set a kernel parameter by argument name with no type conversions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The name of the argument to set.</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/ctypes.html#ctypes.Structure" title="(in Python v3.13)"><em>Structure</em></a>) – The value to set the argument to.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.Launch.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L6063-L6071"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Launch.set_params" title="Link to this definition">#</a></dt>
<dd><p>Set all parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>values</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a><em>]</em>) – A list of values to set the params to.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.Launch.set_params_from_ctypes">
<span class="sig-name descname"><span class="pre">set_params_from_ctypes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L6072-L6080"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Launch.set_params_from_ctypes" title="Link to this definition">#</a></dt>
<dd><p>Set all parameters without performing type-conversions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>values</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/ctypes.html#ctypes.Structure" title="(in Python v3.13)"><em>Structure</em></a><em>]</em>) – A list of ctypes or basic int / float types.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.Launch.launch">
<span class="sig-name descname"><span class="pre">launch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L6081-L6123"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Launch.launch" title="Link to this definition">#</a></dt>
<dd><p>Launch the kernel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>stream</strong> (<a class="reference internal" href="#warp.Stream" title="warp.context.Stream"><em>Stream</em></a><em> | </em><em>None</em>) – The stream to launch on.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="arrays">
<span id="id2"></span><h2>Arrays<a class="headerlink" href="#arrays" title="Link to this heading">#</a></h2>
<p>Arrays are the fundamental memory abstraction in Warp. They can be created through the following global constructor:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<span class="n">wp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>
<span class="n">wp</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Arrays can also be constructed directly from NumPy <code class="docutils literal notranslate"><span class="pre">ndarrays</span></code> as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>

<span class="c1"># copy to Warp owned array</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>

<span class="c1"># return a Warp array wrapper around the NumPy data (zero-copy)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>

<span class="c1"># return a Warp copy of the array data on the GPU</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that for multi-dimensional data, the <code class="docutils literal notranslate"><span class="pre">dtype</span></code> parameter must be specified explicitly, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">((</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="c1"># initialize as an array of vec3 objects</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>If the shapes are incompatible, an error will be raised.</p>
<p>Warp arrays can also be constructed from objects that define the <code class="docutils literal notranslate"><span class="pre">__cuda_array_interface__</span></code> attribute. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warp</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">wp</span>

<span class="n">device</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">get_cuda_device</span><span class="p">()</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">cupy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># return a Warp array wrapper around the cupy data (zero-copy)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When constructing arrays from the <code class="docutils literal notranslate"><span class="pre">__cuda_array_interface__</span></code>, it is important to pass the correct CUDA device to the Warp array constructor.  The <code class="docutils literal notranslate"><span class="pre">__cuda_array_interface__</span></code> protocol does not include the device, hence it is necessary to explicitly specify the device where the array resides.</p>
</div>
<p>Arrays can be moved between devices using <a class="reference internal" href="#warp.array.to" title="warp.array.to"><code class="xref py py-meth docutils literal notranslate"><span class="pre">array.to()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">host_array</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>

<span class="c1"># allocate and copy to GPU</span>
<span class="n">device_array</span> <span class="o">=</span> <span class="n">host_array</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Additionally, data can be copied between arrays in different memory spaces using <a class="reference internal" href="#warp.copy" title="warp.copy"><code class="xref py py-func docutils literal notranslate"><span class="pre">wp.copy()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">src_array</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<span class="n">dest_array</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">host_array</span><span class="p">)</span>

<span class="c1"># copy from source CPU buffer to GPU</span>
<span class="n">wp</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">dest_array</span><span class="p">,</span> <span class="n">src_array</span><span class="p">)</span>
</pre></div>
</div>
<p>When indexing an array with an array of integers, the result is an <a class="reference internal" href="#indexed-arrays"><span class="std std-ref">indexed array</span></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">warp</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">wp</span>

<span class="n">arr</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sub</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">int32</span><span class="p">)]</span> <span class="c1"># advanced indexing -&gt; wp.indexedarray</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">sub</span><span class="p">),</span> <span class="n">sub</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;warp.types.array&#39;&gt; (6,)
&lt;class &#39;warp.types.indexedarray&#39;&gt; (3,)
[1 3 5]
</pre></div>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="warp.array">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L2249-L3541"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.array" title="Link to this definition">#</a></dt>
<dd><p>A fixed-size multi-dimensional array containing values of the same type.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="warp.array.dtype">
<span class="sig-name descname"><span class="pre">dtype</span></span><a class="headerlink" href="#warp.array.dtype" title="Link to this definition">#</a></dt>
<dd><p>The data type of the array.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>DType</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.array.ndim">
<span class="sig-name descname"><span class="pre">ndim</span></span><a class="headerlink" href="#warp.array.ndim" title="Link to this definition">#</a></dt>
<dd><p>The number of array dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.array.size">
<span class="sig-name descname"><span class="pre">size</span></span><a class="headerlink" href="#warp.array.size" title="Link to this definition">#</a></dt>
<dd><p>The number of items in the array.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.array.capacity">
<span class="sig-name descname"><span class="pre">capacity</span></span><a class="headerlink" href="#warp.array.capacity" title="Link to this definition">#</a></dt>
<dd><p>The amount of memory in bytes allocated for this array.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.array.shape">
<span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#warp.array.shape" title="Link to this definition">#</a></dt>
<dd><p>Dimensions of the array.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.array.strides">
<span class="sig-name descname"><span class="pre">strides</span></span><a class="headerlink" href="#warp.array.strides" title="Link to this definition">#</a></dt>
<dd><p>Number of bytes in each dimension between successive elements of the array.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.array.ptr">
<span class="sig-name descname"><span class="pre">ptr</span></span><a class="headerlink" href="#warp.array.ptr" title="Link to this definition">#</a></dt>
<dd><p>Pointer to underlying memory allocation backing the array.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.array.device">
<span class="sig-name descname"><span class="pre">device</span></span><a class="headerlink" href="#warp.array.device" title="Link to this definition">#</a></dt>
<dd><p>The device where the array’s memory allocation resides.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="devices.html#warp.context.Device" title="warp.context.Device">Device</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.array.pinned">
<span class="sig-name descname"><span class="pre">pinned</span></span><a class="headerlink" href="#warp.array.pinned" title="Link to this definition">#</a></dt>
<dd><p>Indicates whether the array was allocated in pinned host memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="functions.html#warp.bool" title="warp.bool">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.array.is_contiguous">
<span class="sig-name descname"><span class="pre">is_contiguous</span></span><a class="headerlink" href="#warp.array.is_contiguous" title="Link to this definition">#</a></dt>
<dd><p>Indicates whether this array has a contiguous memory layout.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="functions.html#warp.bool" title="warp.bool">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.array.deleter">
<span class="sig-name descname"><span class="pre">deleter</span></span><a class="headerlink" href="#warp.array.deleter" title="Link to this definition">#</a></dt>
<dd><p>A function to be called when the array is deleted,
taking two arguments: pointer and size. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then no function is called.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Callable[[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>], None]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.array.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Any</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">strides</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">ptr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">capacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">pinned</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">deleter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">ndim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L2272-L2385"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.array.__init__" title="Link to this definition">#</a></dt>
<dd><p>Constructs a new Warp array object</p>
<p>When the <code class="docutils literal notranslate"><span class="pre">data</span></code> argument is a valid list, tuple, or ndarray the array will be constructed from this object’s data.
For objects that are not stored sequentially in memory (e.g.: a list), then the data will first
be flattened before being transferred to the memory space given by device.</p>
<p>The second construction path occurs when the <code class="docutils literal notranslate"><span class="pre">ptr</span></code> argument is a non-zero uint64 value representing the
start address in memory where existing array data resides, e.g.: from an external or C-library. The memory
allocation should reside on the same device given by the device argument, and the user should set the length
and dtype parameter appropriately.</p>
<p>If neither <code class="docutils literal notranslate"><span class="pre">data</span></code> nor <code class="docutils literal notranslate"><span class="pre">ptr</span></code> are specified, the <code class="docutils literal notranslate"><span class="pre">shape</span></code> argument is checked next.
This construction path can be used to create new uninitialized arrays, but users are encouraged to call
<code class="docutils literal notranslate"><span class="pre">wp.empty()</span></code>, <code class="docutils literal notranslate"><span class="pre">wp.zeros()</span></code>, or <code class="docutils literal notranslate"><span class="pre">wp.full()</span></code> instead to create new arrays.</p>
<p>If none of the above arguments are specified, a simple type annotation is constructed.  This is used when annotating
kernel arguments or struct members (e.g.,``arr: wp.array(dtype=float)``).  In this case, only <code class="docutils literal notranslate"><span class="pre">dtype</span></code> and <code class="docutils literal notranslate"><span class="pre">ndim</span></code>
are taken into account and no memory is allocated for the array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em> | </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>ndarray</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a><em>, </em><em>...</em><em>]</em><em>, </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><em>dtype</em></a><em>[</em><em>_ScalarT</em><em>]</em><em>] </em><em>| </em><em>None</em>) – An object to construct the array from, can be a Tuple, List, or generally any type convertible to an np.array</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a>) – One of the available <a class="reference external" href="#data-types">data types</a>, such as <a class="reference internal" href="functions.html#warp.float32" title="warp.float32"><code class="xref py py-class docutils literal notranslate"><span class="pre">warp.float32</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">warp.mat33</span></code>, or a custom <a class="reference external" href="#structs">struct</a>. If dtype is <code class="docutils literal notranslate"><span class="pre">Any</span></code> and data is an ndarray, then it will be inferred from the array data type</p></li>
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>...</em><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>] </em><em>| </em><em>None</em>) – Dimensions of the array</p></li>
<li><p><strong>strides</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>...</em><em>] </em><em>| </em><em>None</em>) – Number of bytes in each dimension between successive elements of the array</p></li>
<li><p><strong>ptr</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><em>None</em>) – Address of an external memory address to alias (<code class="docutils literal notranslate"><span class="pre">data</span></code> should be <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><strong>capacity</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><em>None</em>) – Maximum size in bytes of the <code class="docutils literal notranslate"><span class="pre">ptr</span></code> allocation (<code class="docutils literal notranslate"><span class="pre">data</span></code> should be <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><strong>device</strong> (<em>Devicelike</em>) – Device the array lives on</p></li>
<li><p><strong>copy</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – Whether the incoming <code class="docutils literal notranslate"><span class="pre">data</span></code> will be copied or aliased. Aliasing requires that
the incoming <code class="docutils literal notranslate"><span class="pre">data</span></code> already lives on the <code class="docutils literal notranslate"><span class="pre">device</span></code> specified and the data types match.</p></li>
<li><p><strong>deleter</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><em>Callable</em></a><em>[</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em><em>, </em><em>None</em><em>] </em><em>| </em><em>None</em>) – Function to be called when the array is deleted, taking two arguments: pointer and size</p></li>
<li><p><strong>requires_grad</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – Whether or not gradients will be tracked for this array, see <a class="reference internal" href="differentiability.html#warp.Tape" title="warp.Tape"><code class="xref py py-class docutils literal notranslate"><span class="pre">warp.Tape</span></code></a> for details</p></li>
<li><p><strong>grad</strong> (<a class="reference internal" href="#warp.array" title="warp.types.array"><em>array</em></a><em> | </em><em>None</em>) – The array in which to accumulate gradients in the backward pass. If <code class="docutils literal notranslate"><span class="pre">None</span></code> and <code class="docutils literal notranslate"><span class="pre">requires_grad</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>,
then a gradient array will be allocated automatically.</p></li>
<li><p><strong>pinned</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – Whether to allocate pinned host memory, which allows asynchronous host–device transfers
(only applicable with <code class="docutils literal notranslate"><span class="pre">device=&quot;cpu&quot;</span></code>)</p></li>
<li><p><strong>ndim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="warp.array.grad">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">grad</span></span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L3062-L3065"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.array.grad" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="warp.array.requires_grad">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">requires_grad</span></span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L3095-L3098"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.array.requires_grad" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.array.mark_init">
<span class="sig-name descname"><span class="pre">mark_init</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L3127-L3130"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.array.mark_init" title="Link to this definition">#</a></dt>
<dd><p>Resets this array’s read flag</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.array.mark_read">
<span class="sig-name descname"><span class="pre">mark_read</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L3131-L3141"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.array.mark_read" title="Link to this definition">#</a></dt>
<dd><p>Marks this array as having been read from in a kernel or recorded function on the tape.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.array.mark_write">
<span class="sig-name descname"><span class="pre">mark_write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L3142-L3153"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.array.mark_write" title="Link to this definition">#</a></dt>
<dd><p>Detect if we are writing to an array that has already been read from</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.array.zero_">
<span class="sig-name descname"><span class="pre">zero_</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L3154-L3162"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.array.zero_" title="Link to this definition">#</a></dt>
<dd><p>Zeroes-out the array entries.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.array.fill_">
<span class="sig-name descname"><span class="pre">fill_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L3163-L3237"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.array.fill_" title="Link to this definition">#</a></dt>
<dd><p>Set all array entries to <cite>value</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> – The value to set every array entry to. Must be convertible to the array’s <code class="docutils literal notranslate"><span class="pre">dtype</span></code>.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If <cite>value</cite> cannot be converted to the array’s <code class="docutils literal notranslate"><span class="pre">dtype</span></code>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p><code class="docutils literal notranslate"><span class="pre">fill_()</span></code> can take lists or other sequences when filling arrays of vectors or matrices.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">mat22</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="go">array([[[0., 0.],</span>
<span class="go">        [0., 0.]],</span>

<span class="go">       [[0., 0.],</span>
<span class="go">        [0., 0.]]], dtype=float32)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span><span class="o">.</span><span class="n">fill_</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="go">array([[[1., 2.],</span>
<span class="go">        [3., 4.]],</span>

<span class="go">       [[1., 2.],</span>
<span class="go">        [3., 4.]]], dtype=float32)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.array.assign">
<span class="sig-name descname"><span class="pre">assign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L3238-L3244"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.array.assign" title="Link to this definition">#</a></dt>
<dd><p>Wraps <code class="docutils literal notranslate"><span class="pre">src</span></code> in an <a class="reference internal" href="#warp.array" title="warp.array"><code class="xref py py-class docutils literal notranslate"><span class="pre">warp.array</span></code></a> if it is not already one and copies the contents to <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.array.numpy">
<span class="sig-name descname"><span class="pre">numpy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L3245-L3269"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.array.numpy" title="Link to this definition">#</a></dt>
<dd><p>Converts the array to a <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> (aliasing memory through the array interface protocol)
If the array is on the GPU, a synchronous device-to-host copy (on the CUDA default stream) will be
automatically performed to ensure that any outstanding work is completed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.array.cptr">
<span class="sig-name descname"><span class="pre">cptr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L3270-L3297"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.array.cptr" title="Link to this definition">#</a></dt>
<dd><p>Return a ctypes cast of the array address.</p>
<p>Notes:</p>
<ol class="arabic simple">
<li><p>Only CPU arrays support this method.</p></li>
<li><p>The array must be contiguous.</p></li>
<li><p>Accesses to this object are <strong>not</strong> bounds checked.</p></li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">float16</span></code> types, a pointer to the internal <code class="docutils literal notranslate"><span class="pre">uint16</span></code> representation is returned.</p></li>
</ol>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.array.list">
<span class="sig-name descname"><span class="pre">list</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L3298-L3317"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.array.list" title="Link to this definition">#</a></dt>
<dd><p>Returns a flattened list of items in the array as a Python list.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.array.to">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L3318-L3325"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.array.to" title="Link to this definition">#</a></dt>
<dd><p>Returns a Warp array with this array’s data moved to the specified device, no-op if already on device.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.array.flatten">
<span class="sig-name descname"><span class="pre">flatten</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L3326-L3350"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.array.flatten" title="Link to this definition">#</a></dt>
<dd><p>Returns a zero-copy view of the array collapsed to 1-D. Only supported for contiguous arrays.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.array.reshape">
<span class="sig-name descname"><span class="pre">reshape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L3351-L3414"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.array.reshape" title="Link to this definition">#</a></dt>
<dd><p>Returns a reshaped array. Only supported for contiguous arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>shape</strong> – An int or tuple of ints specifying the shape of the returned array.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.array.view">
<span class="sig-name descname"><span class="pre">view</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L3415-L3439"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.array.view" title="Link to this definition">#</a></dt>
<dd><p>Returns a zero-copy view of this array’s memory with a different data type.
<code class="docutils literal notranslate"><span class="pre">dtype</span></code> must have the same byte size of the array’s native <code class="docutils literal notranslate"><span class="pre">dtype</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.array.contiguous">
<span class="sig-name descname"><span class="pre">contiguous</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L3440-L3448"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.array.contiguous" title="Link to this definition">#</a></dt>
<dd><p>Returns a contiguous array with this array’s data. No-op if array is already contiguous.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.array.transpose">
<span class="sig-name descname"><span class="pre">transpose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L3449-L3495"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.array.transpose" title="Link to this definition">#</a></dt>
<dd><p>Returns an zero-copy view of the array with axes transposed.</p>
<p>Note: The transpose operation will return an array with a non-contiguous access pattern.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>axes</strong> (<em>optional</em>) – Specifies the how the axes are permuted. If not specified, the axes order will be reversed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.array.ipc_handle">
<span class="sig-name descname"><span class="pre">ipc_handle</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L3496-L3541"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.array.ipc_handle" title="Link to this definition">#</a></dt>
<dd><p>Return an IPC handle of the array as a 64-byte <code class="docutils literal notranslate"><span class="pre">bytes</span></code> object</p>
<p><a class="reference internal" href="#warp.from_ipc_handle" title="warp.from_ipc_handle"><code class="xref py py-func docutils literal notranslate"><span class="pre">from_ipc_handle()</span></code></a> can be used with this handle in another process
to obtain a <a class="reference internal" href="#warp.array" title="warp.array"><code class="xref py py-class docutils literal notranslate"><span class="pre">array</span></code></a> that shares the same underlying memory
allocation.</p>
<p>IPC is currently only supported on Linux.
Additionally, IPC is only supported for arrays allocated using
the default memory allocator.</p>
<p><a class="reference internal" href="#warp.Event" title="warp.Event"><code class="xref py py-class docutils literal notranslate"><span class="pre">Event</span></code></a> objects created with the <code class="docutils literal notranslate"><span class="pre">interprocess=True</span></code> argument
may similarly be shared between processes to synchronize GPU work.</p>
<p class="rubric">Example</p>
<p>Temporarily using the default memory allocator to allocate an array
and get its IPC handle:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">wp</span><span class="o">.</span><span class="n">ScopedMempool</span><span class="p">(</span><span class="s2">&quot;cuda:0&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
    <span class="n">test_array</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">42.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda:0&quot;</span><span class="p">)</span>
    <span class="n">ipc_handle</span> <span class="o">=</span> <span class="n">test_array</span><span class="o">.</span><span class="n">ipc_handle</span><span class="p">()</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.13)"><strong>RuntimeError</strong></a> – The array is not associated with a CUDA device.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.13)"><strong>RuntimeError</strong></a> – The CUDA device does not appear to support IPC.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.13)"><strong>RuntimeError</strong></a> – The array was allocated using the <a class="reference internal" href="allocators.html#mempool-allocators"><span class="std std-ref">mempool memory allocator</span></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.13)">bytes</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<section id="multi-dimensional-arrays">
<h3>Multi-dimensional Arrays<a class="headerlink" href="#multi-dimensional-arrays" title="Link to this heading">#</a></h3>
<p>Multi-dimensional arrays up to four dimensions can be constructed by passing a tuple of sizes for each dimension.</p>
<p>The following constructs a 2D array of size 1024 x 16:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>When passing multi-dimensional arrays to kernels users must specify the expected array dimension inside the kernel signature,
e.g. to pass a 2D array to a kernel the number of dims is specified using the <code class="docutils literal notranslate"><span class="pre">ndim=2</span></code> parameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test</span><span class="p">(</span><span class="nb">input</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">)):</span>
</pre></div>
</div>
<p>Type-hint helpers are provided for common array sizes, e.g.: <code class="docutils literal notranslate"><span class="pre">array2d()</span></code>, <code class="docutils literal notranslate"><span class="pre">array3d()</span></code>, which are equivalent to calling <code class="docutils literal notranslate"><span class="pre">array(...,</span> <span class="pre">ndim=2)</span></code>, etc.
To index a multi-dimensional array, use the following kernel syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># returns a float from the 2d array</span>
<span class="n">value</span> <span class="o">=</span> <span class="nb">input</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
</pre></div>
</div>
<p>To create an array slice, use the following syntax, where the number of indices is less than the array dimensions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># returns an 1d array slice representing a row of the 2d array</span>
<span class="n">row</span> <span class="o">=</span> <span class="nb">input</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</pre></div>
</div>
<p>Slice operators can be concatenated, e.g.: <code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">=</span> <span class="pre">array[i][j][k]</span></code>. Slices can be passed to <code class="docutils literal notranslate"><span class="pre">wp.func</span></code> user functions provided
the function also declares the expected array dimension. Currently, only single-index slicing is supported.</p>
<p>The following construction methods are provided for allocating zero-initialized and empty (non-initialized) arrays:</p>
<dl class="py function">
<dt class="sig sig-object py" id="warp.zeros">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">zeros</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">float</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">pinned</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L5385-L5411"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.zeros" title="Link to this definition">#</a></dt>
<dd><p>Return a zero-initialized array</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>...</em><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>] </em><em>| </em><em>None</em>) – Array dimensions</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.13)"><em>type</em></a>) – Type of each element, e.g.: warp.vec3, warp.mat33, etc</p></li>
<li><p><strong>device</strong> (<a class="reference internal" href="devices.html#warp.context.Device" title="warp.context.Device"><em>Device</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – Device that array will live on</p></li>
<li><p><strong>requires_grad</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – Whether the array will be tracked for back propagation</p></li>
<li><p><strong>pinned</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – Whether the array uses pinned host memory (only applicable to CPU arrays)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A warp.array object representing the allocation</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#warp.array" title="warp.types.array"><em>array</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.zeros_like">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">zeros_like</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pinned</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L5413-L5433"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.zeros_like" title="Link to this definition">#</a></dt>
<dd><p>Return a zero-initialized array with the same type and dimension of another array</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>src</strong> (<em>Array</em>) – The template array to use for shape, data type, and device</p></li>
<li><p><strong>device</strong> (<a class="reference internal" href="devices.html#warp.context.Device" title="warp.context.Device"><em>Device</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – The device where the new array will be created (defaults to src.device)</p></li>
<li><p><strong>requires_grad</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a><em> | </em><em>None</em>) – Whether the array will be tracked for back propagation</p></li>
<li><p><strong>pinned</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a><em> | </em><em>None</em>) – Whether the array uses pinned host memory (only applicable to CPU arrays)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A warp.array object representing the allocation</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#warp.array" title="warp.types.array"><em>array</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.ones">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">ones</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">float</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">pinned</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L5435-L5457"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.ones" title="Link to this definition">#</a></dt>
<dd><p>Return a one-initialized array</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>...</em><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>] </em><em>| </em><em>None</em>) – Array dimensions</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.13)"><em>type</em></a>) – Type of each element, e.g.: warp.vec3, warp.mat33, etc</p></li>
<li><p><strong>device</strong> (<a class="reference internal" href="devices.html#warp.context.Device" title="warp.context.Device"><em>Device</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – Device that array will live on</p></li>
<li><p><strong>requires_grad</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – Whether the array will be tracked for back propagation</p></li>
<li><p><strong>pinned</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – Whether the array uses pinned host memory (only applicable to CPU arrays)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A warp.array object representing the allocation</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#warp.array" title="warp.types.array"><em>array</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.ones_like">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">ones_like</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pinned</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L5459-L5475"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.ones_like" title="Link to this definition">#</a></dt>
<dd><p>Return a one-initialized array with the same type and dimension of another array</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>src</strong> (<em>Array</em>) – The template array to use for shape, data type, and device</p></li>
<li><p><strong>device</strong> (<a class="reference internal" href="devices.html#warp.context.Device" title="warp.context.Device"><em>Device</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – The device where the new array will be created (defaults to src.device)</p></li>
<li><p><strong>requires_grad</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a><em> | </em><em>None</em>) – Whether the array will be tracked for back propagation</p></li>
<li><p><strong>pinned</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a><em> | </em><em>None</em>) – Whether the array uses pinned host memory (only applicable to CPU arrays)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A warp.array object representing the allocation</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#warp.array" title="warp.types.array"><em>array</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.full">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">full</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Any</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">pinned</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L5477-L5541"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.full" title="Link to this definition">#</a></dt>
<dd><p>Return an array with all elements initialized to the given value</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>...</em><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>] </em><em>| </em><em>None</em>) – Array dimensions</p></li>
<li><p><strong>value</strong> – Element value</p></li>
<li><p><strong>dtype</strong> – Type of each element, e.g.: float, warp.vec3, warp.mat33, etc</p></li>
<li><p><strong>device</strong> (<a class="reference internal" href="devices.html#warp.context.Device" title="warp.context.Device"><em>Device</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – Device that array will live on</p></li>
<li><p><strong>requires_grad</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – Whether the array will be tracked for back propagation</p></li>
<li><p><strong>pinned</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – Whether the array uses pinned host memory (only applicable to CPU arrays)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A warp.array object representing the allocation</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#warp.array" title="warp.types.array"><em>array</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.full_like">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">full_like</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pinned</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L5543-L5568"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.full_like" title="Link to this definition">#</a></dt>
<dd><p>Return an array with all elements initialized to the given value with the same type and dimension of another array</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>src</strong> (<em>Array</em>) – The template array to use for shape, data type, and device</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a>) – Element value</p></li>
<li><p><strong>device</strong> (<a class="reference internal" href="devices.html#warp.context.Device" title="warp.context.Device"><em>Device</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – The device where the new array will be created (defaults to src.device)</p></li>
<li><p><strong>requires_grad</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a><em> | </em><em>None</em>) – Whether the array will be tracked for back propagation</p></li>
<li><p><strong>pinned</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a><em> | </em><em>None</em>) – Whether the array uses pinned host memory (only applicable to CPU arrays)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A warp.array object representing the allocation</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#warp.array" title="warp.types.array"><em>array</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.empty">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">empty</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">float</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">pinned</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L5592-L5623"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.empty" title="Link to this definition">#</a></dt>
<dd><p>Returns an uninitialized array</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>...</em><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>] </em><em>| </em><em>None</em>) – Array dimensions</p></li>
<li><p><strong>dtype</strong> – Type of each element, e.g.: <cite>warp.vec3</cite>, <cite>warp.mat33</cite>, etc</p></li>
<li><p><strong>device</strong> (<a class="reference internal" href="devices.html#warp.context.Device" title="warp.context.Device"><em>Device</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – Device that array will live on</p></li>
<li><p><strong>requires_grad</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – Whether the array will be tracked for back propagation</p></li>
<li><p><strong>pinned</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – Whether the array uses pinned host memory (only applicable to CPU arrays)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A warp.array object representing the allocation</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#warp.array" title="warp.types.array"><em>array</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.empty_like">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">empty_like</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pinned</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L5625-L5657"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.empty_like" title="Link to this definition">#</a></dt>
<dd><p>Return an uninitialized array with the same type and dimension of another array</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>src</strong> (<em>Array</em>) – The template array to use for shape, data type, and device</p></li>
<li><p><strong>device</strong> (<a class="reference internal" href="devices.html#warp.context.Device" title="warp.context.Device"><em>Device</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – The device where the new array will be created (defaults to src.device)</p></li>
<li><p><strong>requires_grad</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a><em> | </em><em>None</em>) – Whether the array will be tracked for back propagation</p></li>
<li><p><strong>pinned</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a><em> | </em><em>None</em>) – Whether the array uses pinned host memory (only applicable to CPU arrays)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A warp.array object representing the allocation</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#warp.array" title="warp.types.array"><em>array</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.copy">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dest</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L7327-L7515"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.copy" title="Link to this definition">#</a></dt>
<dd><p>Copy array contents from <cite>src</cite> to <cite>dest</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dest</strong> (<a class="reference internal" href="#warp.array" title="warp.types.array"><em>array</em></a>) – Destination array, must be at least as large as source buffer</p></li>
<li><p><strong>src</strong> (<a class="reference internal" href="#warp.array" title="warp.types.array"><em>array</em></a>) – Source array</p></li>
<li><p><strong>dest_offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Element offset in the destination array</p></li>
<li><p><strong>src_offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Element offset in the source array</p></li>
<li><p><strong>count</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of array elements to copy (will copy all elements if set to 0)</p></li>
<li><p><strong>stream</strong> (<a class="reference internal" href="#warp.Stream" title="warp.context.Stream"><em>Stream</em></a><em> | </em><em>None</em>) – The stream on which to perform the copy</p></li>
</ul>
</dd>
</dl>
<p>The stream, if specified, can be from any device.  If the stream is omitted, then Warp selects a stream based on the following rules:
(1) If the destination array is on a CUDA device, use the current stream on the destination device.
(2) Otherwise, if the source array is on a CUDA device, use the current stream on the source device.</p>
<p>If neither source nor destination are on a CUDA device, no stream is used for the copy.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.clone">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pinned</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L5570-L5590"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.clone" title="Link to this definition">#</a></dt>
<dd><p>Clone an existing array, allocates a copy of the src memory</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>src</strong> (<a class="reference internal" href="#warp.array" title="warp.types.array"><em>array</em></a>) – The source array to copy</p></li>
<li><p><strong>device</strong> (<a class="reference internal" href="devices.html#warp.context.Device" title="warp.context.Device"><em>Device</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – The device where the new array will be created (defaults to src.device)</p></li>
<li><p><strong>requires_grad</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a><em> | </em><em>None</em>) – Whether the array will be tracked for back propagation</p></li>
<li><p><strong>pinned</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a><em> | </em><em>None</em>) – Whether the array uses pinned host memory (only applicable to CPU arrays)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A warp.array object representing the allocation</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#warp.array" title="warp.types.array"><em>array</em></a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="indexed-arrays">
<span id="id3"></span><h3>Indexed Arrays<a class="headerlink" href="#indexed-arrays" title="Link to this heading">#</a></h3>
<p>An indexed array is a lightweight view into an existing <a class="reference internal" href="#warp.array" title="warp.array"><code class="xref py py-class docutils literal notranslate"><span class="pre">warp.array</span></code></a> instance that references elements
through an explicit integer index list, thus allowing to run kernels on an arbitrary subset of data without any copy.</p>
<dl class="py class">
<dt class="sig sig-object py" id="warp.indexedarray">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">indexedarray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L3782-L3882"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.indexedarray" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<a class="reference internal" href="#warp.array" title="warp.array"><em>array</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>indices</strong> (<a class="reference internal" href="#warp.array" title="warp.array"><em>array</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference internal" href="#warp.array" title="warp.array"><em>array</em></a><em>] </em><em>| </em><em>None</em>)</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.13)"><em>type</em></a>)</p></li>
<li><p><strong>ndim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="warp.indexedarray.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L3787-L3860"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.indexedarray.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<a class="reference internal" href="#warp.array" title="warp.types.array"><em>array</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>indices</strong> (<a class="reference internal" href="#warp.array" title="warp.types.array"><em>array</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference internal" href="#warp.array" title="warp.types.array"><em>array</em></a><em>] </em><em>| </em><em>None</em>)</p></li>
<li><p><strong>ndim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<section id="creating-an-indexed-array">
<h4>Creating an Indexed Array<a class="headerlink" href="#creating-an-indexed-array" title="Link to this heading">#</a></h4>
<p>Pass the <em>data</em> array together with a list of <code class="docutils literal notranslate"><span class="pre">wp.int32</span></code> index arrays, one for each dimension:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">warp</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">wp</span>

<span class="c1"># Base data.</span>
<span class="n">arr</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="mf">1.23</span><span class="p">,</span> <span class="mf">2.34</span><span class="p">,</span> <span class="mf">3.45</span><span class="p">,</span> <span class="mf">4.56</span><span class="p">,</span> <span class="mf">5.67</span><span class="p">,</span> <span class="mf">6.78</span><span class="p">),</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>

<span class="c1"># Only view elements at odd indices.</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>
<span class="n">sub</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">indexedarray</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">[</span><span class="n">idx</span><span class="p">])</span>  <span class="c1"># Same as wp.indexedarray1d(...)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[2.34 4.56 6.78]
</pre></div>
</div>
<p>Additionally, <code class="docutils literal notranslate"><span class="pre">None</span></code> can be passed to select all elements for any given dimension.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warp</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">wp</span>

<span class="n">mat</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)))</span>
<span class="n">rows</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

<span class="n">block</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">indexedarray2d</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>  <span class="c1"># shape == (2, 5)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 5.  6.  7.  8.  9.]
 [15. 16. 17. 18. 19.]]
</pre></div>
</div>
<p>The resulting view keeps the <code class="docutils literal notranslate"><span class="pre">dtype</span></code> of the source and has a shape given by the lengths of the supplied index arrays.</p>
<p>Alternative constructors are available for convenience:</p>
<dl class="py function">
<dt class="sig sig-object py" id="warp.indexedarray1d">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">indexedarray1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L3885-L3888"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.indexedarray1d" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.indexedarray2d">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">indexedarray2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L3891-L3894"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.indexedarray2d" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.indexedarray3d">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">indexedarray3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L3897-L3900"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.indexedarray3d" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.indexedarray4d">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">indexedarray4d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L3903-L3906"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.indexedarray4d" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="interoperability-with-other-frameworks">
<h4>Interoperability With Other Frameworks<a class="headerlink" href="#interoperability-with-other-frameworks" title="Link to this heading">#</a></h4>
<p>Frameworks such as PyTorch or JAX do not have a concept equivalent to
Warp’s indexed arrays. Converting an <code class="docutils literal notranslate"><span class="pre">wp.indexedarray</span></code> directly therefore
raises an exception. Two common workarounds are:</p>
<ol class="arabic">
<li><p>Make a contiguous copy and share that:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">warp</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">wp</span>

<span class="n">arr</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">),</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>
<span class="n">sub</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">indexedarray1d</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">to_torch</span><span class="p">(</span><span class="n">sub</span><span class="o">.</span><span class="n">contiguous</span><span class="p">())</span>
</pre></div>
</div>
</li>
<li><p>Share the underlying data and index buffers independently (zero-copy):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">warp</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">wp</span>

<span class="n">arr</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">),</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>
<span class="n">sub</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">indexedarray1d</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
<span class="n">t_data</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">to_torch</span><span class="p">(</span><span class="n">sub</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">t_ind</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">to_torch</span><span class="p">(</span><span class="n">sub</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</li>
</ol>
<p>PyTorch can index with integer tensors, but doing so always copies the data.</p>
</section>
</section>
<section id="structured-arrays">
<h3>Structured Arrays<a class="headerlink" href="#structured-arrays" title="Link to this heading">#</a></h3>
<p>Structured arrays in Warp allow you to work with arrays of user-defined structs,
enabling efficient, named access to heterogeneous data fields across the CPU and GPU.</p>
<section id="creating-and-viewing-struct-arrays">
<h4>Creating and Viewing Struct Arrays<a class="headerlink" href="#creating-and-viewing-struct-arrays" title="Link to this heading">#</a></h4>
<p>When you define a Warp struct, you can allocate a Warp array of that type on the CPU and convert it to a NumPy structured array view (zero-copy):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">warp</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">wp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="nd">@wp</span><span class="o">.</span><span class="n">struct</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Foo</span><span class="p">:</span>
    <span class="n">i</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">f</span><span class="p">:</span> <span class="nb">float</span>

<span class="c1"># allocate a Warp array on the CPU</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">Foo</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>

<span class="c1"># view it in NumPy without copying</span>
<span class="n">na</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>

<span class="c1"># modify via NumPy</span>
<span class="n">na</span><span class="p">[</span><span class="s2">&quot;i&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">42</span>
<span class="n">na</span><span class="p">[</span><span class="s2">&quot;f&quot;</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">13.37</span>

<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[(42,  0.  ) ( 0,  0.  ) ( 0, 13.37) ( 0,  0.  ) ( 0,  0.  )]
</pre></div>
</div>
</section>
<section id="initializing-via-numpy-and-converting-to-a-warp-array">
<h4>Initializing via NumPy and Converting to a Warp Array<a class="headerlink" href="#initializing-via-numpy-and-converting-to-a-warp-array" title="Link to this heading">#</a></h4>
<p>You can also create a NumPy structured array first, then convert it to a Warp array, which works well for batch initialization:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">warp</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">wp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>

<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>

<span class="nd">@wp</span><span class="o">.</span><span class="n">struct</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Boid</span><span class="p">:</span>
    <span class="n">vel</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">vec3f</span>
    <span class="n">wander_angles</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">vec2f</span>
    <span class="n">mass</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">group</span><span class="p">:</span> <span class="nb">int</span>

<span class="n">num_boids</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">npboids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_boids</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">Boid</span><span class="o">.</span><span class="n">numpy_dtype</span><span class="p">())</span>

<span class="n">angles</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">num_boids</span><span class="p">)</span>
<span class="n">npboids</span><span class="p">[</span><span class="s2">&quot;vel&quot;</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span>
<span class="n">npboids</span><span class="p">[</span><span class="s2">&quot;vel&quot;</span><span class="p">][:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span>

<span class="n">npboids</span><span class="p">[</span><span class="s2">&quot;wander_angles&quot;</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">num_boids</span><span class="p">)</span>
<span class="n">npboids</span><span class="p">[</span><span class="s2">&quot;wander_angles&quot;</span><span class="p">][:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">num_boids</span><span class="p">)</span>

<span class="n">npboids</span><span class="p">[</span><span class="s2">&quot;mass&quot;</span><span class="p">][:]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">num_boids</span><span class="p">)</span>

<span class="c1"># create Warp array from prepared NumPy array</span>
<span class="n">boids</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">npboids</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">Boid</span><span class="p">)</span>
</pre></div>
</div>
<p>This approach leverages NumPy’s vectorized operations to initialize all array elements efficiently, avoiding Python loops.</p>
</section>
<section id="nested-structs-and-vector-types">
<h4>Nested Structs and Vector Types<a class="headerlink" href="#nested-structs-and-vector-types" title="Link to this heading">#</a></h4>
<p>Structured arrays fully support nested structs and Warp vector (and matrix) types:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">warp</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">wp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="nd">@wp</span><span class="o">.</span><span class="n">struct</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Bar</span><span class="p">:</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">vec3</span>

<span class="nd">@wp</span><span class="o">.</span><span class="n">struct</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Foo</span><span class="p">:</span>
    <span class="n">i</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">f</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">bar</span><span class="p">:</span> <span class="n">Bar</span>

<span class="n">na</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">Foo</span><span class="o">.</span><span class="n">numpy_dtype</span><span class="p">())</span>

<span class="n">na</span><span class="p">[</span><span class="s2">&quot;i&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">42</span>
<span class="n">na</span><span class="p">[</span><span class="s2">&quot;f&quot;</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">13.37</span>
<span class="n">na</span><span class="p">[</span><span class="s2">&quot;bar&quot;</span><span class="p">][</span><span class="s2">&quot;x&quot;</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">na</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">Foo</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda:0&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[(42,  0.  , ([0., 0., 0.],)) ( 0,  0.  , ([0., 0., 0.],))
 ( 0, 13.37, ([0., 0., 0.],)) ( 0,  0.  , ([0., 0., 0.],))
 ( 0,  0.  , ([1., 1., 1.],))]
</pre></div>
</div>
</section>
</section>
<section id="local-arrays">
<h3>Local Arrays<a class="headerlink" href="#local-arrays" title="Link to this heading">#</a></h3>
<p>While arrays are typically created at the Python scope and passed to kernels as arguments,
Warp also supports creating arrays directly inside kernels. This capability is limited to two specific approaches:</p>
<ol class="arabic">
<li><p><strong>Creating array views from existing memory</strong>: Initialize an array that references an existing data buffer
by using <code class="docutils literal notranslate"><span class="pre">wp.array(ptr=...,</span> <span class="pre">shape=...,</span> <span class="pre">dtype=...)</span></code>. This is useful to reinterpret memory
with a different shape or when working with external memory pointers:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">sum_rows_kernel</span><span class="p">(</span>
    <span class="n">flat_arr</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">),</span>
    <span class="n">out</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">),</span>
<span class="p">):</span>
    <span class="n">tid</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">tid</span><span class="p">()</span>

    <span class="c1"># Reinterpret the flat array as a 2D array of 3x4 elements.</span>
    <span class="n">arr</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ptr</span><span class="o">=</span><span class="n">flat_arr</span><span class="o">.</span><span class="n">ptr</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

    <span class="c1"># Compute sum of row.</span>
    <span class="nb">sum</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="nb">sum</span> <span class="o">+=</span> <span class="n">arr</span><span class="p">[</span><span class="n">tid</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>

    <span class="n">out</span><span class="p">[</span><span class="n">tid</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span>

<span class="n">flat_arr</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">row_sums</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">wp</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span><span class="n">sum_rows_kernel</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="p">(</span><span class="n">flat_arr</span><span class="p">,</span> <span class="n">row_sums</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">row_sums</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[ 6 22 38]
</pre></div>
</div>
</div></blockquote>
</li>
<li><p><strong>Allocating fixed-size arrays</strong>: Allocate a new zero-initialized array with a compile-time constant shape
using <code class="docutils literal notranslate"><span class="pre">wp.zeros(shape=...,</span> <span class="pre">dtype=...)</span></code>:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">6</span>

<span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">find_cumsum_avg_crossing_kernel</span><span class="p">(</span>
    <span class="n">arr</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">array2d</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">),</span>
    <span class="n">out</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">),</span>
<span class="p">):</span>
    <span class="n">tid</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">tid</span><span class="p">()</span>

    <span class="c1"># Create temporary array to store cumulative sums for this column.</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

    <span class="c1"># Compute the cumulative sum values.</span>
    <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">tid</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
        <span class="n">tmp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">tid</span><span class="p">]</span>

    <span class="c1"># Calculate the average of the cumulative sum values.</span>
    <span class="nb">sum</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="nb">sum</span> <span class="o">+=</span> <span class="n">tmp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">avg</span> <span class="o">=</span> <span class="nb">sum</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

    <span class="c1"># Find the first index where `cumulative sum value &gt;= avg`.</span>
    <span class="c1"># This represents the crossing point where accumulated values exceed</span>
    <span class="c1"># the average accumulation.</span>
    <span class="n">out</span><span class="p">[</span><span class="n">tid</span><span class="p">]</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">lower_bound</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="n">avg</span><span class="p">)</span>

<span class="n">arr</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">wp</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span><span class="n">find_cumsum_avg_crossing_kernel</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,),</span> <span class="n">inputs</span><span class="o">=</span><span class="p">(</span><span class="n">arr</span><span class="p">,),</span> <span class="n">outputs</span><span class="o">=</span><span class="p">(</span><span class="n">idx</span><span class="p">,))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">idx</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[3 3 3]
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
</section>
</section>
<section id="id4">
<span id="id5"></span><h2>Data Types<a class="headerlink" href="#id4" title="Link to this heading">#</a></h2>
<section id="scalar-types">
<h3>Scalar Types<a class="headerlink" href="#scalar-types" title="Link to this heading">#</a></h3>
<p>The following scalar storage types are supported for array structures:</p>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td><p>bool</p></td>
<td><p>boolean</p></td>
</tr>
<tr class="row-even"><td><p>int8</p></td>
<td><p>signed byte</p></td>
</tr>
<tr class="row-odd"><td><p>uint8</p></td>
<td><p>unsigned byte</p></td>
</tr>
<tr class="row-even"><td><p>int16</p></td>
<td><p>signed short</p></td>
</tr>
<tr class="row-odd"><td><p>uint16</p></td>
<td><p>unsigned short</p></td>
</tr>
<tr class="row-even"><td><p>int32</p></td>
<td><p>signed integer</p></td>
</tr>
<tr class="row-odd"><td><p>uint32</p></td>
<td><p>unsigned integer</p></td>
</tr>
<tr class="row-even"><td><p>int64</p></td>
<td><p>signed long integer</p></td>
</tr>
<tr class="row-odd"><td><p>uint64</p></td>
<td><p>unsigned long integer</p></td>
</tr>
<tr class="row-even"><td><p>float16</p></td>
<td><p>half-precision float</p></td>
</tr>
<tr class="row-odd"><td><p>float32</p></td>
<td><p>single-precision float</p></td>
</tr>
<tr class="row-even"><td><p>float64</p></td>
<td><p>double-precision float</p></td>
</tr>
</tbody>
</table>
</div>
<p>Warp supports <code class="docutils literal notranslate"><span class="pre">float</span></code> and <code class="docutils literal notranslate"><span class="pre">int</span></code> as aliases for <code class="docutils literal notranslate"><span class="pre">wp.float32</span></code> and <code class="docutils literal notranslate"><span class="pre">wp.int32</span></code> respectively.</p>
</section>
<section id="vectors">
<span id="vec"></span><h3>Vectors<a class="headerlink" href="#vectors" title="Link to this heading">#</a></h3>
<p>Warp provides built-in math and geometry types for common simulation and graphics problems.
A full reference for operators and functions for these types is available in the <a class="reference internal" href="functions.html"><span class="doc">Built-Ins Reference</span></a>.</p>
<p>Warp supports vectors of numbers with an arbitrary length/numeric type. The built-in concrete types are as follows:</p>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td><p>vec2 vec3 vec4</p></td>
<td><p>2D, 3D, 4D vector of single-precision floats</p></td>
</tr>
<tr class="row-even"><td><p>vec2b vec3b vec4b</p></td>
<td><p>2D, 3D, 4D vector of signed bytes</p></td>
</tr>
<tr class="row-odd"><td><p>vec2ub vec3ub vec4ub</p></td>
<td><p>2D, 3D, 4D vector of unsigned bytes</p></td>
</tr>
<tr class="row-even"><td><p>vec2s vec3s vec4s</p></td>
<td><p>2D, 3D, 4D vector of signed shorts</p></td>
</tr>
<tr class="row-odd"><td><p>vec2us vec3us vec4us</p></td>
<td><p>2D, 3D, 4D vector of unsigned shorts</p></td>
</tr>
<tr class="row-even"><td><p>vec2i vec3i vec4i</p></td>
<td><p>2D, 3D, 4D vector of signed integers</p></td>
</tr>
<tr class="row-odd"><td><p>vec2ui vec3ui vec4ui</p></td>
<td><p>2D, 3D, 4D vector of unsigned integers</p></td>
</tr>
<tr class="row-even"><td><p>vec2l vec3l vec4l</p></td>
<td><p>2D, 3D, 4D vector of signed long integers</p></td>
</tr>
<tr class="row-odd"><td><p>vec2ul vec3ul vec4ul</p></td>
<td><p>2D, 3D, 4D vector of unsigned long integers</p></td>
</tr>
<tr class="row-even"><td><p>vec2h vec3h vec4h</p></td>
<td><p>2D, 3D, 4D vector of half-precision floats</p></td>
</tr>
<tr class="row-odd"><td><p>vec2f vec3f vec4f</p></td>
<td><p>2D, 3D, 4D vector of single-precision floats</p></td>
</tr>
<tr class="row-even"><td><p>vec2d vec3d vec4d</p></td>
<td><p>2D, 3D, 4D vector of double-precision floats</p></td>
</tr>
<tr class="row-odd"><td><p>spatial_vector</p></td>
<td><p>6D vector of single-precision floats</p></td>
</tr>
<tr class="row-even"><td><p>spatial_vectorf</p></td>
<td><p>6D vector of single-precision floats</p></td>
</tr>
<tr class="row-odd"><td><p>spatial_vectord</p></td>
<td><p>6D vector of double-precision floats</p></td>
</tr>
<tr class="row-even"><td><p>spatial_vectorh</p></td>
<td><p>6D vector of half-precision floats</p></td>
</tr>
</tbody>
</table>
</div>
<p>Vectors support most standard linear algebra operations, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span> <span class="o">...</span> <span class="p">):</span>

    <span class="c1"># basis vectors</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>

    <span class="c1"># take the cross product</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

    <span class="c1"># compute</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>

    <span class="o">...</span>
</pre></div>
</div>
<p>It’s possible to declare additional vector types with different lengths and data types. This is done in outside of kernels in <em>Python scope</em> using <code class="docutils literal notranslate"><span class="pre">warp.types.vector()</span></code>, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># declare a new vector type for holding 5 double precision floats:</span>
<span class="n">vec5d</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">vector</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</pre></div>
</div>
<p>Once declared, the new type can be used when allocating arrays or inside kernels:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># create an array of vec5d</span>
<span class="n">arr</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">vec5d</span><span class="p">)</span>

<span class="c1"># use inside a kernel</span>
<span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span> <span class="o">...</span> <span class="p">):</span>

    <span class="c1"># zero initialize a custom named vector type</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">vec5d</span><span class="p">()</span>
    <span class="o">...</span>

    <span class="c1"># component-wise initialize a named vector type</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">vec5d</span><span class="p">(</span><span class="n">wp</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span>
              <span class="n">wp</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">2.0</span><span class="p">),</span>
              <span class="n">wp</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">3.0</span><span class="p">),</span>
              <span class="n">wp</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">4.0</span><span class="p">),</span>
              <span class="n">wp</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">5.0</span><span class="p">))</span>
  <span class="o">...</span>
</pre></div>
</div>
<p>In addition, it’s possible to directly create <em>anonymously</em> typed instances of these vectors without declaring their type in advance. In this case the type will be inferred by the constructor arguments. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span> <span class="o">...</span> <span class="p">):</span>

    <span class="c1"># zero initialize vector of 5 doubles:</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">vector</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

    <span class="c1"># scalar initialize a vector of 5 doubles to the same value:</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">vector</span><span class="p">(</span><span class="n">wp</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">length</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

    <span class="c1"># component-wise initialize a vector of 5 doubles</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">vector</span><span class="p">(</span><span class="n">wp</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span>
                  <span class="n">wp</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">2.0</span><span class="p">),</span>
                  <span class="n">wp</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">3.0</span><span class="p">),</span>
                  <span class="n">wp</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">4.0</span><span class="p">),</span>
                  <span class="n">wp</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">5.0</span><span class="p">))</span>
</pre></div>
</div>
<p>These can be used with all the standard vector arithmetic operators, e.g.: <code class="docutils literal notranslate"><span class="pre">+</span></code>, <code class="docutils literal notranslate"><span class="pre">-</span></code>, scalar multiplication, and can also be transformed using matrices with compatible dimensions, potentially returning vectors with a different length.</p>
</section>
<section id="matrices">
<span id="mat"></span><h3>Matrices<a class="headerlink" href="#matrices" title="Link to this heading">#</a></h3>
<p>Matrices with arbitrary shapes/numeric types are also supported. The built-in concrete matrix types are as follows:</p>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td><p>mat22 mat33 mat44</p></td>
<td><p>2x2, 3x3, 4x4 matrix of single-precision floats</p></td>
</tr>
<tr class="row-even"><td><p>mat22f mat33f mat44f</p></td>
<td><p>2x2, 3x3, 4x4 matrix of single-precision floats</p></td>
</tr>
<tr class="row-odd"><td><p>mat22d mat33d mat44d</p></td>
<td><p>2x2, 3x3, 4x4 matrix of double-precision floats</p></td>
</tr>
<tr class="row-even"><td><p>mat22h mat33h mat44h</p></td>
<td><p>2x2, 3x3, 4x4 matrix of half-precision floats</p></td>
</tr>
<tr class="row-odd"><td><p>spatial_matrix</p></td>
<td><p>6x6 matrix of single-precision floats</p></td>
</tr>
<tr class="row-even"><td><p>spatial_matrixf</p></td>
<td><p>6x6 matrix of single-precision floats</p></td>
</tr>
<tr class="row-odd"><td><p>spatial_matrixd</p></td>
<td><p>6x6 matrix of double-precision floats</p></td>
</tr>
<tr class="row-even"><td><p>spatial_matrixh</p></td>
<td><p>6x6 matrix of half-precision floats</p></td>
</tr>
</tbody>
</table>
</div>
<p>Matrices are stored in row-major format and support most standard linear algebra operations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span> <span class="o">...</span> <span class="p">):</span>

    <span class="c1"># initialize matrix</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">mat22</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span>
                 <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)</span>

    <span class="c1"># compute inverse</span>
    <span class="n">minv</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">inverse</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

    <span class="c1"># transform vector</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">minv</span> <span class="o">*</span> <span class="n">wp</span><span class="o">.</span><span class="n">vec2</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>

    <span class="o">...</span>
</pre></div>
</div>
<p>In a similar manner to vectors, it’s possible to declare new matrix types with arbitrary shapes and data types using <code class="docutils literal notranslate"><span class="pre">wp.types.matrix()</span></code>, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># declare a new 3x2 half precision float matrix type:</span>
<span class="n">mat32h</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

<span class="c1"># create an array of this type</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">mat32h</span><span class="p">)</span>
</pre></div>
</div>
<p>These can be used inside a kernel:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span> <span class="o">...</span> <span class="p">):</span>
    <span class="o">...</span>

    <span class="c1"># initialize a mat32h matrix</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">mat32h</span><span class="p">(</span><span class="n">wp</span><span class="o">.</span><span class="n">float16</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">wp</span><span class="o">.</span><span class="n">float16</span><span class="p">(</span><span class="mf">2.0</span><span class="p">),</span>
               <span class="n">wp</span><span class="o">.</span><span class="n">float16</span><span class="p">(</span><span class="mf">3.0</span><span class="p">),</span> <span class="n">wp</span><span class="o">.</span><span class="n">float16</span><span class="p">(</span><span class="mf">4.0</span><span class="p">),</span>
               <span class="n">wp</span><span class="o">.</span><span class="n">float16</span><span class="p">(</span><span class="mf">5.0</span><span class="p">),</span> <span class="n">wp</span><span class="o">.</span><span class="n">float16</span><span class="p">(</span><span class="mf">6.0</span><span class="p">))</span>

    <span class="c1"># declare a 2 component half precision vector</span>
    <span class="n">v2</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">vec2h</span><span class="p">(</span><span class="n">wp</span><span class="o">.</span><span class="n">float16</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">wp</span><span class="o">.</span><span class="n">float16</span><span class="p">(</span><span class="mf">1.0</span><span class="p">))</span>

    <span class="c1"># multiply by the matrix, returning a 3 component vector:</span>
    <span class="n">v3</span> <span class="o">=</span> <span class="n">m</span> <span class="o">*</span> <span class="n">v2</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>It’s also possible to directly create anonymously typed instances inside kernels where the type is inferred from constructor arguments as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span> <span class="o">...</span> <span class="p">):</span>
    <span class="o">...</span>

    <span class="c1"># create a 3x2 half precision matrix from components (row major ordering):</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span>
        <span class="n">wp</span><span class="o">.</span><span class="n">float16</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">wp</span><span class="o">.</span><span class="n">float16</span><span class="p">(</span><span class="mf">2.0</span><span class="p">),</span>
        <span class="n">wp</span><span class="o">.</span><span class="n">float16</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">wp</span><span class="o">.</span><span class="n">float16</span><span class="p">(</span><span class="mf">2.0</span><span class="p">),</span>
        <span class="n">wp</span><span class="o">.</span><span class="n">float16</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">wp</span><span class="o">.</span><span class="n">float16</span><span class="p">(</span><span class="mf">2.0</span><span class="p">),</span>
        <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

    <span class="c1"># zero initialize a 3x2 half precision matrix:</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">wp</span><span class="o">.</span><span class="n">float16</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

    <span class="c1"># create a 5x5 double precision identity matrix:</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</pre></div>
</div>
<p>As with vectors, you can do standard matrix arithmetic with these variables, along with multiplying matrices with compatible shapes and potentially returning a matrix with a new shape.</p>
</section>
<section id="quaternions">
<span id="quat"></span><h3>Quaternions<a class="headerlink" href="#quaternions" title="Link to this heading">#</a></h3>
<p>Warp supports quaternions with the layout <code class="docutils literal notranslate"><span class="pre">i,</span> <span class="pre">j,</span> <span class="pre">k,</span> <span class="pre">w</span></code> where <code class="docutils literal notranslate"><span class="pre">w</span></code> is the real part. Here are the built-in concrete quaternion types:</p>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td><p>quat</p></td>
<td><p>Single-precision floating point quaternion</p></td>
</tr>
<tr class="row-even"><td><p>quatf</p></td>
<td><p>Single-precision floating point quaternion</p></td>
</tr>
<tr class="row-odd"><td><p>quatd</p></td>
<td><p>Double-precision floating point quaternion</p></td>
</tr>
<tr class="row-even"><td><p>quath</p></td>
<td><p>Half-precision floating point quaternion</p></td>
</tr>
</tbody>
</table>
</div>
<p>Quaternions can be used to transform vectors as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span> <span class="o">...</span> <span class="p">):</span>
    <span class="o">...</span>

    <span class="c1"># construct a 30 degree rotation around the x-axis</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">quat_from_axis_angle</span><span class="p">(</span><span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="n">wp</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="mf">30.0</span><span class="p">))</span>

    <span class="c1"># rotate an axis by this quaternion</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">quat_rotate</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>
</pre></div>
</div>
<p>As with vectors and matrices, you can declare quaternion types with an arbitrary numeric type like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">quatd</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">quaternion</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</pre></div>
</div>
<p>You can also create identity quaternion and anonymously typed instances inside a kernel like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span> <span class="o">...</span> <span class="p">):</span>
    <span class="o">...</span>

    <span class="c1"># create a double precision identity quaternion:</span>
    <span class="n">qd</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">quat_identity</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

    <span class="c1"># precision defaults to wp.float32 so this creates a single precision identity quaternion:</span>
    <span class="n">qf</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">quat_identity</span><span class="p">()</span>

    <span class="c1"># create a half precision quaternion from components, or a vector/scalar:</span>
    <span class="n">qh</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">quaternion</span><span class="p">(</span><span class="n">wp</span><span class="o">.</span><span class="n">float16</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span>
                       <span class="n">wp</span><span class="o">.</span><span class="n">float16</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span>
                       <span class="n">wp</span><span class="o">.</span><span class="n">float16</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span>
                       <span class="n">wp</span><span class="o">.</span><span class="n">float16</span><span class="p">(</span><span class="mf">1.0</span><span class="p">))</span>


    <span class="n">qh</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">quaternion</span><span class="p">(</span>
        <span class="n">wp</span><span class="o">.</span><span class="n">vector</span><span class="p">(</span><span class="n">wp</span><span class="o">.</span><span class="n">float16</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span><span class="n">wp</span><span class="o">.</span><span class="n">float16</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span><span class="n">wp</span><span class="o">.</span><span class="n">float16</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)),</span>
        <span class="n">wp</span><span class="o">.</span><span class="n">float16</span><span class="p">(</span><span class="mf">1.0</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="transforms">
<span id="transform"></span><h3>Transforms<a class="headerlink" href="#transforms" title="Link to this heading">#</a></h3>
<p>Transforms are 7D vectors of floats representing a spatial rigid body transformation in format (p, q) where p is a 3D vector, and q is a quaternion.</p>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td><p>transform</p></td>
<td><p>Single-precision floating point transform</p></td>
</tr>
<tr class="row-even"><td><p>transformf</p></td>
<td><p>Single-precision floating point transform</p></td>
</tr>
<tr class="row-odd"><td><p>transformd</p></td>
<td><p>Double-precision floating point transform</p></td>
</tr>
<tr class="row-even"><td><p>transformh</p></td>
<td><p>Half-precision floating point transform</p></td>
</tr>
</tbody>
</table>
</div>
<p>Transforms can be constructed inside kernels from translation and rotation parts:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span> <span class="o">...</span> <span class="p">):</span>
    <span class="o">...</span>

    <span class="c1"># create a transform from a vector/quaternion:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
            <span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">),</span>
            <span class="n">wp</span><span class="o">.</span><span class="n">quat_from_axis_angle</span><span class="p">(</span><span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="n">wp</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="mf">30.0</span><span class="p">)))</span>

    <span class="c1"># transform a point</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">transform_point</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>

    <span class="c1"># transform a vector (ignore translation)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">transform_vector</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
</pre></div>
</div>
<p>As with vectors and matrices, you can declare transform types with an arbitrary numeric type using <code class="docutils literal notranslate"><span class="pre">wp.types.transformation()</span></code>, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">transformd</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">transformation</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</pre></div>
</div>
<p>You can also create identity transforms and anonymously typed instances inside a kernel like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span> <span class="o">...</span> <span class="p">):</span>

    <span class="c1"># create double precision identity transform:</span>
    <span class="n">qd</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">transform_identity</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="structs">
<span id="id6"></span><h3>Structs<a class="headerlink" href="#structs" title="Link to this heading">#</a></h3>
<p>Users can define custom structure types using the <code class="docutils literal notranslate"><span class="pre">&#64;wp.struct</span></code> decorator as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@wp</span><span class="o">.</span><span class="n">struct</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MyStruct</span><span class="p">:</span>

    <span class="n">param1</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">param2</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">param3</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">)</span>
</pre></div>
</div>
<p>Struct attributes must be annotated with their respective type. They can be constructed in Python scope and then passed to kernels as arguments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="n">MyStruct</span><span class="p">):</span>

    <span class="n">tid</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">tid</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">param1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">param2</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">param3</span><span class="p">[</span><span class="n">tid</span><span class="p">])</span>

<span class="c1"># construct an instance of the struct in Python</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">MyStruct</span><span class="p">()</span>
<span class="n">s</span><span class="o">.</span><span class="n">param1</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">s</span><span class="o">.</span><span class="n">param2</span> <span class="o">=</span> <span class="mf">2.5</span>
<span class="n">s</span><span class="o">.</span><span class="n">param3</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">)</span>

<span class="c1"># pass to our compute kernel</span>
<span class="n">wp</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span><span class="n">compute</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">s</span><span class="p">])</span>
</pre></div>
</div>
<p>An array of structs can be zero-initialized as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">MyStruct</span><span class="p">)</span>
</pre></div>
</div>
<p>An array of structs can also be initialized from a list of struct objects:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">MyStruct</span><span class="p">(),</span> <span class="n">MyStruct</span><span class="p">(),</span> <span class="n">MyStruct</span><span class="p">()],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">MyStruct</span><span class="p">)</span>
</pre></div>
</div>
<section id="example-using-a-struct-in-gradient-computation">
<h4>Example: Using a struct in gradient computation<a class="headerlink" href="#example-using-a-struct-in-gradient-computation" title="Link to this heading">#</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">warp</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">wp</span>


<span class="nd">@wp</span><span class="o">.</span><span class="n">struct</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TestStruct</span><span class="p">:</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">vec3</span>
    <span class="n">a</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">)</span>
    <span class="n">b</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">)</span>


<span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_kernel</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="n">TestStruct</span><span class="p">):</span>
    <span class="n">tid</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">tid</span><span class="p">()</span>

    <span class="n">s</span><span class="o">.</span><span class="n">b</span><span class="p">[</span><span class="n">tid</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="n">tid</span><span class="p">]</span> <span class="o">+</span> <span class="n">s</span><span class="o">.</span><span class="n">x</span>


<span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">loss_kernel</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="n">TestStruct</span><span class="p">,</span> <span class="n">loss</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)):</span>
    <span class="n">tid</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">tid</span><span class="p">()</span>

    <span class="n">v</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">b</span><span class="p">[</span><span class="n">tid</span><span class="p">]</span>
    <span class="n">wp</span><span class="o">.</span><span class="n">atomic_add</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">tid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>


<span class="c1"># create struct</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">TestStruct</span><span class="p">()</span>

<span class="c1"># set members</span>
<span class="n">ts</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
<span class="n">ts</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">]]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ts</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">loss</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">tape</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">Tape</span><span class="p">()</span>
<span class="k">with</span> <span class="n">tape</span><span class="p">:</span>
    <span class="n">wp</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span><span class="n">test_kernel</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">ts</span><span class="p">])</span>
    <span class="n">wp</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span><span class="n">loss_kernel</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">ts</span><span class="p">,</span> <span class="n">loss</span><span class="p">])</span>

<span class="n">tape</span><span class="o">.</span><span class="n">backward</span><span class="p">(</span><span class="n">loss</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">loss</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[120.]
[[1. 2. 3.]
 [4. 5. 6.]]
</pre></div>
</div>
</section>
<section id="example-defining-operator-overloads">
<h4>Example: Defining Operator Overloads<a class="headerlink" href="#example-defining-operator-overloads" title="Link to this heading">#</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@wp</span><span class="o">.</span><span class="n">struct</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Complex</span><span class="p">:</span>
    <span class="n">real</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">imag</span><span class="p">:</span> <span class="nb">float</span>

<span class="nd">@wp</span><span class="o">.</span><span class="n">func</span>
<span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span>
    <span class="n">a</span><span class="p">:</span> <span class="n">Complex</span><span class="p">,</span>
    <span class="n">b</span><span class="p">:</span> <span class="n">Complex</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Complex</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">Complex</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">real</span> <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">imag</span> <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>

<span class="nd">@wp</span><span class="o">.</span><span class="n">func</span>
<span class="k">def</span><span class="w"> </span><span class="nf">mul</span><span class="p">(</span>
    <span class="n">a</span><span class="p">:</span> <span class="n">Complex</span><span class="p">,</span>
    <span class="n">b</span><span class="p">:</span> <span class="n">Complex</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Complex</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">Complex</span><span class="p">(</span>
        <span class="n">a</span><span class="o">.</span><span class="n">real</span> <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">real</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">imag</span> <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span>
        <span class="n">a</span><span class="o">.</span><span class="n">real</span> <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">imag</span> <span class="o">+</span> <span class="n">a</span><span class="o">.</span><span class="n">imag</span> <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">real</span><span class="p">,</span>
    <span class="p">)</span>

<span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">kernel</span><span class="p">():</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">Complex</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">Complex</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)</span>

    <span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
    <span class="n">wp</span><span class="o">.</span><span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%.0f</span><span class="s2"> </span><span class="si">%+.0f</span><span class="s2">i</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>

    <span class="n">d</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>
    <span class="n">wp</span><span class="o">.</span><span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%.0f</span><span class="s2"> </span><span class="si">%+.0f</span><span class="s2">i</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>

<span class="n">wp</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,))</span>
<span class="n">wp</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="indexing-and-slicing">
<h3>Indexing and Slicing<a class="headerlink" href="#indexing-and-slicing" title="Link to this heading">#</a></h3>
<p>Indexing and slicing for vectors, matrices, quaternions, and transforms, follow NumPy-like semantics for element access:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span> <span class="o">...</span> <span class="p">):</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
    <span class="n">wp</span><span class="o">.</span><span class="n">expect_eq</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mf">3.0</span><span class="p">)</span> <span class="c1"># negative indices wrap</span>
    <span class="n">wp</span><span class="o">.</span><span class="n">expect_eq</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">wp</span><span class="o">.</span><span class="n">vec2</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">))</span> <span class="c1"># slice returns a new vector</span>

    <span class="n">v</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c1"># slice assignment</span>
    <span class="n">wp</span><span class="o">.</span><span class="n">expect_eq</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>

    <span class="n">m</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">matrix_from_rows</span><span class="p">(</span>
        <span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">),</span>
        <span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">(</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">),</span>
        <span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">(</span><span class="mf">7.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">wp</span><span class="o">.</span><span class="n">expect_eq</span><span class="p">(</span><span class="n">m</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">))</span> <span class="c1"># column vector</span>
    <span class="n">wp</span><span class="o">.</span><span class="n">expect_eq</span><span class="p">(</span>
        <span class="n">m</span><span class="p">[:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:],</span> <span class="c1"># 2x2 sub-matrix</span>
        <span class="n">wp</span><span class="o">.</span><span class="n">matrix_from_rows</span><span class="p">(</span><span class="n">wp</span><span class="o">.</span><span class="n">vec2</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">),</span> <span class="n">wp</span><span class="o">.</span><span class="n">vec2</span><span class="p">(</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">))</span>
    <span class="p">)</span>

    <span class="n">m</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">11.0</span><span class="p">,</span> <span class="mf">12.0</span><span class="p">)</span> <span class="c1"># column vector assignment</span>
    <span class="n">wp</span><span class="o">.</span><span class="n">expect_eq</span><span class="p">(</span>
        <span class="n">m</span><span class="p">,</span>
        <span class="n">wp</span><span class="o">.</span><span class="n">matrix_from_rows</span><span class="p">(</span>
            <span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">),</span>
            <span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">(</span><span class="mf">11.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">),</span>
            <span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">(</span><span class="mf">12.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>Negative indices are wrapped around, such that <code class="docutils literal notranslate"><span class="pre">-1</span></code> refers to the last element. Slices always create new copies.</p>
<p>Inside kernels, the <code class="docutils literal notranslate"><span class="pre">start</span> <span class="pre">/</span> <span class="pre">stop</span> <span class="pre">/</span> <span class="pre">step</span></code> values of a slice must be <strong>compile-time constants</strong>.  Simple element indexing (<code class="docutils literal notranslate"><span class="pre">v[i]</span></code>, <code class="docutils literal notranslate"><span class="pre">m[i,</span> <span class="pre">j]</span></code>) may use run-time
expressions.</p>
</section>
<section id="type-conversions">
<h3>Type Conversions<a class="headerlink" href="#type-conversions" title="Link to this heading">#</a></h3>
<p>Warp is particularly strict regarding type conversions and does not perform <em>any</em> implicit conversion between numeric types.
The user is responsible for ensuring types for most arithmetic operators match, e.g.: <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">float(0.0)</span> <span class="pre">+</span> <span class="pre">int(4)</span></code> will result in an error.
This can be surprising for users that are accustomed to C-style conversions but avoids a class of common bugs that result from implicit conversions.</p>
<p>Users should explicitly cast variables to compatible types using constructors like
<code class="docutils literal notranslate"><span class="pre">int()</span></code>, <code class="docutils literal notranslate"><span class="pre">float()</span></code>, <code class="docutils literal notranslate"><span class="pre">wp.float16()</span></code>, <code class="docutils literal notranslate"><span class="pre">wp.uint8()</span></code>, etc.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For performance reasons, Warp relies on native compilers to perform numeric conversions (e.g., LLVM for CPU and NVRTC for CUDA).
This is generally not a problem, but in some cases the results may vary on different devices.
For example, the conversion <code class="docutils literal notranslate"><span class="pre">wp.uint8(-1.0)</span></code> results in undefined behavior, since the floating point value -1.0
is out of range for unsigned integer types.</p>
<p>C++ compilers are free to handle such cases as they see fit.
Numeric conversions are only guaranteed to produce correct results when the value being converted is in the range
supported by the target data type.</p>
</div>
</section>
</section>
<section id="constants">
<h2>Constants<a class="headerlink" href="#constants" title="Link to this heading">#</a></h2>
<p>A Warp kernel can access Python variables defined outside of the kernel, which are treated as compile-time constants inside of the kernel.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">TYPE_SPHERE</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">TYPE_CUBE</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">TYPE_CAPSULE</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">collide</span><span class="p">(</span><span class="n">geometry</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)):</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">geometry</span><span class="p">[</span><span class="n">wp</span><span class="o">.</span><span class="n">tid</span><span class="p">()]</span>

    <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="n">TYPE_SPHERE</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sphere&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">t</span> <span class="o">==</span> <span class="n">TYPE_CUBE</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;cube&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">t</span> <span class="o">==</span> <span class="n">TYPE_CAPSULE</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;capsule&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that using <code class="docutils literal notranslate"><span class="pre">wp.constant()</span></code> is no longer required, but it performs some type checking and can serve as a reminder that the variables are meant to be used as Warp constants.</p>
<p>The behavior is simple and intuitive when the referenced Python variables never change. For details and more complex scenarios, refer to <a class="reference internal" href="../codegen.html#external-references"><span class="std std-ref">External References and Constants</span></a>. The <a class="reference internal" href="../codegen.html#code-generation"><span class="std std-ref">Code Generation</span></a> section contains additional information and tips for advanced usage.</p>
<section id="predefined-constants">
<h3>Predefined Constants<a class="headerlink" href="#predefined-constants" title="Link to this heading">#</a></h3>
<p>For convenience, Warp has a number of predefined mathematical constants that
may be used both inside and outside Warp kernels.
The constants in the following table also have lowercase versions defined,
e.g. <code class="docutils literal notranslate"><span class="pre">wp.E</span></code> and <code class="docutils literal notranslate"><span class="pre">wp.e</span></code> are equivalent.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>wp.E</p></td>
<td><p>2.71828182845904523536</p></td>
</tr>
<tr class="row-odd"><td><p>wp.LOG2E</p></td>
<td><p>1.44269504088896340736</p></td>
</tr>
<tr class="row-even"><td><p>wp.LOG10E</p></td>
<td><p>0.43429448190325182765</p></td>
</tr>
<tr class="row-odd"><td><p>wp.LN2</p></td>
<td><p>0.69314718055994530942</p></td>
</tr>
<tr class="row-even"><td><p>wp.LN10</p></td>
<td><p>2.30258509299404568402</p></td>
</tr>
<tr class="row-odd"><td><p>wp.PHI</p></td>
<td><p>1.61803398874989484820</p></td>
</tr>
<tr class="row-even"><td><p>wp.PI</p></td>
<td><p>3.14159265358979323846</p></td>
</tr>
<tr class="row-odd"><td><p>wp.HALF_PI</p></td>
<td><p>1.57079632679489661923</p></td>
</tr>
<tr class="row-even"><td><p>wp.TAU</p></td>
<td><p>6.28318530717958647692</p></td>
</tr>
<tr class="row-odd"><td><p>wp.INF</p></td>
<td><p>math.inf</p></td>
</tr>
<tr class="row-even"><td><p>wp.NAN</p></td>
<td><p>float(‘nan’)</p></td>
</tr>
</tbody>
</table>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">wp.NAN</span></code> constant may only be used with floating-point types.
Comparisons involving <code class="docutils literal notranslate"><span class="pre">wp.NAN</span></code> follow the IEEE 754 standard,
e.g. <code class="docutils literal notranslate"><span class="pre">wp.float32(wp.NAN)</span> <span class="pre">==</span> <span class="pre">wp.float32(wp.NAN)</span></code> returns <code class="docutils literal notranslate"><span class="pre">False</span></code>.
The <a class="reference internal" href="functions.html#warp.isnan" title="warp.isnan"><code class="xref py py-func docutils literal notranslate"><span class="pre">wp.isnan()</span></code></a> built-in function can be used to determine whether a
value is a NaN (or if a vector, matrix, or quaternion contains a NaN entry).</p>
<p>The following example shows how positive and negative infinity
can be used with floating-point types in Warp using the <code class="docutils literal notranslate"><span class="pre">wp.inf</span></code> constant:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_infinity</span><span class="p">(</span><span class="n">outputs</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">float32</span><span class="p">)):</span>
    <span class="n">outputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">wp</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>        <span class="c1"># inf</span>
    <span class="n">outputs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="o">-</span><span class="n">wp</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>       <span class="c1"># -inf</span>
    <span class="n">outputs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">wp</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>  <span class="c1"># inf</span>
    <span class="n">outputs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">wp</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span> <span class="c1"># -inf</span>
    <span class="n">outputs</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">/</span> <span class="mf">0.0</span><span class="p">)</span>     <span class="c1"># inf</span>
    <span class="n">outputs</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span> <span class="o">/</span> <span class="mf">0.0</span><span class="p">)</span>    <span class="c1"># -inf</span>
</pre></div>
</div>
</section>
</section>
<section id="operators">
<h2>Operators<a class="headerlink" href="#operators" title="Link to this heading">#</a></h2>
<section id="boolean-operators">
<h3>Boolean Operators<a class="headerlink" href="#boolean-operators" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td><p>a and b</p></td>
<td><p>True if a and b are True</p></td>
</tr>
<tr class="row-even"><td><p>a or b</p></td>
<td><p>True if a or b is True</p></td>
</tr>
<tr class="row-odd"><td><p>not a</p></td>
<td><p>True if a is False, otherwise False</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Expressions such as <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">(a</span> <span class="pre">and</span> <span class="pre">b):</span></code> currently do not perform short-circuit evaluation.
In this case <code class="docutils literal notranslate"><span class="pre">b</span></code> will also be evaluated even when <code class="docutils literal notranslate"><span class="pre">a</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>.
Users should take care to ensure that secondary conditions are safe to evaluate (e.g.: do not index out of bounds) in all cases.</p>
</div>
</section>
<section id="comparison-operators">
<h3>Comparison Operators<a class="headerlink" href="#comparison-operators" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td><p>a &gt; b</p></td>
<td><p>True if a strictly greater than b</p></td>
</tr>
<tr class="row-even"><td><p>a &lt; b</p></td>
<td><p>True if a strictly less than b</p></td>
</tr>
<tr class="row-odd"><td><p>a &gt;= b</p></td>
<td><p>True if a greater than or equal to b</p></td>
</tr>
<tr class="row-even"><td><p>a &lt;= b</p></td>
<td><p>True if a less than or equal to b</p></td>
</tr>
<tr class="row-odd"><td><p>a == b</p></td>
<td><p>True if a equals b</p></td>
</tr>
<tr class="row-even"><td><p>a != b</p></td>
<td><p>True if a not equal to b</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="arithmetic-operators">
<h3>Arithmetic Operators<a class="headerlink" href="#arithmetic-operators" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td><p>a + b</p></td>
<td><p>Addition</p></td>
</tr>
<tr class="row-even"><td><p>a - b</p></td>
<td><p>Subtraction</p></td>
</tr>
<tr class="row-odd"><td><p>a * b</p></td>
<td><p>Multiplication</p></td>
</tr>
<tr class="row-even"><td><p>a &#64; b</p></td>
<td><p>Matrix multiplication</p></td>
</tr>
<tr class="row-odd"><td><p>a / b</p></td>
<td><p>Floating point division</p></td>
</tr>
<tr class="row-even"><td><p>a // b</p></td>
<td><p>Floored division</p></td>
</tr>
<tr class="row-odd"><td><p>a ** b</p></td>
<td><p>Exponentiation</p></td>
</tr>
<tr class="row-even"><td><p>a % b</p></td>
<td><p>Modulus</p></td>
</tr>
</tbody>
</table>
</div>
<p>Since Warp does not perform implicit type conversions, operands should have compatible data types.
Users should use type constructors such as <code class="docutils literal notranslate"><span class="pre">float()</span></code>, <code class="docutils literal notranslate"><span class="pre">int()</span></code>, <code class="docutils literal notranslate"><span class="pre">wp.int64()</span></code>, etc. to cast variables
to the correct type.</p>
<p>The multiplication expression <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">*</span> <span class="pre">b</span></code> can also be used to perform matrix multiplication
between <a class="reference external" href="Matrices">matrix types</a>.</p>
</section>
<section id="mapping-functions">
<h3>Mapping Functions<a class="headerlink" href="#mapping-functions" title="Link to this heading">#</a></h3>
<p>The <code class="xref py py-func docutils literal notranslate"><span class="pre">wp.map()</span></code> function can be used to apply a function to each element of an array.</p>
<dl class="py function">
<dt class="sig sig-object py" id="warp.utils.map">
<span class="sig-prename descclassname"><span class="pre">warp.utils.</span></span><span class="sig-name descname"><span class="pre">map</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">inputs</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">return_kernel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">block_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/utils.py#L758-L1073"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.utils.map" title="Link to this definition">#</a></dt>
<dd><p>Map a function over the elements of one or more arrays.</p>
<p>You can use a Warp function, a regular Python function, or a lambda expression to map it to a set of arrays.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">y</span> <span class="o">-</span> <span class="n">z</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[2. 4. 6.]
</pre></div>
</div>
<p>Clamp values in an array in place:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">xs</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">wp</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">wp</span><span class="o">.</span><span class="n">clamp</span><span class="p">,</span> <span class="n">xs</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">xs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[-0.5  0.   0.5]
</pre></div>
</div>
<p>Note that only one of the inputs must be a Warp array. For example, it is possible
vectorize the function <a class="reference internal" href="functions.html#warp.transform_point" title="warp.transform_point"><code class="xref py py-func docutils literal notranslate"><span class="pre">warp.transform_point()</span></code></a> over a collection of points
with a given input transform as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tf</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">transform</span><span class="p">((</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">),</span> <span class="n">wp</span><span class="o">.</span><span class="n">quat_rpy</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">))</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">)</span>
<span class="n">transformed</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">wp</span><span class="o">.</span><span class="n">transform_point</span><span class="p">,</span> <span class="n">tf</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span>
</pre></div>
</div>
<p>Besides regular Warp arrays, other array types, such as the <code class="docutils literal notranslate"><span class="pre">indexedarray</span></code>, are supported as well:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">arr</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="n">indices</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">iarr</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">indexedarray1d</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">[</span><span class="n">indices</span><span class="p">])</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="mf">10.0</span><span class="p">,</span> <span class="n">iarr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[10. 30. 50. 70. 90.]
</pre></div>
</div>
<p>If multiple arrays are provided, the
<a class="reference external" href="https://numpy.org/doc/stable/user/basics.broadcasting.html">NumPy broadcasting rules</a>
are applied to determine the shape of the output array.
Two shapes are compatible when:
starting from the trailing dimension,</p>
<ol class="arabic simple">
<li><p>the two dimensions are equal, or</p></li>
<li><p>one of the dimensions is 1.</p></li>
</ol>
<p>For example, given arrays of shapes <code class="docutils literal notranslate"><span class="pre">(3,</span> <span class="pre">1,</span> <span class="pre">4)</span></code> and <code class="docutils literal notranslate"><span class="pre">(5,</span> <span class="pre">4)</span></code>, the broadcasted
shape is <code class="docutils literal notranslate"><span class="pre">(3,</span> <span class="pre">5,</span> <span class="pre">4)</span></code>.</p>
<p>If no array(s) are provided to the <code class="docutils literal notranslate"><span class="pre">out</span></code> argument, the output array(s) are created automatically.
The data type(s) of the output array(s) are determined by the type of the return value(s) of
the function. The <code class="docutils literal notranslate"><span class="pre">requires_grad</span></code> flag for an automatically created output array is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>
if any of the input arrays have it set to <code class="docutils literal notranslate"><span class="pre">True</span></code> and the respective output array’s <code class="docutils literal notranslate"><span class="pre">dtype</span></code> is a type that
supports differentiation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>Callable</em><em> | </em><em>Function</em>) – The function to map over the arrays.</p></li>
<li><p><strong>*inputs</strong> (<a class="reference internal" href="#warp.array" title="warp.array"><em>array</em></a><em> | </em><em>Any</em>) – The input arrays or values to pass to the function.</p></li>
<li><p><strong>out</strong> (<a class="reference internal" href="#warp.array" title="warp.array"><em>array</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference internal" href="#warp.array" title="warp.array"><em>array</em></a><em>] </em><em>| </em><em>None</em>) – Optional output array(s) to store the result(s). If None, the output array(s) will be created automatically.</p></li>
<li><p><strong>return_kernel</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – If True, only return the generated kernel without performing the mapping operation.</p></li>
<li><p><strong>block_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The block dimension for the kernel launch.</p></li>
<li><p><strong>device</strong> (<em>Devicelike</em>) – The device on which to run the kernel.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The resulting array(s) of the mapping. If <code class="docutils literal notranslate"><span class="pre">return_kernel</span></code> is True, only returns the kernel used for mapping.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#warp.array" title="warp.array">array</a> | <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a>[<a class="reference internal" href="#warp.array" title="warp.array">array</a>] | Kernel</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="streams">
<h2>Streams<a class="headerlink" href="#streams" title="Link to this heading">#</a></h2>
<p>A CUDA stream is a sequence of operations that execute in order on the GPU.
Operations from different streams may run concurrently and may be interleaved by the device scheduler.
See the <a class="reference internal" href="concurrency.html#streams"><span class="std std-ref">Streams documentation</span></a> for more information on using streams.</p>
<dl class="py class">
<dt class="sig sig-object py" id="warp.Stream">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">Stream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L2849-L2994"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Stream" title="Link to this definition">#</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="warp.Stream.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priority</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L2856-L2906"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Stream.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize the stream on a device with an optional specified priority.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> (<a class="reference internal" href="devices.html#warp.context.Device" title="warp.context.Device"><em>Device</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – The CUDA device on which this stream will be created.</p></li>
<li><p><strong>priority</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – An optional integer specifying the requested stream priority.
Can be -1 (high priority) or 0 (low/default priority).
Values outside this range will be clamped.</p></li>
<li><p><strong>cuda_stream</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – A optional external stream handle passed as an
integer. The caller is responsible for ensuring that the external
stream does not get destroyed while it is referenced by this
object.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.13)"><strong>RuntimeError</strong></a> – If function is called before Warp has completed
    initialization with a <code class="docutils literal notranslate"><span class="pre">device</span></code> that is not an instance of
    <a class="reference internal" href="devices.html#warp.context.Device" title="warp.context.Device"><code class="xref py py-class docutils literal notranslate"><span class="pre">Device</span></code></a>.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.13)"><strong>RuntimeError</strong></a> – <code class="docutils literal notranslate"><span class="pre">device</span></code> is not a CUDA Device.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.13)"><strong>RuntimeError</strong></a> – The stream could not be created on the device.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a> – The requested stream priority is not an integer.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.Stream.record_event">
<span class="sig-name descname"><span class="pre">record_event</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">event</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L2922-L2943"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Stream.record_event" title="Link to this definition">#</a></dt>
<dd><p>Record an event onto the stream.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>event</strong> (<a class="reference internal" href="#warp.Event" title="warp.context.Event"><em>Event</em></a><em> | </em><em>None</em>) – A warp.Event instance to be recorded onto the stream. If not
provided, an <a class="reference internal" href="#warp.Event" title="warp.Event"><code class="xref py py-class docutils literal notranslate"><span class="pre">Event</span></code></a> on the same device will be created.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.13)"><strong>RuntimeError</strong></a> – The provided <a class="reference internal" href="#warp.Event" title="warp.Event"><code class="xref py py-class docutils literal notranslate"><span class="pre">Event</span></code></a> is from a different device than
    the recording stream.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#warp.Event" title="warp.context.Event"><em>Event</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.Stream.wait_event">
<span class="sig-name descname"><span class="pre">wait_event</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">event</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L2944-L2950"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Stream.wait_event" title="Link to this definition">#</a></dt>
<dd><p>Makes all future work in this stream wait until <cite>event</cite> has completed.</p>
<p>This function does not block the host thread.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>event</strong> (<a class="reference internal" href="#warp.Event" title="warp.context.Event"><em>Event</em></a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.Stream.wait_stream">
<span class="sig-name descname"><span class="pre">wait_stream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other_stream</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L2951-L2973"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Stream.wait_stream" title="Link to this definition">#</a></dt>
<dd><p>Records an event on <cite>other_stream</cite> and makes this stream wait on it.</p>
<p>All work added to this stream after this function has been called will
delay their execution until all preceding commands in <cite>other_stream</cite>
have completed.</p>
<p>This function does not block the host thread.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other_stream</strong> (<a class="reference internal" href="#warp.Stream" title="warp.context.Stream"><em>Stream</em></a>) – The stream on which the calling stream will wait for
previously issued commands to complete before executing subsequent
commands.</p></li>
<li><p><strong>event</strong> (<a class="reference internal" href="#warp.Event" title="warp.context.Event"><em>Event</em></a><em> | </em><em>None</em>) – An optional <a class="reference internal" href="#warp.Event" title="warp.Event"><code class="xref py py-class docutils literal notranslate"><span class="pre">Event</span></code></a> instance that will be used to
record an event onto <code class="docutils literal notranslate"><span class="pre">other_stream</span></code>. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, an internally
managed <a class="reference internal" href="#warp.Event" title="warp.Event"><code class="xref py py-class docutils literal notranslate"><span class="pre">Event</span></code></a> instance will be used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="warp.Stream.is_complete">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_complete</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><span class="pre">bool</span></a></em><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L2974-L2984"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Stream.is_complete" title="Link to this definition">#</a></dt>
<dd><p>A boolean indicating whether all work on the stream has completed.</p>
<p>This property may not be accessed during a graph capture on any stream.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="warp.Stream.is_capturing">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_capturing</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><span class="pre">bool</span></a></em><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L2985-L2989"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Stream.is_capturing" title="Link to this definition">#</a></dt>
<dd><p>A boolean indicating whether a graph capture is currently ongoing on this stream.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="warp.Stream.priority">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">priority</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L2990-L2994"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Stream.priority" title="Link to this definition">#</a></dt>
<dd><p>An integer representing the priority of the stream.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.get_stream">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">get_stream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L5140-L5153"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.get_stream" title="Link to this definition">#</a></dt>
<dd><p>Return the stream currently used by the given device.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device</strong> (<a class="reference internal" href="devices.html#warp.context.Device" title="warp.context.Device"><em>Device</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – An optional <code class="xref py py-class docutils literal notranslate"><span class="pre">Device</span></code> instance or device alias
(e.g. “cuda:0”) for which the current stream will be returned.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the default device will be used.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.13)"><strong>RuntimeError</strong></a> – The device is not a CUDA device.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#warp.Stream" title="warp.context.Stream"><em>Stream</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.set_stream">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">set_stream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stream</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sync</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L5155-L5168"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.set_stream" title="Link to this definition">#</a></dt>
<dd><p>Convenience function for calling <code class="xref py py-meth docutils literal notranslate"><span class="pre">Device.set_stream()</span></code> on the given <code class="docutils literal notranslate"><span class="pre">device</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> (<a class="reference internal" href="devices.html#warp.context.Device" title="warp.context.Device"><em>Device</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – An optional <code class="xref py py-class docutils literal notranslate"><span class="pre">Device</span></code> instance or device alias
(e.g. “cuda:0”) for which the current stream is to be replaced with
<code class="docutils literal notranslate"><span class="pre">stream</span></code>. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the default device will be used.</p></li>
<li><p><strong>stream</strong> (<a class="reference internal" href="#warp.Stream" title="warp.context.Stream"><em>Stream</em></a>) – The stream to set as this device’s current stream.</p></li>
<li><p><strong>sync</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then <code class="docutils literal notranslate"><span class="pre">stream</span></code> will perform a device-side
synchronization with the device’s previous current stream.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.wait_stream">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">wait_stream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other_stream</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L5219-L5232"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.wait_stream" title="Link to this definition">#</a></dt>
<dd><p>Convenience function for calling <a class="reference internal" href="#warp.Stream.wait_stream" title="warp.Stream.wait_stream"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Stream.wait_stream()</span></code></a> on the current stream.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other_stream</strong> (<a class="reference internal" href="#warp.Stream" title="warp.context.Stream"><em>Stream</em></a>) – The stream on which the calling stream will wait for
previously issued commands to complete before executing subsequent
commands.</p></li>
<li><p><strong>event</strong> (<a class="reference internal" href="#warp.Event" title="warp.context.Event"><em>Event</em></a><em> | </em><em>None</em>) – An optional <a class="reference internal" href="#warp.Event" title="warp.Event"><code class="xref py py-class docutils literal notranslate"><span class="pre">Event</span></code></a> instance that will be used to
record an event onto <code class="docutils literal notranslate"><span class="pre">other_stream</span></code>. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, an internally
managed <a class="reference internal" href="#warp.Event" title="warp.Event"><code class="xref py py-class docutils literal notranslate"><span class="pre">Event</span></code></a> instance will be used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.synchronize_stream">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">synchronize_stream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stream_or_device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L6464-L6480"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.synchronize_stream" title="Link to this definition">#</a></dt>
<dd><p>Synchronize the calling CPU thread with any outstanding CUDA work on the specified stream.</p>
<p>This function allows the host application code to ensure that all kernel launches
and memory copies have completed on the stream.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>stream_or_device</strong> (<a class="reference internal" href="#warp.Stream" title="warp.context.Stream"><em>Stream</em></a><em> | </em><a class="reference internal" href="devices.html#warp.context.Device" title="warp.context.Device"><em>Device</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – <cite>wp.Stream</cite> or a device.  If the argument is a device, synchronize the device’s current stream.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.ScopedStream">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">ScopedStream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stream</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sync_enter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sync_exit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/utils.py#L1238-L1284"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.ScopedStream" title="Link to this definition">#</a></dt>
<dd><p>A context manager to temporarily change the current stream on a device.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stream</strong> (<em>wp.Stream</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>sync_enter</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>)</p></li>
<li><p><strong>sync_exit</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="warp.ScopedStream.stream">
<span class="sig-name descname"><span class="pre">stream</span></span><a class="headerlink" href="#warp.ScopedStream.stream" title="Link to this definition">#</a></dt>
<dd><p>The stream that will temporarily become the device’s
default stream within the context.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#warp.Stream" title="warp.Stream">Stream</a> or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.ScopedStream.saved_stream">
<span class="sig-name descname"><span class="pre">saved_stream</span></span><a class="headerlink" href="#warp.ScopedStream.saved_stream" title="Link to this definition">#</a></dt>
<dd><p>The device’s previous current stream. This is
restored as the device’s current stream on exiting the context.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#warp.Stream" title="warp.Stream">Stream</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.ScopedStream.sync_enter">
<span class="sig-name descname"><span class="pre">sync_enter</span></span><a class="headerlink" href="#warp.ScopedStream.sync_enter" title="Link to this definition">#</a></dt>
<dd><p>Whether to synchronize this context’s stream with
the device’s previous current stream on entering the context.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="functions.html#warp.bool" title="warp.bool">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.ScopedStream.sync_exit">
<span class="sig-name descname"><span class="pre">sync_exit</span></span><a class="headerlink" href="#warp.ScopedStream.sync_exit" title="Link to this definition">#</a></dt>
<dd><p>Whether to synchronize the device’s previous current
with this context’s stream on exiting the context.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="functions.html#warp.bool" title="warp.bool">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.ScopedStream.device">
<span class="sig-name descname"><span class="pre">device</span></span><a class="headerlink" href="#warp.ScopedStream.device" title="Link to this definition">#</a></dt>
<dd><p>The device associated with the stream.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="devices.html#warp.context.Device" title="warp.context.Device">Device</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.ScopedStream.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stream</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sync_enter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sync_exit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/utils.py#L1253-L1271"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.ScopedStream.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initializes the context manager with a stream and synchronization options.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stream</strong> (<a class="reference internal" href="#warp.Stream" title="warp.context.Stream"><em>Stream</em></a><em> | </em><em>None</em>) – The stream that will temporarily become the device’s
default stream within the context.</p></li>
<li><p><strong>sync_enter</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – Whether to synchronize this context’s stream with
the device’s previous current stream on entering the context.</p></li>
<li><p><strong>sync_exit</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – Whether to synchronize the device’s previous current
with this context’s stream on exiting the context.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="events">
<h2>Events<a class="headerlink" href="#events" title="Link to this heading">#</a></h2>
<p>Events can be inserted into streams and used to synchronize a stream
with a different one. See the <a class="reference internal" href="concurrency.html#cuda-events"><span class="std std-ref">Events documentation</span></a> for
information on how to use events for cross-stream synchronization
or the <a class="reference internal" href="../profiling.html#cuda-events-profiling"><span class="std std-ref">CUDA Events Timing documentation</span></a> for
information on how to use events for measuring GPU performance.</p>
<dl class="py class">
<dt class="sig sig-object py" id="warp.Event">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">Event</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L2732-L2847"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Event" title="Link to this definition">#</a></dt>
<dd><p>A CUDA event that can be recorded onto a stream.</p>
<p>Events can be used for device-side synchronization, which do not block
the host thread.</p>
<dl class="py method">
<dt class="sig sig-object py" id="warp.Event.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">cuda_event</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">enable_timing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">interprocess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L2752-L2796"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Event.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initializes the event on a CUDA device.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> (<a class="reference internal" href="devices.html#warp.context.Device" title="warp.context.Device"><em>Device</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – The CUDA device whose streams this event may be recorded onto.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then the current default device will be used.</p></li>
<li><p><strong>cuda_event</strong> – A pointer to a previously allocated CUDA event. If
<cite>None</cite>, then a new event will be allocated on the associated device.</p></li>
<li><p><strong>enable_timing</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> this event will record timing data.
<a class="reference internal" href="#warp.get_event_elapsed_time" title="warp.get_event_elapsed_time"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_event_elapsed_time()</span></code></a> can be used to measure the
time between two events created with <code class="docutils literal notranslate"><span class="pre">enable_timing=True</span></code> and
recorded onto streams.</p></li>
<li><p><strong>interprocess</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> this event may be used as an interprocess event.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.13)"><strong>RuntimeError</strong></a> – The event could not be created.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – The combination of <code class="docutils literal notranslate"><span class="pre">enable_timing=True</span></code> and
    <code class="docutils literal notranslate"><span class="pre">interprocess=True</span></code> is not allowed.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.Event.ipc_handle">
<span class="sig-name descname"><span class="pre">ipc_handle</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L2797-L2830"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Event.ipc_handle" title="Link to this definition">#</a></dt>
<dd><p>Return a CUDA IPC handle of the event as a 64-byte <code class="docutils literal notranslate"><span class="pre">bytes</span></code> object.</p>
<p>The event must have been created with <code class="docutils literal notranslate"><span class="pre">interprocess=True</span></code> in order to
obtain a valid interprocess handle.</p>
<p>IPC is currently only supported on Linux.</p>
<p class="rubric">Example</p>
<p>Create an event and get its IPC handle:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">e1</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">Event</span><span class="p">(</span><span class="n">interprocess</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">event_handle</span> <span class="o">=</span> <span class="n">e1</span><span class="o">.</span><span class="n">ipc_handle</span><span class="p">()</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.13)"><strong>RuntimeError</strong></a> – Device does not support IPC.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.13)">bytes</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="warp.Event.is_complete">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_complete</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><span class="pre">bool</span></a></em><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L2831-L2841"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Event.is_complete" title="Link to this definition">#</a></dt>
<dd><p>A boolean indicating whether all work on the stream when the event was recorded has completed.</p>
<p>This property may not be accessed during a graph capture on any stream.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.record_event">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">record_event</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">event</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L5170-L5182"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.record_event" title="Link to this definition">#</a></dt>
<dd><p>Convenience function for calling <a class="reference internal" href="#warp.Stream.record_event" title="warp.Stream.record_event"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Stream.record_event()</span></code></a> on the current stream.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>event</strong> (<a class="reference internal" href="#warp.Event" title="warp.context.Event"><em>Event</em></a><em> | </em><em>None</em>) – <a class="reference internal" href="#warp.Event" title="warp.Event"><code class="xref py py-class docutils literal notranslate"><span class="pre">Event</span></code></a> instance to record. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, a new <a class="reference internal" href="#warp.Event" title="warp.Event"><code class="xref py py-class docutils literal notranslate"><span class="pre">Event</span></code></a>
instance will be created.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The recorded event.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.wait_event">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">wait_event</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">event</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L5184-L5192"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.wait_event" title="Link to this definition">#</a></dt>
<dd><p>Convenience function for calling <a class="reference internal" href="#warp.Stream.wait_event" title="warp.Stream.wait_event"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Stream.wait_event()</span></code></a> on the current stream.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>event</strong> (<a class="reference internal" href="#warp.Event" title="warp.context.Event"><em>Event</em></a>) – <a class="reference internal" href="#warp.Event" title="warp.Event"><code class="xref py py-class docutils literal notranslate"><span class="pre">Event</span></code></a> instance to wait for.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.synchronize_event">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">synchronize_event</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">event</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L6482-L6492"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.synchronize_event" title="Link to this definition">#</a></dt>
<dd><p>Synchronize the calling CPU thread with an event recorded on a CUDA stream.</p>
<p>This function allows the host application code to ensure that a specific synchronization point was reached.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>event</strong> (<a class="reference internal" href="#warp.Event" title="warp.context.Event"><em>Event</em></a>) – Event to wait for.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.get_event_elapsed_time">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">get_event_elapsed_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_event</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_event</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synchronize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L5194-L5217"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.get_event_elapsed_time" title="Link to this definition">#</a></dt>
<dd><p>Get the elapsed time between two recorded events.</p>
<p>Both events must have been previously recorded with
<a class="reference internal" href="#warp.record_event" title="warp.record_event"><code class="xref py py-func docutils literal notranslate"><span class="pre">record_event()</span></code></a> or <a class="reference internal" href="#warp.Stream.record_event" title="warp.Stream.record_event"><code class="xref py py-meth docutils literal notranslate"><span class="pre">warp.Stream.record_event()</span></code></a>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">synchronize</span></code> is False, the caller must ensure that device execution has reached <code class="docutils literal notranslate"><span class="pre">end_event</span></code>
prior to calling <code class="docutils literal notranslate"><span class="pre">get_event_elapsed_time()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start_event</strong> (<a class="reference internal" href="#warp.Event" title="warp.context.Event"><em>Event</em></a>) – The start event.</p></li>
<li><p><strong>end_event</strong> (<a class="reference internal" href="#warp.Event" title="warp.context.Event"><em>Event</em></a>) – The end event.</p></li>
<li><p><strong>synchronize</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – Whether Warp should synchronize on the <code class="docutils literal notranslate"><span class="pre">end_event</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The elapsed time in milliseconds with a resolution about 0.5 ms.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="graphs">
<span id="id7"></span><h2>Graphs<a class="headerlink" href="#graphs" title="Link to this heading">#</a></h2>
<p>Launching kernels from Python introduces significant additional overhead compared to C++ or native programs.
To address this, Warp exposes the concept of <a class="reference external" href="https://developer.nvidia.com/blog/cuda-graphs/">CUDA graphs</a>
to allow recording large batches of kernels and replaying them with very little CPU overhead.</p>
<p>To record a series of kernel launches use the <a class="reference internal" href="#warp.capture_begin" title="warp.capture_begin"><code class="xref py py-func docutils literal notranslate"><span class="pre">wp.capture_begin()</span></code></a> and
<a class="reference internal" href="#warp.capture_end" title="warp.capture_end"><code class="xref py py-func docutils literal notranslate"><span class="pre">wp.capture_end()</span></code></a> API as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># begin capture</span>
<span class="n">wp</span><span class="o">.</span><span class="n">capture_begin</span><span class="p">(</span><span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="c1"># record launches</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
        <span class="n">wp</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="n">compute1</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="c1"># end capture and return a graph object</span>
    <span class="n">graph</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">capture_end</span><span class="p">(</span><span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>We strongly recommend the use of the try-finally pattern when capturing graphs because the <cite>finally</cite>
statement will ensure <a class="reference internal" href="#warp.capture_end" title="warp.capture_end"><code class="xref py py-func docutils literal notranslate"><span class="pre">wp.capture_end</span></code></a> gets called, even if an exception occurs during
capture, which would otherwise trap the stream in a capturing state.</p>
<p>Once a graph has been constructed it can be executed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wp</span><span class="o">.</span><span class="n">capture_launch</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="#warp.ScopedCapture" title="warp.ScopedCapture"><code class="xref py py-class docutils literal notranslate"><span class="pre">wp.ScopedCapture</span></code></a> context manager can be used to simplify the code and
ensure that <a class="reference internal" href="#warp.capture_end" title="warp.capture_end"><code class="xref py py-func docutils literal notranslate"><span class="pre">wp.capture_end</span></code></a> is called regardless of exceptions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">wp</span><span class="o">.</span><span class="n">ScopedCapture</span><span class="p">(</span><span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">capture</span><span class="p">:</span>
    <span class="c1"># record launches</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
        <span class="n">wp</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="n">compute1</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>

<span class="n">wp</span><span class="o">.</span><span class="n">capture_launch</span><span class="p">(</span><span class="n">capture</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that only launch calls are recorded in the graph; any Python executed outside of the kernel code will not be recorded.
Typically it is only beneficial to use CUDA graphs when the graph will be reused or launched multiple times, as
there is a graph-creation overhead.</p>
<section id="conditional-execution">
<h3>Conditional Execution<a class="headerlink" href="#conditional-execution" title="Link to this heading">#</a></h3>
<p>CUDA 12.4+ supports conditional graph nodes that enable dynamic control flow in CUDA graphs.</p>
<p><a class="reference internal" href="#warp.capture_if" title="warp.capture_if"><code class="xref py py-func docutils literal notranslate"><span class="pre">wp.capture_if</span></code></a> creates a dynamic branch based on a condition. The condition value is read from a single-element <code class="docutils literal notranslate"><span class="pre">int</span></code> array, where a non-zero value means that the condition is True.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># create condition</span>
<span class="n">cond</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

<span class="k">with</span> <span class="n">wp</span><span class="o">.</span><span class="n">ScopedCapture</span><span class="p">()</span> <span class="k">as</span> <span class="n">capture</span><span class="p">:</span>
    <span class="n">wp</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span><span class="n">foo</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>

    <span class="c1"># execute a branch based on the condition value</span>
    <span class="n">wp</span><span class="o">.</span><span class="n">capture_if</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span>
                  <span class="n">on_true</span><span class="o">=...</span><span class="p">,</span>
                  <span class="n">on_false</span><span class="o">=...</span><span class="p">)</span>

    <span class="n">wp</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span><span class="n">bar</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>The condition value can be updated by kernels launched prior to <code class="docutils literal notranslate"><span class="pre">capture_if()</span></code> in the same graph (e.g. kernel <code class="docutils literal notranslate"><span class="pre">foo</span></code> above) or it can be updated by other means before the graph is launched. Note that during graph capture, the value of the condition is ignored. It is only used when the graph is launched, making dynamic control flow possible.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># this will execute the `on_true` branch</span>
<span class="n">cond</span><span class="o">.</span><span class="n">fill_</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">wp</span><span class="o">.</span><span class="n">capture_launch</span><span class="p">(</span><span class="n">capture</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>

<span class="c1"># this will execute the `on_false` branch</span>
<span class="n">cond</span><span class="o">.</span><span class="n">fill_</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">wp</span><span class="o">.</span><span class="n">capture_launch</span><span class="p">(</span><span class="n">capture</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">on_true</span></code> and <code class="docutils literal notranslate"><span class="pre">on_false</span></code> callbacks can be previously captured <code class="xref py py-class docutils literal notranslate"><span class="pre">Graph</span></code> objects or Python callback functions. These callbacks are captured as child graphs of the enclosing graph. It’s possible to specify only one or both callbacks, as needed. When the parent graph is launched, the correct child graph is executed based on the value of the condition. This is done efficiently on the device without involving the CPU.</p>
<p>Here is an example that uses previously captured graphs:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">hello_kernel</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hello&quot;</span><span class="p">)</span>

<span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">goodbye_kernel</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Goodbye&quot;</span><span class="p">)</span>

<span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">yes_kernel</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Yes!&quot;</span><span class="p">)</span>

<span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">no_kernel</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No!&quot;</span><span class="p">)</span>


<span class="c1"># create condition</span>
<span class="n">cond</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

<span class="c1"># capture the on_true branch</span>
<span class="k">with</span> <span class="n">wp</span><span class="o">.</span><span class="n">ScopedCapture</span><span class="p">()</span> <span class="k">as</span> <span class="n">yes_capture</span><span class="p">:</span>
    <span class="n">wp</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span><span class="n">yes_kernel</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># capture the on_false branch</span>
<span class="k">with</span> <span class="n">wp</span><span class="o">.</span><span class="n">ScopedCapture</span><span class="p">()</span> <span class="k">as</span> <span class="n">no_capture</span><span class="p">:</span>
    <span class="n">wp</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span><span class="n">no_kernel</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># capture the main graph</span>
<span class="k">with</span> <span class="n">wp</span><span class="o">.</span><span class="n">ScopedCapture</span><span class="p">()</span> <span class="k">as</span> <span class="n">capture</span><span class="p">:</span>
    <span class="n">wp</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span><span class="n">hello_kernel</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># specify branches using subgraphs</span>
    <span class="n">wp</span><span class="o">.</span><span class="n">capture_if</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span>
                  <span class="n">on_true</span><span class="o">=</span><span class="n">yes_capture</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span>
                  <span class="n">on_false</span><span class="o">=</span><span class="n">no_capture</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>

    <span class="n">wp</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span><span class="n">goodbye_kernel</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># execute on_true branch</span>
<span class="n">cond</span><span class="o">.</span><span class="n">fill_</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">wp</span><span class="o">.</span><span class="n">capture_launch</span><span class="p">(</span><span class="n">capture</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>

<span class="c1"># execute on_false branch</span>
<span class="n">cond</span><span class="o">.</span><span class="n">fill_</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">wp</span><span class="o">.</span><span class="n">capture_launch</span><span class="p">(</span><span class="n">capture</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>

<span class="n">wp</span><span class="o">.</span><span class="n">synchronize_device</span><span class="p">()</span>
</pre></div>
</div>
<p>Here is an example that uses Python callback functions. These callbacks will be captured as child graphs of the main graph:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">hello_kernel</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hello&quot;</span><span class="p">)</span>

<span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">goodbye_kernel</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Goodbye&quot;</span><span class="p">)</span>

<span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">yes_kernel</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Yes!&quot;</span><span class="p">)</span>

<span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">no_kernel</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No!&quot;</span><span class="p">)</span>


<span class="c1"># create condition</span>
<span class="n">cond</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

<span class="c1"># Python callback for the on_true branch</span>
<span class="k">def</span><span class="w"> </span><span class="nf">yes_callback</span><span class="p">():</span>
    <span class="n">wp</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span><span class="n">yes_kernel</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Python callback for the on_false branch</span>
<span class="k">def</span><span class="w"> </span><span class="nf">no_callback</span><span class="p">():</span>
    <span class="n">wp</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span><span class="n">no_kernel</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># capture the main graph</span>
<span class="k">with</span> <span class="n">wp</span><span class="o">.</span><span class="n">ScopedCapture</span><span class="p">()</span> <span class="k">as</span> <span class="n">capture</span><span class="p">:</span>
    <span class="n">wp</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span><span class="n">hello_kernel</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># specify branches using Python callback functions</span>
    <span class="n">wp</span><span class="o">.</span><span class="n">capture_if</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span>
                  <span class="n">on_true</span><span class="o">=</span><span class="n">yes_callback</span><span class="p">,</span>
                  <span class="n">on_false</span><span class="o">=</span><span class="n">no_callback</span><span class="p">)</span>

    <span class="n">wp</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span><span class="n">goodbye_kernel</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># execute on_true branch</span>
<span class="n">cond</span><span class="o">.</span><span class="n">fill_</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">wp</span><span class="o">.</span><span class="n">capture_launch</span><span class="p">(</span><span class="n">capture</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>

<span class="c1"># execute on_false branch</span>
<span class="n">cond</span><span class="o">.</span><span class="n">fill_</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">wp</span><span class="o">.</span><span class="n">capture_launch</span><span class="p">(</span><span class="n">capture</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>

<span class="n">wp</span><span class="o">.</span><span class="n">synchronize_device</span><span class="p">()</span>
</pre></div>
</div>
<p>When using Python callback functions, any extra keyword arguments to <a class="reference internal" href="#warp.capture_if" title="warp.capture_if"><code class="xref py py-func docutils literal notranslate"><span class="pre">wp.capture_if</span></code></a> are forwarded to the callbacks.</p>
<p><a class="reference internal" href="#warp.capture_while" title="warp.capture_while"><code class="xref py py-func docutils literal notranslate"><span class="pre">wp.capture_while</span></code></a> creates a dynamic loop based on a condition. Similarly to <a class="reference internal" href="#warp.capture_if" title="warp.capture_if"><code class="xref py py-func docutils literal notranslate"><span class="pre">wp.capture_if</span></code></a>, the condition value is read from a single-element <code class="docutils literal notranslate"><span class="pre">int</span></code> array, where a non-zero value means that the condition is True.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># create condition</span>
<span class="n">cond</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

<span class="k">with</span> <span class="n">wp</span><span class="o">.</span><span class="n">ScopedCapture</span><span class="p">()</span> <span class="k">as</span> <span class="n">capture</span><span class="p">:</span>
    <span class="n">wp</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span><span class="n">foo</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>

    <span class="c1"># execute the while_body while the condition is true</span>
    <span class="n">wp</span><span class="o">.</span><span class="n">capture_while</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="n">while_body</span><span class="o">=...</span><span class="p">)</span>

    <span class="n">wp</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span><span class="n">bar</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">while_body</span></code> callback will be executed as long as the condition is non-zero. The callback is responsible for updating the condition value so that the loop eventually terminates. The <code class="docutils literal notranslate"><span class="pre">while_body</span></code> argument can be a previously captured graph or a Python callback function. Here is an example that will run some number of iterations, using the condition value as a counter:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">hello_kernel</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hello&quot;</span><span class="p">)</span>

<span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">goodbye_kernel</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Goodbye&quot;</span><span class="p">)</span>

<span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">body_kernel</span><span class="p">(</span><span class="n">cond</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)):</span>
    <span class="n">tid</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">tid</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">cond</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="c1"># decrement the condition counter</span>
    <span class="k">if</span> <span class="n">tid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">cond</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>


<span class="c1"># create condition</span>
<span class="n">cond</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

<span class="c1"># capture the while_body</span>
<span class="k">with</span> <span class="n">wp</span><span class="o">.</span><span class="n">ScopedCapture</span><span class="p">()</span> <span class="k">as</span> <span class="n">body_capture</span><span class="p">:</span>
    <span class="n">wp</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span><span class="n">body_kernel</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">cond</span><span class="p">])</span>

<span class="c1"># capture the main graph</span>
<span class="k">with</span> <span class="n">wp</span><span class="o">.</span><span class="n">ScopedCapture</span><span class="p">()</span> <span class="k">as</span> <span class="n">capture</span><span class="p">:</span>
    <span class="n">wp</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span><span class="n">hello_kernel</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># dynamic loop</span>
    <span class="n">wp</span><span class="o">.</span><span class="n">capture_while</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="n">while_body</span><span class="o">=</span><span class="n">body_capture</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>

    <span class="n">wp</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span><span class="n">goodbye_kernel</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># loop 5 times</span>
<span class="n">cond</span><span class="o">.</span><span class="n">fill_</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">wp</span><span class="o">.</span><span class="n">capture_launch</span><span class="p">(</span><span class="n">capture</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>

<span class="c1"># loop 2 times</span>
<span class="n">cond</span><span class="o">.</span><span class="n">fill_</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">wp</span><span class="o">.</span><span class="n">capture_launch</span><span class="p">(</span><span class="n">capture</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>

<span class="n">wp</span><span class="o">.</span><span class="n">synchronize_device</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Conditional graph node support is only available if Warp is built using CUDA Toolkit 12.4+ and the NVIDIA driver supports CUDA 12.4+.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Due to a current CUDA limitation, graphs with conditional nodes cannot be used as child graphs. It means that it’s not possible to create nested conditional constructs using previously captured graphs. If nesting is required, using Python callback functions is the way to go.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#warp.capture_if" title="warp.capture_if"><code class="xref py py-func docutils literal notranslate"><span class="pre">wp.capture_if</span></code></a> and <a class="reference internal" href="#warp.capture_while" title="warp.capture_while"><code class="xref py py-func docutils literal notranslate"><span class="pre">wp.capture_while</span></code></a> will work even without graph capture on any device. If there is no active capture, the condition will be evaluated on the CPU and the correct branch will be executed immediately. This makes it possible to write code that works similarly with and without graph capture.</p>
</div>
</section>
<section id="graph-api-reference">
<h3>Graph API Reference<a class="headerlink" href="#graph-api-reference" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="warp.capture_begin">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">capture_begin</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">force_module_load</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">external</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L6845-L6911"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.capture_begin" title="Link to this definition">#</a></dt>
<dd><p>Begin capture of a CUDA graph</p>
<p>Captures all subsequent kernel launches and memory operations on CUDA devices.
This can be used to record large numbers of kernels and replay them with low overhead.</p>
<p>If <cite>device</cite> is specified, the capture will begin on the CUDA stream currently
associated with the device.  If <cite>stream</cite> is specified, the capture will begin
on the given stream.  If both are omitted, the capture will begin on the current
stream of the current device.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> (<a class="reference internal" href="devices.html#warp.context.Device" title="warp.context.Device"><em>Device</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – The CUDA device to capture on</p></li>
<li><p><strong>stream</strong> (<a class="reference internal" href="#warp.Stream" title="warp.context.Stream"><em>Stream</em></a><em> | </em><em>None</em>) – The CUDA stream to capture on</p></li>
<li><p><strong>force_module_load</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a><em> | </em><em>None</em>) – Whether to force loading of all kernels before capture.
In general it is better to use <code class="xref py py-func docutils literal notranslate"><span class="pre">load_module()</span></code> to selectively load kernels.
When running with CUDA drivers that support CUDA 12.3 or newer, this option is not recommended to be set to
<code class="docutils literal notranslate"><span class="pre">True</span></code> because kernels can be loaded during graph capture on more recent drivers. If this argument is
<code class="docutils literal notranslate"><span class="pre">None</span></code>, then the behavior inherits from <code class="docutils literal notranslate"><span class="pre">wp.config.enable_graph_capture_module_load_by_default</span></code> if the
driver is older than CUDA 12.3.</p></li>
<li><p><strong>external</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – Whether the capture was already started externally</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.capture_end">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">capture_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L6913-L6953"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.capture_end" title="Link to this definition">#</a></dt>
<dd><p>End the capture of a CUDA graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> (<a class="reference internal" href="devices.html#warp.context.Device" title="warp.context.Device"><em>Device</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – The CUDA device where capture began</p></li>
<li><p><strong>stream</strong> (<a class="reference internal" href="#warp.Stream" title="warp.context.Stream"><em>Stream</em></a><em> | </em><em>None</em>) – The CUDA stream where capture began</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">Graph</span></code> object that can be launched with <a class="reference internal" href="#warp.capture_launch" title="warp.capture_launch"><code class="xref py py-func docutils literal notranslate"><span class="pre">capture_launch()</span></code></a></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Graph</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.capture_launch">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">capture_launch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L7298-L7325"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.capture_launch" title="Link to this definition">#</a></dt>
<dd><p>Launch a previously captured CUDA graph</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graph</strong> (<em>Graph</em>) – A <code class="xref py py-class docutils literal notranslate"><span class="pre">Graph</span></code> as returned by <a class="reference internal" href="#warp.capture_end" title="warp.capture_end"><code class="xref py py-func docutils literal notranslate"><span class="pre">capture_end()</span></code></a></p></li>
<li><p><strong>stream</strong> (<a class="reference internal" href="#warp.Stream" title="warp.context.Stream"><em>Stream</em></a><em> | </em><em>None</em>) – A <a class="reference internal" href="#warp.Stream" title="warp.Stream"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code></a> to launch the graph on</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.capture_if">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">capture_if</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">condition</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">on_true</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">on_false</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L7026-L7172"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.capture_if" title="Link to this definition">#</a></dt>
<dd><p>Create a dynamic branch based on a condition.</p>
<p>The condition value is retrieved from the first element of the <code class="docutils literal notranslate"><span class="pre">condition</span></code> array.</p>
<p>This function is particularly useful with CUDA graphs, but can be used without graph capture as well.
CUDA 12.4+ is required to take advantage of conditional graph nodes for dynamic control flow.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>condition</strong> (<a class="reference internal" href="#warp.array" title="warp.array"><em>array</em></a><em>(</em><em>ndim=1</em><em>, </em><em>dtype=int32</em><em>)</em>) – Warp array holding the condition value.</p></li>
<li><p><strong>on_true</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><em>Callable</em></a><em> | </em><em>Graph</em><em> | </em><em>None</em>) – A callback function or <code class="xref py py-class docutils literal notranslate"><span class="pre">Graph</span></code> to execute if the condition is True.</p></li>
<li><p><strong>on_false</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><em>Callable</em></a><em> | </em><em>Graph</em><em> | </em><em>None</em>) – A callback function or <code class="xref py py-class docutils literal notranslate"><span class="pre">Graph</span></code> to execute if the condition is False.</p></li>
<li><p><strong>stream</strong> (<a class="reference internal" href="#warp.Stream" title="warp.context.Stream"><em>Stream</em></a>) – The CUDA stream where the condition was written. If None, use the current stream on the device where <code class="docutils literal notranslate"><span class="pre">condition</span></code> resides.</p></li>
</ul>
</dd>
</dl>
<p>Any additional keyword arguments are forwarded to the callback functions.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.capture_while">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">capture_while</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">condition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">while_body</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L7174-L7296"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.capture_while" title="Link to this definition">#</a></dt>
<dd><p>Create a dynamic loop based on a condition.</p>
<p>The condition value is retrieved from the first element of the <code class="docutils literal notranslate"><span class="pre">condition</span></code> array.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">while_body</span></code> callback is responsible for updating the condition value so the loop can terminate.</p>
<p>This function is particularly useful with CUDA graphs, but can be used without graph capture as well.
CUDA 12.4+ is required to take advantage of conditional graph nodes for dynamic control flow.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>condition</strong> (<a class="reference internal" href="#warp.array" title="warp.array"><em>array</em></a><em>(</em><em>ndim=1</em><em>, </em><em>dtype=int32</em><em>)</em>) – Warp array holding the condition value.</p></li>
<li><p><strong>while_body</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><em>Callable</em></a><em> | </em><em>Graph</em>) – A callback function or <code class="xref py py-class docutils literal notranslate"><span class="pre">Graph</span></code> to execute while the loop condition is True.</p></li>
<li><p><strong>stream</strong> (<a class="reference internal" href="#warp.Stream" title="warp.context.Stream"><em>Stream</em></a><em> | </em><em>None</em>) – The CUDA stream where the condition was written. If None, use the current stream on the device where <code class="docutils literal notranslate"><span class="pre">condition</span></code> resides.</p></li>
</ul>
</dd>
</dl>
<p>Any additional keyword arguments are forwarded to the callback function.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.capture_debug_dot_print">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">capture_debug_dot_print</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L6955-L6965"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.capture_debug_dot_print" title="Link to this definition">#</a></dt>
<dd><p>Export a CUDA graph to a DOT file for visualization</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graph</strong> (<em>Graph</em>) – A <code class="xref py py-class docutils literal notranslate"><span class="pre">Graph</span></code> as returned by <a class="reference internal" href="#warp.capture_end" title="warp.capture_end"><code class="xref py py-func docutils literal notranslate"><span class="pre">capture_end()</span></code></a></p></li>
<li><p><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to save the DOT file</p></li>
<li><p><strong>verbose</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – Whether to include additional debug information in the output</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.ScopedCapture">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">ScopedCapture</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">force_module_load</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">external</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/utils.py#L1471-L1501"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.ScopedCapture" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device</strong> (<em>Devicelike</em>)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="warp.ScopedCapture.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">force_module_load</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">external</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/utils.py#L1472-L1479"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.ScopedCapture.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device</strong> (<a class="reference internal" href="devices.html#warp.context.Device" title="warp.context.Device"><em>Device</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="spatial-computing-primitives">
<h2>Spatial Computing Primitives<a class="headerlink" href="#spatial-computing-primitives" title="Link to this heading">#</a></h2>
<p>Spatial computing primitives provide efficient data structures for spatial queries and geometric operations.
These include hash grids for particle neighbor searches, bounding volume hierarchies (BVHs) for ray tracing and
collision detection, and mesh types.
These ready-to-use implementations save significant development time compared to building spatial data structures from
scratch, while providing high-performance on the GPU.</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p><strong>Object Lifetime Management</strong>: Spatial computing primitives
(e.g. <a class="reference internal" href="#warp.HashGrid" title="warp.HashGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">wp.HashGrid</span></code></a>, <a class="reference internal" href="#warp.Bvh" title="warp.Bvh"><code class="xref py py-class docutils literal notranslate"><span class="pre">wp.Bvh</span></code></a>, etc.) must remain in scope.
These acceleration data structures are identified by their <code class="docutils literal notranslate"><span class="pre">id</span></code> attribute when passed to kernels,
but if the Python object is garbage collected, the memory allocated for the primitive may be
freed, causing crashes and undefined behavior.</p>
<p>See the <a class="reference internal" href="#object-lifetime-pitfall"><span class="std std-ref">Object Lifetime Pitfall</span></a> section below for more information.</p>
</div>
<section id="meshes">
<h3>Meshes<a class="headerlink" href="#meshes" title="Link to this heading">#</a></h3>
<p>Warp provides a <a class="reference internal" href="#warp.Mesh" title="warp.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">wp.Mesh</span></code></a> class to manage triangle mesh data. To create a mesh, users provide a points, indices and optionally a velocity array:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mesh</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">velocities</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Mesh objects maintain references to their input geometry buffers. All buffers should live on the same device.</p>
</div>
<p>Meshes can be passed to kernels using their <code class="docutils literal notranslate"><span class="pre">id</span></code> attribute, which is <code class="docutils literal notranslate"><span class="pre">uint64</span></code> value that uniquely identifies the mesh.
Once inside a kernel, you can perform geometric queries against the mesh such as ray-casts or closest-point lookups:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">raycast</span><span class="p">(</span><span class="n">mesh</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">uint64</span><span class="p">,</span>
            <span class="n">ray_origin</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">),</span>
            <span class="n">ray_dir</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">),</span>
            <span class="n">ray_hit</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">)):</span>

    <span class="n">tid</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">tid</span><span class="p">()</span>

    <span class="n">t</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>      <span class="c1"># hit distance along ray</span>
    <span class="n">u</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>      <span class="c1"># hit face barycentric u</span>
    <span class="n">v</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>      <span class="c1"># hit face barycentric v</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>   <span class="c1"># hit face sign</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">()</span>       <span class="c1"># hit face normal</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>          <span class="c1"># hit face index</span>

    <span class="n">color</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">()</span>

    <span class="c1"># ray cast against the mesh</span>
    <span class="k">if</span> <span class="n">wp</span><span class="o">.</span><span class="n">mesh_query_ray</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">ray_origin</span><span class="p">[</span><span class="n">tid</span><span class="p">],</span> <span class="n">ray_dir</span><span class="p">[</span><span class="n">tid</span><span class="p">],</span> <span class="mf">1.e+6</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">sign</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>

        <span class="c1"># if we got a hit then set color to the face normal</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">n</span><span class="o">*</span><span class="mf">0.5</span> <span class="o">+</span> <span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>

    <span class="n">ray_hit</span><span class="p">[</span><span class="n">tid</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span>
</pre></div>
</div>
<p>Users may update mesh vertex positions at runtime simply by modifying the points buffer.
After modifying point locations users should call <a class="reference internal" href="#warp.Mesh.refit" title="warp.Mesh.refit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Mesh.refit()</span></code></a> to rebuild the bounding volume hierarchy (BVH)
structure and ensure that queries work correctly.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Updating Mesh topology (indices) at runtime is not currently supported. Users should instead recreate a new Mesh object.</p>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="warp.Mesh">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">Mesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L4147-L4330"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Mesh" title="Link to this definition">#</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="warp.Mesh.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">points</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">velocities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">support_winding_number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">bvh_constructor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L4161-L4245"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Mesh.__init__" title="Link to this definition">#</a></dt>
<dd><p>Class representing a triangle mesh.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="warp.Mesh.id">
<span class="sig-name descname"><span class="pre">id</span></span><a class="headerlink" href="#warp.Mesh.id" title="Link to this definition">#</a></dt>
<dd><p>Unique identifier for this mesh object, can be passed to kernels.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.Mesh.device">
<span class="sig-name descname"><span class="pre">device</span></span><a class="headerlink" href="#warp.Mesh.device" title="Link to this definition">#</a></dt>
<dd><p>Device this object lives on, all buffers must live on the same device.</p>
</dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>points</strong> (<a class="reference internal" href="#warp.array" title="warp.types.array"><em>array</em></a>) – Array of vertex positions of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">warp.vec3</span></code>.</p></li>
<li><p><strong>indices</strong> (<a class="reference internal" href="#warp.array" title="warp.types.array"><em>array</em></a>) – Array of triangle indices of data type <a class="reference internal" href="functions.html#warp.int32" title="warp.int32"><code class="xref py py-class docutils literal notranslate"><span class="pre">warp.int32</span></code></a>.
Should be a 1D array with shape <code class="docutils literal notranslate"><span class="pre">(num_tris</span> <span class="pre">*</span> <span class="pre">3)</span></code>.</p></li>
<li><p><strong>velocities</strong> (<a class="reference internal" href="#warp.array" title="warp.types.array"><em>array</em></a><em> | </em><em>None</em>) – Optional array of vertex velocities of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">warp.vec3</span></code>.</p></li>
<li><p><strong>support_winding_number</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the mesh will build additional
data structures to support <code class="docutils literal notranslate"><span class="pre">wp.mesh_query_point_sign_winding_number()</span></code> queries.</p></li>
<li><p><strong>bvh_constructor</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – The construction algorithm for the underlying BVH
(see the docstring of <a class="reference internal" href="#warp.Bvh" title="warp.Bvh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bvh</span></code></a> for explanation).
Valid choices are <code class="docutils literal notranslate"><span class="pre">&quot;sah&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;median&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;lbvh&quot;</span></code>, or <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.Mesh.refit">
<span class="sig-name descname"><span class="pre">refit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L4257-L4268"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Mesh.refit" title="Link to this definition">#</a></dt>
<dd><p>Refit the BVH to points.</p>
<p>This should be called after users modify the <code class="docutils literal notranslate"><span class="pre">points</span></code> data.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="warp.Mesh.points">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">points</span></span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L4269-L4279"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Mesh.points" title="Link to this definition">#</a></dt>
<dd><p>The array of mesh’s vertex positions of type <code class="xref py py-class docutils literal notranslate"><span class="pre">warp.vec3</span></code>.</p>
<p>The <cite>Mesh.points</cite> property has a custom setter method. Users can modify the vertex positions in-place,
but <a class="reference internal" href="#warp.Mesh.refit" title="warp.Mesh.refit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">refit()</span></code></a> must be called manually after such modifications. Alternatively, assigning a new array
to this property is also supported. The new array must have the same shape as the original, and once assigned,
The <a class="reference internal" href="#warp.Mesh" title="warp.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a> will automatically perform a refit operation based on the new vertex positions.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="warp.Mesh.velocities">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">velocities</span></span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L4301-L4309"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Mesh.velocities" title="Link to this definition">#</a></dt>
<dd><p>The array of mesh’s velocities of type <code class="xref py py-class docutils literal notranslate"><span class="pre">warp.vec3</span></code>.</p>
<p>This is a property with a custom setter method. Users can modify the velocities in-place,
or assign a new array to this property. No refitting is needed for changing velocities.</p>
</dd></dl>

</dd></dl>

</section>
<section id="hash-grids">
<h3>Hash Grids<a class="headerlink" href="#hash-grids" title="Link to this heading">#</a></h3>
<p>Many particle-based simulation methods such as the Discrete Element Method (DEM), or Smoothed Particle Hydrodynamics (SPH), involve iterating over spatial neighbors to compute force interactions. Hash grids are a well-established data structure to accelerate these nearest neighbor queries, and particularly well-suited to the GPU.</p>
<p>To support spatial neighbor queries Warp provides a <code class="docutils literal notranslate"><span class="pre">HashGrid</span></code> object that may be created as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">HashGrid</span><span class="p">(</span><span class="n">dim_x</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">dim_y</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">dim_z</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>

<span class="n">grid</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">points</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">p</span></code> is an array of <code class="docutils literal notranslate"><span class="pre">wp.vec3</span></code> point positions, and <code class="docutils literal notranslate"><span class="pre">r</span></code> is the radius to use when building the grid.
Neighbors can then be iterated over inside the kernel code using <a class="reference internal" href="functions.html#warp.hash_grid_query" title="warp.hash_grid_query"><code class="xref py py-func docutils literal notranslate"><span class="pre">wp.hash_grid_query()</span></code></a>
and <a class="reference internal" href="functions.html#warp.hash_grid_query_next" title="warp.hash_grid_query_next"><code class="xref py py-func docutils literal notranslate"><span class="pre">wp.hash_grid_query_next()</span></code></a> as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">grid</span> <span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">uint64</span><span class="p">,</span>
        <span class="n">points</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">),</span>
        <span class="n">output</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">),</span>
        <span class="n">radius</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>

    <span class="n">tid</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">tid</span><span class="p">()</span>

    <span class="c1"># query point</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">tid</span><span class="p">]</span>

    <span class="c1"># create grid query around point</span>
    <span class="n">query</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">hash_grid_query</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">radius</span><span class="p">)</span>
    <span class="n">index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="nb">sum</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">()</span>

    <span class="k">while</span><span class="p">(</span><span class="n">wp</span><span class="o">.</span><span class="n">hash_grid_query_next</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">index</span><span class="p">)):</span>

        <span class="n">neighbor</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

        <span class="c1"># compute distance to neighbor point</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">length</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="n">neighbor</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">dist</span> <span class="o">&lt;=</span> <span class="n">radius</span><span class="p">):</span>
            <span class="nb">sum</span> <span class="o">+=</span> <span class="n">neighbor</span>

    <span class="n">output</span><span class="p">[</span><span class="n">tid</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">HashGrid</span></code> query will give back all points in <em>cells</em> that fall inside the query radius.
When there are hash conflicts it means that some points outside of query radius will be returned, and users should
check the distance themselves inside their kernels. The reason the query doesn’t do the check itself for each
returned point is because it’s common for kernels to compute the distance themselves, so it would redundant to
check/compute the distance twice.</p>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="warp.HashGrid">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">HashGrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L5447-L5520"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.HashGrid" title="Link to this definition">#</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="warp.HashGrid.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L5453-L5477"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.HashGrid.__init__" title="Link to this definition">#</a></dt>
<dd><p>Class representing a hash grid object for accelerated point queries.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="warp.HashGrid.id">
<span class="sig-name descname"><span class="pre">id</span></span><a class="headerlink" href="#warp.HashGrid.id" title="Link to this definition">#</a></dt>
<dd><p>Unique identifier for this mesh object, can be passed to kernels.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.HashGrid.device">
<span class="sig-name descname"><span class="pre">device</span></span><a class="headerlink" href="#warp.HashGrid.device" title="Link to this definition">#</a></dt>
<dd><p>Device this object lives on, all buffers must live on the same device.</p>
</dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_x</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of cells in x-axis</p></li>
<li><p><strong>dim_y</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of cells in y-axis</p></li>
<li><p><strong>dim_z</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of cells in z-axis</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.HashGrid.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L5478-L5502"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.HashGrid.build" title="Link to this definition">#</a></dt>
<dd><p>Updates the hash grid data structure.</p>
<p>This method rebuilds the underlying datastructure and should be called any time the set
of points changes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>points</strong> (<a class="reference internal" href="#warp.array" title="warp.array"><code class="xref py py-class docutils literal notranslate"><span class="pre">warp.array</span></code></a>) – Array of points of type <code class="xref py py-class docutils literal notranslate"><span class="pre">warp.vec3</span></code></p></li>
<li><p><strong>radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The cell size to use for bucketing points, cells are cubes with edges of this width.
For best performance the radius used to construct the grid should match closely to
the radius used when performing queries.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.HashGrid.reserve">
<span class="sig-name descname"><span class="pre">reserve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_points</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L5503-L5509"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.HashGrid.reserve" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="volumes">
<h3>Volumes<a class="headerlink" href="#volumes" title="Link to this heading">#</a></h3>
<p>Sparse volumes are incredibly useful for representing grid data over large domains, such as signed distance fields
(SDFs) for complex objects, or velocities for large-scale fluid flow. Warp supports reading sparse volumetric grids
stored using the <a class="reference external" href="https://developer.nvidia.com/nanovdb">NanoVDB</a> standard. Users can access voxels directly
or use built-in closest-point or trilinear interpolation to sample grid data from world or local space.</p>
<p>Volume objects can be created directly from Warp arrays containing a NanoVDB grid, from the contents of a
standard <code class="docutils literal notranslate"><span class="pre">.nvdb</span></code> file using <a class="reference internal" href="#warp.Volume.load_from_nvdb" title="warp.Volume.load_from_nvdb"><code class="xref py py-func docutils literal notranslate"><span class="pre">load_from_nvdb()</span></code></a>,
from an uncompressed in-memory buffer using <a class="reference internal" href="#warp.Volume.load_from_address" title="warp.Volume.load_from_address"><code class="xref py py-func docutils literal notranslate"><span class="pre">load_from_address()</span></code></a>,
or from a dense 3D NumPy array using <a class="reference internal" href="#warp.Volume.load_from_numpy" title="warp.Volume.load_from_numpy"><code class="xref py py-func docutils literal notranslate"><span class="pre">load_from_numpy()</span></code></a>.</p>
<p>Volumes can also be created using <a class="reference internal" href="#warp.Volume.allocate" title="warp.Volume.allocate"><code class="xref py py-func docutils literal notranslate"><span class="pre">allocate()</span></code></a>,
<a class="reference internal" href="#warp.Volume.allocate_by_tiles" title="warp.Volume.allocate_by_tiles"><code class="xref py py-func docutils literal notranslate"><span class="pre">allocate_by_tiles()</span></code></a> or <a class="reference internal" href="#warp.Volume.allocate_by_voxels" title="warp.Volume.allocate_by_voxels"><code class="xref py py-func docutils literal notranslate"><span class="pre">allocate_by_voxels()</span></code></a>.
The values for a Volume object can be modified in a Warp kernel using <a class="reference internal" href="functions.html#warp.volume_store" title="warp.volume_store"><code class="xref py py-func docutils literal notranslate"><span class="pre">wp.volume_store()</span></code></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Warp does not currently support modifying the topology of sparse volumes at runtime.</p>
</div>
<p>Below we give an example of creating a Volume object from an existing NanoVDB file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># open NanoVDB file on disk</span>
<span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;mygrid.nvdb&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>

<span class="c1"># create Volume object</span>
<span class="n">volume</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">Volume</span><span class="o">.</span><span class="n">load_from_nvdb</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Files written by the NanoVDB library, commonly marked by the <code class="docutils literal notranslate"><span class="pre">.nvdb</span></code> extension, can contain multiple grids with
various compression methods, but a <a class="reference internal" href="#warp.Volume" title="warp.Volume"><code class="xref py py-class docutils literal notranslate"><span class="pre">Volume</span></code></a> object represents a single NanoVDB grid.
The first grid is loaded by default, then  Warp volumes corresponding to the other grids in the file can be created
using repeated calls to <a class="reference internal" href="#warp.Volume.load_next_grid" title="warp.Volume.load_next_grid"><code class="xref py py-func docutils literal notranslate"><span class="pre">load_next_grid()</span></code></a>.
NanoVDB’s uncompressed and zip-compressed file formats are supported out-of-the-box, blosc compressed files require
the <cite>blosc</cite> Python package to be installed.</p>
</div>
<p>To sample the volume inside a kernel we pass a reference to it by ID, and use the built-in sampling modes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">sample_grid</span><span class="p">(</span><span class="n">volume</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">uint64</span><span class="p">,</span>
                <span class="n">points</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">),</span>
                <span class="n">samples</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)):</span>

    <span class="n">tid</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">tid</span><span class="p">()</span>

    <span class="c1"># load sample point in world-space</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">tid</span><span class="p">]</span>

    <span class="c1"># transform position to the volume&#39;s local-space</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">volume_world_to_index</span><span class="p">(</span><span class="n">volume</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

    <span class="c1"># sample volume with trilinear interpolation</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">volume_sample</span><span class="p">(</span><span class="n">volume</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">wp</span><span class="o">.</span><span class="n">Volume</span><span class="o">.</span><span class="n">LINEAR</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

    <span class="c1"># write result</span>
    <span class="n">samples</span><span class="p">[</span><span class="n">tid</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span>
</pre></div>
</div>
<p>Warp also supports NanoVDB index grids, which provide a memory-efficient linearization of voxel indices that can refer
to values in arbitrarily shaped arrays:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">sample_index_grid</span><span class="p">(</span><span class="n">volume</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">uint64</span><span class="p">,</span>
                     <span class="n">points</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">),</span>
                     <span class="n">voxel_values</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">Any</span><span class="p">)):</span>

    <span class="n">tid</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">tid</span><span class="p">()</span>

    <span class="c1"># load sample point in world-space</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">tid</span><span class="p">]</span>

    <span class="c1"># transform position to the volume&#39;s local-space</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">volume_world_to_index</span><span class="p">(</span><span class="n">volume</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

    <span class="c1"># sample volume with trilinear interpolation</span>
    <span class="n">background_value</span> <span class="o">=</span> <span class="n">voxel_values</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">volume_sample_index</span><span class="p">(</span><span class="n">volume</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">wp</span><span class="o">.</span><span class="n">Volume</span><span class="o">.</span><span class="n">LINEAR</span><span class="p">,</span> <span class="n">voxel_values</span><span class="p">,</span> <span class="n">background_value</span><span class="p">)</span>
</pre></div>
</div>
<p>The coordinates of all indexable voxels can be recovered using <a class="reference internal" href="#warp.Volume.get_voxels" title="warp.Volume.get_voxels"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_voxels()</span></code></a>.
NanoVDB grids may also contain embedded <em>blind</em> data arrays; those can be accessed with the
<a class="reference internal" href="#warp.Volume.feature_array" title="warp.Volume.feature_array"><code class="xref py py-func docutils literal notranslate"><span class="pre">feature_array()</span></code></a> function.</p>
<dl class="py class">
<dt class="sig sig-object py" id="warp.Volume">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">Volume</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L4332-L5244"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Volume" title="Link to this definition">#</a></dt>
<dd><dl class="py attribute">
<dt class="sig sig-object py" id="warp.Volume.CLOSEST">
<span class="sig-name descname"><span class="pre">CLOSEST</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#warp.Volume.CLOSEST" title="Link to this definition">#</a></dt>
<dd><p>Enum value to specify nearest-neighbor interpolation during sampling</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.Volume.LINEAR">
<span class="sig-name descname"><span class="pre">LINEAR</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#warp.Volume.LINEAR" title="Link to this definition">#</a></dt>
<dd><p>Enum value to specify trilinear interpolation during sampling</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.Volume.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L4343-L4370"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Volume.__init__" title="Link to this definition">#</a></dt>
<dd><p>Class representing a sparse grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<a class="reference internal" href="#warp.array" title="warp.types.array"><em>array</em></a>) – Array of bytes representing the volume in NanoVDB format.</p></li>
<li><p><strong>copy</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – Whether the incoming data will be copied or aliased.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.Volume.array">
<span class="sig-name descname"><span class="pre">array</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L4382-L4389"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Volume.array" title="Link to this definition">#</a></dt>
<dd><p>Return the raw memory buffer of the <a class="reference internal" href="#warp.Volume" title="warp.Volume"><code class="xref py py-class docutils literal notranslate"><span class="pre">Volume</span></code></a> as an array.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#warp.array" title="warp.types.array"><em>array</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.Volume.get_tile_count">
<span class="sig-name descname"><span class="pre">get_tile_count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L4390-L4401"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Volume.get_tile_count" title="Link to this definition">#</a></dt>
<dd><p>Return the number of tiles (NanoVDB leaf nodes) of the volume.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.Volume.get_tiles">
<span class="sig-name descname"><span class="pre">get_tiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L4402-L4431"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Volume.get_tiles" title="Link to this definition">#</a></dt>
<dd><p>Return the integer coordinates of all allocated tiles for this volume.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>out</strong> (<a class="reference internal" href="#warp.array" title="warp.types.array"><em>array</em></a><em> | </em><em>None</em>) – If provided, use the <cite>out</cite> array to store the tile coordinates, otherwise
a new array will be allocated. <code class="docutils literal notranslate"><span class="pre">out</span></code> must be a contiguous array
of <code class="docutils literal notranslate"><span class="pre">tile_count</span></code> <code class="docutils literal notranslate"><span class="pre">vec3i</span></code> or <code class="docutils literal notranslate"><span class="pre">tile_count</span> <span class="pre">x</span> <span class="pre">3</span></code> <code class="docutils literal notranslate"><span class="pre">int32</span></code>
on the same device as this volume.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#warp.array" title="warp.types.array"><em>array</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.Volume.get_voxel_count">
<span class="sig-name descname"><span class="pre">get_voxel_count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L4432-L4443"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Volume.get_voxel_count" title="Link to this definition">#</a></dt>
<dd><p>Return the total number of allocated voxels for this volume</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.Volume.get_voxels">
<span class="sig-name descname"><span class="pre">get_voxels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L4444-L4472"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Volume.get_voxels" title="Link to this definition">#</a></dt>
<dd><p>Return the integer coordinates of all allocated voxels for this volume.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>out</strong> (<a class="reference internal" href="#warp.array" title="warp.types.array"><em>array</em></a><em> | </em><em>None</em>) – If provided, use the <cite>out</cite> array to store the voxel coordinates, otherwise
a new array will be allocated. <cite>out</cite> must be a contiguous array of <code class="docutils literal notranslate"><span class="pre">voxel_count</span></code> <code class="docutils literal notranslate"><span class="pre">vec3i</span></code> or <code class="docutils literal notranslate"><span class="pre">voxel_count</span> <span class="pre">x</span> <span class="pre">3</span></code> <code class="docutils literal notranslate"><span class="pre">int32</span></code>
on the same device as this volume.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#warp.array" title="warp.types.array"><em>array</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.Volume.get_voxel_size">
<span class="sig-name descname"><span class="pre">get_voxel_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L4473-L4482"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Volume.get_voxel_size" title="Link to this definition">#</a></dt>
<dd><p>Return the voxel size, i.e, world coordinates of voxel’s diagonal vector</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.Volume.GridInfo">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GridInfo</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">size_in_bytes</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">grid_index</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">grid_count</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">type_str</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">translation</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">transform_matrix</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L4483-L4502"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Volume.GridInfo" title="Link to this definition">#</a></dt>
<dd><p>Grid metadata</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>size_in_bytes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>grid_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>grid_count</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>type_str</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>translation</strong> (<em>vec3f</em>)</p></li>
<li><p><strong>transform_matrix</strong> (<em>mat33f</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="warp.Volume.GridInfo.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></em><a class="headerlink" href="#warp.Volume.GridInfo.name" title="Link to this definition">#</a></dt>
<dd><p>Grid name</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.Volume.GridInfo.size_in_bytes">
<span class="sig-name descname"><span class="pre">size_in_bytes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#warp.Volume.GridInfo.size_in_bytes" title="Link to this definition">#</a></dt>
<dd><p>Size of this grid’s data, in bytes</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.Volume.GridInfo.grid_index">
<span class="sig-name descname"><span class="pre">grid_index</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#warp.Volume.GridInfo.grid_index" title="Link to this definition">#</a></dt>
<dd><p>Index of this grid in the data buffer</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.Volume.GridInfo.grid_count">
<span class="sig-name descname"><span class="pre">grid_count</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#warp.Volume.GridInfo.grid_count" title="Link to this definition">#</a></dt>
<dd><p>Total number of grids in the data buffer</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.Volume.GridInfo.type_str">
<span class="sig-name descname"><span class="pre">type_str</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></em><a class="headerlink" href="#warp.Volume.GridInfo.type_str" title="Link to this definition">#</a></dt>
<dd><p>String describing the type of the grid values</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.Volume.GridInfo.translation">
<span class="sig-name descname"><span class="pre">translation</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">vec3f</span></em><a class="headerlink" href="#warp.Volume.GridInfo.translation" title="Link to this definition">#</a></dt>
<dd><p>Index-to-world translation</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.Volume.GridInfo.transform_matrix">
<span class="sig-name descname"><span class="pre">transform_matrix</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">mat33f</span></em><a class="headerlink" href="#warp.Volume.GridInfo.transform_matrix" title="Link to this definition">#</a></dt>
<dd><p>Linear part of the index-to-world transform</p>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.Volume.get_grid_info">
<span class="sig-name descname"><span class="pre">get_grid_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L4503-L4535"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Volume.get_grid_info" title="Link to this definition">#</a></dt>
<dd><p>Returns the metadata associated with this Volume</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#warp.Volume.GridInfo" title="warp.types.Volume.GridInfo"><em>GridInfo</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="warp.Volume.dtype">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dtype</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.13)"><span class="pre">type</span></a></em><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L4554-L4562"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Volume.dtype" title="Link to this definition">#</a></dt>
<dd><p>Type of the Volume’s values as a Warp type.</p>
<p>If the grid does not contain values (e.g. index grids) or if the NanoVDB type is not
representable as a Warp type, returns <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="warp.Volume.is_index">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_index</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L4565-L4572"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Volume.is_index" title="Link to this definition">#</a></dt>
<dd><p>Whether this Volume contains an index grid, that is, a type of grid that does
not explicitly store values but associates each voxel to linearized index.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.Volume.get_feature_array_count">
<span class="sig-name descname"><span class="pre">get_feature_array_count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L4573-L4577"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Volume.get_feature_array_count" title="Link to this definition">#</a></dt>
<dd><p>Return the number of supplemental data arrays stored alongside the grid</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="warp.Volume.FeatureArrayInfo">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">FeatureArrayInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ptr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_count</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type_str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L4578-L4592"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Volume.FeatureArrayInfo" title="Link to this definition">#</a></dt>
<dd><p>Metadata for a supplemental data array</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>ptr</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>value_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>value_count</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>type_str</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="warp.Volume.FeatureArrayInfo.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></em><a class="headerlink" href="#warp.Volume.FeatureArrayInfo.name" title="Link to this definition">#</a></dt>
<dd><p>Name of the data array</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.Volume.FeatureArrayInfo.ptr">
<span class="sig-name descname"><span class="pre">ptr</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#warp.Volume.FeatureArrayInfo.ptr" title="Link to this definition">#</a></dt>
<dd><p>Memory address of the start of the array</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.Volume.FeatureArrayInfo.value_size">
<span class="sig-name descname"><span class="pre">value_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#warp.Volume.FeatureArrayInfo.value_size" title="Link to this definition">#</a></dt>
<dd><p>Size in bytes of the array values</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.Volume.FeatureArrayInfo.value_count">
<span class="sig-name descname"><span class="pre">value_count</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#warp.Volume.FeatureArrayInfo.value_count" title="Link to this definition">#</a></dt>
<dd><p>Number of values in the array</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.Volume.FeatureArrayInfo.type_str">
<span class="sig-name descname"><span class="pre">type_str</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></em><a class="headerlink" href="#warp.Volume.FeatureArrayInfo.type_str" title="Link to this definition">#</a></dt>
<dd><p>String describing the type of the array values</p>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.Volume.get_feature_array_info">
<span class="sig-name descname"><span class="pre">get_feature_array_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_index</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L4593-L4620"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Volume.get_feature_array_info" title="Link to this definition">#</a></dt>
<dd><p>Return the metadata associated to the feature array at <code class="docutils literal notranslate"><span class="pre">feature_index</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>feature_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#warp.Volume.FeatureArrayInfo" title="warp.types.Volume.FeatureArrayInfo"><em>FeatureArrayInfo</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.Volume.feature_array">
<span class="sig-name descname"><span class="pre">feature_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L4621-L4655"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Volume.feature_array" title="Link to this definition">#</a></dt>
<dd><p>Return one the grid’s feature data arrays as a Warp array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feature_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Index of the supplemental data array in the grid</p></li>
<li><p><strong>dtype</strong> – Data type for the returned Warp array.
If not provided, will be deduced from the array metadata.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#warp.array" title="warp.types.array"><em>array</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.Volume.load_from_nvdb">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_from_nvdb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_or_buffer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L4656-L4719"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Volume.load_from_nvdb" title="Link to this definition">#</a></dt>
<dd><p>Create a <a class="reference internal" href="#warp.Volume" title="warp.Volume"><code class="xref py py-class docutils literal notranslate"><span class="pre">Volume</span></code></a> object from a serialized NanoVDB file or in-memory buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A <code class="docutils literal notranslate"><span class="pre">warp.Volume</span></code> object.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#warp.Volume" title="warp.types.Volume"><em>Volume</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.Volume.save_to_nvdb">
<span class="sig-name descname"><span class="pre">save_to_nvdb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">codec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'none'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L4720-L4852"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Volume.save_to_nvdb" title="Link to this definition">#</a></dt>
<dd><p>Serialize the Volume into a NanoVDB (.nvdb) file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> – File path to save.</p></li>
<li><p><strong>codec</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'none'</em><em>, </em><em>'zip'</em><em>, </em><em>'blosc'</em><em>]</em>) – Compression codec used
“none” - no compression
“zip” - ZIP compression
“blosc” - BLOSC compression, requires the blosc module to be installed</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.Volume.load_from_address">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_from_address</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_ptr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L4853-L4889"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Volume.load_from_address" title="Link to this definition">#</a></dt>
<dd><p>Creates a new <a class="reference internal" href="#warp.Volume" title="warp.Volume"><code class="xref py py-class docutils literal notranslate"><span class="pre">Volume</span></code></a> aliasing an in-memory grid buffer.</p>
<p>In contrast to <a class="reference internal" href="#warp.Volume.load_from_nvdb" title="warp.Volume.load_from_nvdb"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load_from_nvdb()</span></code></a> which should be used to load serialized NanoVDB grids,
here the buffer must be uncompressed and must not contain file header information.
If the passed address does not contain a NanoVDB grid, the behavior of this function is undefined.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid_ptr</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Integer address of the start of the grid buffer</p></li>
<li><p><strong>buffer_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Size of the buffer, in bytes. If not provided, the size will be assumed to be that of the single grid starting at <cite>grid_ptr</cite>.</p></li>
<li><p><strong>device</strong> – Device of the buffer, and of the returned Volume. If not provided, the current Warp device is assumed.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#warp.Volume" title="warp.types.Volume"><em>Volume</em></a></p>
</dd>
</dl>
<p>Returns the newly created Volume.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.Volume.load_next_grid">
<span class="sig-name descname"><span class="pre">load_next_grid</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L4890-L4914"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Volume.load_next_grid" title="Link to this definition">#</a></dt>
<dd><p>Tries to create a new warp Volume for the next grid that is linked to by this Volume.</p>
<p>The existence of a next grid is deduced from the <cite>grid_index</cite> and <cite>grid_count</cite> metadata
as well as the size of this Volume’s in-memory buffer.</p>
<p>Returns the newly created Volume, or None if there is no next grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#warp.Volume" title="warp.types.Volume"><em>Volume</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.Volume.load_from_numpy">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_from_numpy</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">ndarray</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">min_world</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0)</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">voxel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">bg_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L4915-L4999"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Volume.load_from_numpy" title="Link to this definition">#</a></dt>
<dd><p>Creates a Volume object from a dense 3D NumPy array.</p>
<p>This function is only supported for CUDA devices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>min_world</strong> – The 3D coordinate of the lower corner of the volume.</p></li>
<li><p><strong>voxel_size</strong> – The size of each voxel in spatial coordinates.</p></li>
<li><p><strong>bg_value</strong> – Background value</p></li>
<li><p><strong>device</strong> – The CUDA device to create the volume on, e.g.: “cuda” or “cuda:0”.</p></li>
<li><p><strong>ndarray</strong> (<em>array</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <code class="docutils literal notranslate"><span class="pre">warp.Volume</span></code> object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#warp.Volume" title="warp.types.Volume"><em>Volume</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.Volume.allocate">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">allocate</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">min</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">max</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">voxel_size</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">bg_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">translation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0)</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">points_in_world_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L5000-L5049"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Volume.allocate" title="Link to this definition">#</a></dt>
<dd><p>Allocate a new Volume based on the bounding box defined by min and max.</p>
<p>This function is only supported for CUDA devices.</p>
<p>Allocate a volume that is large enough to contain voxels [min[0], min[1], min[2]] - [max[0], max[1], max[2]], inclusive.
If points_in_world_space is true, then min and max are first converted to index space with the given voxel size and
translation, and the volume is allocated with those.</p>
<p>The smallest unit of allocation is a dense tile of 8x8x8 voxels, the requested bounding box is rounded up to tiles, and
the resulting tiles will be available in the new volume.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>min</strong> (<em>array-like</em>) – Lower 3D coordinates of the bounding box in index space or world space, inclusive.</p></li>
<li><p><strong>max</strong> (<em>array-like</em>) – Upper 3D coordinates of the bounding box in index space or world space, inclusive.</p></li>
<li><p><strong>voxel_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Voxel size of the new volume.</p></li>
<li><p><strong>bg_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> or </em><em>array-like</em>) – Value of unallocated voxels of the volume, also defines the volume’s type, a <code class="xref py py-class docutils literal notranslate"><span class="pre">warp.vec3</span></code> volume is created if this is <cite>array-like</cite>, otherwise a float volume is created</p></li>
<li><p><strong>translation</strong> (<em>array-like</em>) – translation between the index and world spaces.</p></li>
<li><p><strong>device</strong> (<em>Devicelike</em>) – The CUDA device to create the volume on, e.g.: “cuda” or “cuda:0”.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#warp.Volume" title="warp.types.Volume"><em>Volume</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.Volume.allocate_by_tiles">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">allocate_by_tiles</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">tile_points</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">voxel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">bg_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">translation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0)</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L5078-L5185"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Volume.allocate_by_tiles" title="Link to this definition">#</a></dt>
<dd><p>Allocate a new Volume with active tiles for each point tile_points.</p>
<p>This function is only supported for CUDA devices.</p>
<p>The smallest unit of allocation is a dense tile of 8x8x8 voxels.
This is the primary method for allocating sparse volumes. It uses an array of points indicating the tiles that must be allocated.</p>
<dl class="simple">
<dt>Example use cases:</dt><dd><ul class="simple">
<li><p><cite>tile_points</cite> can mark tiles directly in index space as in the case this method is called by <cite>allocate</cite>.</p></li>
<li><p><cite>tile_points</cite> can be a list of points used in a simulation that needs to transfer data to a volume.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tile_points</strong> (<a class="reference internal" href="#warp.array" title="warp.array"><code class="xref py py-class docutils literal notranslate"><span class="pre">warp.array</span></code></a>) – Array of positions that define the tiles to be allocated.
The array may use an integer scalar type (2D N-by-3 array of <a class="reference internal" href="functions.html#warp.int32" title="warp.int32"><code class="xref py py-class docutils literal notranslate"><span class="pre">warp.int32</span></code></a> or 1D array of <cite>warp.vec3i</cite> values), indicating index space positions,
or a floating point scalar type (2D N-by-3 array of <a class="reference internal" href="functions.html#warp.float32" title="warp.float32"><code class="xref py py-class docutils literal notranslate"><span class="pre">warp.float32</span></code></a> or 1D array of <cite>warp.vec3f</cite> values), indicating world space positions.
Repeated points per tile are allowed and will be efficiently deduplicated.</p></li>
<li><p><strong>voxel_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> or </em><em>array-like</em>) – Voxel size(s) of the new volume. Ignored if <cite>transform</cite> is given.</p></li>
<li><p><strong>bg_value</strong> (<em>array-like</em><em>, </em><em>scalar</em><em> or </em><em>None</em>) – Value of unallocated voxels of the volume, also defines the volume’s type. An index volume will be created if <cite>bg_value</cite> is <code class="docutils literal notranslate"><span class="pre">None</span></code>.
Other supported grid types are <cite>int</cite>, <cite>float</cite>, <cite>vec3f</cite>, and <cite>vec4f</cite>.</p></li>
<li><p><strong>translation</strong> (<em>array-like</em>) – Translation between the index and world spaces.</p></li>
<li><p><strong>transform</strong> (<em>array-like</em>) – Linear transform between the index and world spaces. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, deduced from <cite>voxel_size</cite>.</p></li>
<li><p><strong>device</strong> (<em>Devicelike</em>) – The CUDA device to create the volume on, e.g.: “cuda” or “cuda:0”.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#warp.Volume" title="warp.types.Volume"><em>Volume</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.Volume.allocate_by_voxels">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">allocate_by_voxels</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">voxel_points</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">voxel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">translation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0)</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L5186-L5244"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Volume.allocate_by_voxels" title="Link to this definition">#</a></dt>
<dd><p>Allocate a new Volume with active voxel for each point voxel_points.</p>
<p>This function creates an <em>index</em> Volume, a special kind of volume that does not any store any
explicit payload but encodes a linearized index for each active voxel, allowing to lookup and
sample data from arbitrary external arrays.</p>
<p>This function is only supported for CUDA devices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>voxel_points</strong> (<a class="reference internal" href="#warp.array" title="warp.array"><code class="xref py py-class docutils literal notranslate"><span class="pre">warp.array</span></code></a>) – Array of positions that define the voxels to be allocated.
The array may use an integer scalar type (2D N-by-3 array of <a class="reference internal" href="functions.html#warp.int32" title="warp.int32"><code class="xref py py-class docutils literal notranslate"><span class="pre">warp.int32</span></code></a> or 1D array of <cite>warp.vec3i</cite> values), indicating index space positions,
or a floating point scalar type (2D N-by-3 array of <a class="reference internal" href="functions.html#warp.float32" title="warp.float32"><code class="xref py py-class docutils literal notranslate"><span class="pre">warp.float32</span></code></a> or 1D array of <cite>warp.vec3f</cite> values), indicating world space positions.
Repeated points per tile are allowed and will be efficiently deduplicated.</p></li>
<li><p><strong>voxel_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> or </em><em>array-like</em>) – Voxel size(s) of the new volume. Ignored if <cite>transform</cite> is given.</p></li>
<li><p><strong>translation</strong> (<em>array-like</em>) – Translation between the index and world spaces.</p></li>
<li><p><strong>transform</strong> (<em>array-like</em>) – Linear transform between the index and world spaces. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, deduced from <cite>voxel_size</cite>.</p></li>
<li><p><strong>device</strong> (<em>Devicelike</em>) – The CUDA device to create the volume on, e.g.: “cuda” or “cuda:0”.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#warp.Volume" title="warp.types.Volume"><em>Volume</em></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="functions.html#volumes">Reference</a> for the volume functions available in kernels.</p>
</div>
</section>
<section id="bounding-value-hierarchies-bvh">
<h3>Bounding Value Hierarchies (BVH)<a class="headerlink" href="#bounding-value-hierarchies-bvh" title="Link to this heading">#</a></h3>
<p>The <a class="reference internal" href="#warp.Bvh" title="warp.Bvh"><code class="xref py py-class docutils literal notranslate"><span class="pre">wp.Bvh</span></code></a> class can be used to create a BVH for a group of bounding volumes. This object can then be traversed
to determine which parts are intersected by a ray using <a class="reference internal" href="functions.html#warp.bvh_query_ray" title="warp.bvh_query_ray"><code class="xref py py-func docutils literal notranslate"><span class="pre">bvh_query_ray()</span></code></a> and which parts overlap
with a certain bounding volume using <a class="reference internal" href="functions.html#warp.bvh_query_aabb" title="warp.bvh_query_aabb"><code class="xref py py-func docutils literal notranslate"><span class="pre">bvh_query_aabb()</span></code></a>.</p>
<p>The following snippet demonstrates how to create a <a class="reference internal" href="#warp.Bvh" title="warp.Bvh"><code class="xref py py-class docutils literal notranslate"><span class="pre">wp.Bvh</span></code></a> object from 100 random bounding volumes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>

<span class="n">num_bounds</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">lowers</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">num_bounds</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="o">*</span> <span class="mf">5.0</span>
<span class="n">uppers</span> <span class="o">=</span> <span class="n">lowers</span> <span class="o">+</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">num_bounds</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="o">*</span> <span class="mf">5.0</span>

<span class="n">device_lowers</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">lowers</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda:0&quot;</span><span class="p">)</span>
<span class="n">device_uppers</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">uppers</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda:0&quot;</span><span class="p">)</span>

<span class="n">bvh</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">Bvh</span><span class="p">(</span><span class="n">device_lowers</span><span class="p">,</span> <span class="n">device_uppers</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="warp.Bvh">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">Bvh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L4025-L4145"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Bvh" title="Link to this definition">#</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="warp.Bvh.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lowers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uppers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constructor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L4031-L4122"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Bvh.__init__" title="Link to this definition">#</a></dt>
<dd><p>Class representing a bounding volume hierarchy.</p>
<p>Depending on which device the input bounds live, it can be either a CPU tree or a GPU tree.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="warp.Bvh.id">
<span class="sig-name descname"><span class="pre">id</span></span><a class="headerlink" href="#warp.Bvh.id" title="Link to this definition">#</a></dt>
<dd><p>Unique identifier for this BVH object, can be passed to kernels.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.Bvh.device">
<span class="sig-name descname"><span class="pre">device</span></span><a class="headerlink" href="#warp.Bvh.device" title="Link to this definition">#</a></dt>
<dd><p>Device this object lives on, all buffers must live on the same device.</p>
</dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lowers</strong> (<a class="reference internal" href="#warp.array" title="warp.types.array"><em>array</em></a>) – Array of lower bounds of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">warp.vec3</span></code>.</p></li>
<li><p><strong>uppers</strong> (<a class="reference internal" href="#warp.array" title="warp.types.array"><em>array</em></a>) – Array of upper bounds of data type <code class="xref py py-class docutils literal notranslate"><span class="pre">warp.vec3</span></code>.
<code class="docutils literal notranslate"><span class="pre">lowers</span></code> and <code class="docutils literal notranslate"><span class="pre">uppers</span></code> must live on the same device.</p></li>
<li><p><strong>constructor</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – The construction algorithm used to build the tree.
Valid choices are <code class="docutils literal notranslate"><span class="pre">&quot;sah&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;median&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;lbvh&quot;</span></code>, or <code class="docutils literal notranslate"><span class="pre">None</span></code>.
When <code class="docutils literal notranslate"><span class="pre">None</span></code>, the default constructor will be used (see the note).</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Explanation of BVH constructors:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;sah&quot;</span></code>: A CPU-based top-down constructor where the AABBs are split based on Surface Area
Heuristics (SAH). Construction takes slightly longer than others but has the best query
performance.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;median&quot;</span></code>: A CPU-based top-down constructor where the AABBs are split based on the median
of centroids of primitives in an AABB. This constructor is faster than SAH but offers
inferior query performance.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;lbvh&quot;</span></code>: A GPU-based bottom-up constructor which maximizes parallelism. Construction is very
fast, especially for large models. Query performance is slightly slower than <code class="docutils literal notranslate"><span class="pre">&quot;sah&quot;</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: The constructor will be automatically chosen based on the device where the tree
lives. For a GPU tree, the <code class="docutils literal notranslate"><span class="pre">&quot;lbvh&quot;</span></code> constructor will be selected; for a CPU tree, the <code class="docutils literal notranslate"><span class="pre">&quot;sah&quot;</span></code>
constructor will be selected.</p></li>
</ul>
<p>All three constructors are supported for GPU trees. When a CPU-based constructor is selected
for a GPU tree, bounds will be copied back to the CPU to run the CPU-based constructor. After
construction, the CPU tree will be copied to the GPU.</p>
<p>Only <code class="docutils literal notranslate"><span class="pre">&quot;sah&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;median&quot;</span></code> are supported for CPU trees. If <code class="docutils literal notranslate"><span class="pre">&quot;lbvh&quot;</span></code> is selected for a CPU tree, a
warning message will be issued, and the constructor will automatically fall back to <code class="docutils literal notranslate"><span class="pre">&quot;sah&quot;</span></code>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.Bvh.refit">
<span class="sig-name descname"><span class="pre">refit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L4134-L4145"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.Bvh.refit" title="Link to this definition">#</a></dt>
<dd><p>Refit the BVH.</p>
<p>This should be called after users modify the <code class="docutils literal notranslate"><span class="pre">lowers</span></code> or <code class="docutils literal notranslate"><span class="pre">uppers</span></code> arrays.</p>
</dd></dl>

</dd></dl>

<section id="example-bvh-ray-traversal">
<h4>Example: BVH Ray Traversal<a class="headerlink" href="#example-bvh-ray-traversal" title="Link to this heading">#</a></h4>
<p>An example of performing a ray traversal on the data structure is as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">bvh_query_ray</span><span class="p">(</span>
    <span class="n">bvh_id</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">uint64</span><span class="p">,</span>
    <span class="n">start</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">,</span>
    <span class="nb">dir</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">,</span>
    <span class="n">bounds_intersected</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">bool</span><span class="p">),</span>
<span class="p">):</span>
    <span class="n">query</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">bvh_query_ray</span><span class="p">(</span><span class="n">bvh_id</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="nb">dir</span><span class="p">)</span>
    <span class="n">bounds_nr</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">while</span> <span class="n">wp</span><span class="o">.</span><span class="n">bvh_query_next</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">bounds_nr</span><span class="p">):</span>
        <span class="c1"># The ray intersects the volume with index bounds_nr</span>
        <span class="n">bounds_intersected</span><span class="p">[</span><span class="n">bounds_nr</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>


<span class="n">bounds_intersected</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">num_bounds</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">bool</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda:0&quot;</span><span class="p">)</span>
<span class="n">query_start</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="n">query_dir</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>

<span class="n">wp</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span>
    <span class="n">kernel</span><span class="o">=</span><span class="n">bvh_query_ray</span><span class="p">,</span>
    <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">bvh</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">query_start</span><span class="p">,</span> <span class="n">query_dir</span><span class="p">,</span> <span class="n">bounds_intersected</span><span class="p">],</span>
    <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda:0&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The Warp kernel <code class="docutils literal notranslate"><span class="pre">bvh_query_ray</span></code> is launched with a single thread, provided the unique <a class="reference internal" href="functions.html#warp.uint64" title="warp.uint64"><code class="xref py py-class docutils literal notranslate"><span class="pre">uint64</span></code></a>
identifier of the <a class="reference internal" href="#warp.Bvh" title="warp.Bvh"><code class="xref py py-class docutils literal notranslate"><span class="pre">wp.Bvh</span></code></a> object, parameters describing the ray, and an array to store the results.
In <code class="docutils literal notranslate"><span class="pre">bvh_query_ray</span></code>, <a class="reference internal" href="functions.html#warp.bvh_query_ray" title="warp.bvh_query_ray"><code class="xref py py-func docutils literal notranslate"><span class="pre">wp.bvh_query_ray()</span></code></a> is called once to obtain an object that is stored in the
variable <code class="docutils literal notranslate"><span class="pre">query</span></code>. An integer is also allocated as <code class="docutils literal notranslate"><span class="pre">bounds_nr</span></code> to store the volume index of the traversal.
A while statement is used for the actual traversal using <a class="reference internal" href="functions.html#warp.bvh_query_next" title="warp.bvh_query_next"><code class="xref py py-func docutils literal notranslate"><span class="pre">wp.bvh_query_next()</span></code></a>,
which returns <code class="docutils literal notranslate"><span class="pre">True</span></code> as long as there are intersecting bounds.</p>
</section>
<section id="example-bvh-volume-traversal">
<h4>Example: BVH Volume Traversal<a class="headerlink" href="#example-bvh-volume-traversal" title="Link to this heading">#</a></h4>
<p>Similar to the ray-traversal example, we can perform volume traversal to find the volumes that are overlapping with
a specified bounding box.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@wp</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">bvh_query_aabb</span><span class="p">(</span>
    <span class="n">bvh_id</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">uint64</span><span class="p">,</span>
    <span class="n">lower</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">,</span>
    <span class="n">upper</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">,</span>
    <span class="n">bounds_intersected</span><span class="p">:</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">bool</span><span class="p">),</span>
<span class="p">):</span>
    <span class="n">query</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">bvh_query_aabb</span><span class="p">(</span><span class="n">bvh_id</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">)</span>
    <span class="n">bounds_nr</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">while</span> <span class="n">wp</span><span class="o">.</span><span class="n">bvh_query_next</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">bounds_nr</span><span class="p">):</span>
        <span class="c1"># The volume with index bounds_nr is fully contained</span>
        <span class="c1"># in the (lower,upper) bounding box</span>
        <span class="n">bounds_intersected</span><span class="p">[</span><span class="n">bounds_nr</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>


<span class="n">bounds_intersected</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">num_bounds</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">bool</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda:0&quot;</span><span class="p">)</span>
<span class="n">query_lower</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">(</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)</span>
<span class="n">query_upper</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">vec3</span><span class="p">(</span><span class="mf">6.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">)</span>

<span class="n">wp</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span>
    <span class="n">kernel</span><span class="o">=</span><span class="n">bvh_query_aabb</span><span class="p">,</span>
    <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">bvh</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">query_lower</span><span class="p">,</span> <span class="n">query_upper</span><span class="p">,</span> <span class="n">bounds_intersected</span><span class="p">],</span>
    <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda:0&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The kernel is nearly identical to the ray-traversal example, except we obtain <code class="docutils literal notranslate"><span class="pre">query</span></code> using
<a class="reference internal" href="functions.html#warp.bvh_query_aabb" title="warp.bvh_query_aabb"><code class="xref py py-func docutils literal notranslate"><span class="pre">wp.bvh_query_aabb()</span></code></a>.</p>
</section>
</section>
<section id="object-lifetime-pitfall">
<span id="id8"></span><h3>Object Lifetime Pitfall<a class="headerlink" href="#object-lifetime-pitfall" title="Link to this heading">#</a></h3>
<p>When working with spatial computing primitives like <a class="reference internal" href="#warp.HashGrid" title="warp.HashGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">wp.HashGrid</span></code></a> and <a class="reference internal" href="#warp.Bvh" title="warp.Bvh"><code class="xref py py-class docutils literal notranslate"><span class="pre">wp.Bvh</span></code></a>,
it’s crucial to understand how Python’s garbage collection interacts with these objects.
The following example demonstrate a common mistake and how to avoid it.</p>
<p><strong>Common Pitfall</strong>: Creating objects in loops and only storing their IDs</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># WRONG - objects may be garbage collected</span>
<span class="n">hash_grids</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">HashGrid</span><span class="p">(</span><span class="n">dim_x</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">dim_y</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">dim_z</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
    <span class="n">grid</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">points</span><span class="o">=</span><span class="n">particle_positions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">radius</span><span class="o">=</span><span class="n">search_radius</span><span class="p">)</span>
    <span class="n">hash_grids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>  <span class="c1"># Only storing the ID</span>

<span class="c1"># RIGHT - maintain references to the objects</span>
<span class="n">hash_grid_objects</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">HashGrid</span><span class="p">(</span><span class="n">dim_x</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">dim_y</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">dim_z</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
    <span class="n">grid</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">points</span><span class="o">=</span><span class="n">particle_positions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">radius</span><span class="o">=</span><span class="n">search_radius</span><span class="p">)</span>
    <span class="n">hash_grid_objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>  <span class="c1"># Keep the object alive</span>

<span class="c1"># Create Warp array for kernel execution when needed</span>
<span class="n">grid_ids_array</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">hash_grid_objects</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">wp</span><span class="o">.</span><span class="n">uint64</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>

<span class="n">wp</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span><span class="n">my_kernel</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">grid_ids_array</span><span class="p">])</span>
</pre></div>
</div>
<p><strong>Why This Happens</strong>: When you only store the <code class="docutils literal notranslate"><span class="pre">id</span></code> attribute (which is a <code class="docutils literal notranslate"><span class="pre">wp.uint64</span></code> pointer),
Python’s garbage collector may free the original object if no other references exist. This leads to
undefined behavior when the kernel tries to access the freed memory.</p>
<p><strong>Common Problematic Scenarios</strong>:</p>
<ol class="arabic simple">
<li><p><strong>Creating objects in loops</strong> and only storing their IDs</p></li>
<li><p><strong>Creating objects in functions</strong> and returning only the ID</p></li>
<li><p><strong>Creating objects as temporary variables</strong> that get overwritten</p></li>
</ol>
<p>Always maintain references to spatial computing primitive objects
(like <a class="reference internal" href="#warp.HashGrid" title="warp.HashGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">wp.HashGrid</span></code></a>, <a class="reference internal" href="#warp.Bvh" title="warp.Bvh"><code class="xref py py-class docutils literal notranslate"><span class="pre">wp.Bvh</span></code></a>, etc.) rather than just their ID values.
This is especially important in loops, functions, and temporary variables where object scope might be unclear.</p>
</section>
</section>
<section id="marching-cubes">
<h2>Marching Cubes<a class="headerlink" href="#marching-cubes" title="Link to this heading">#</a></h2>
<p>The <a class="reference internal" href="#warp.MarchingCubes" title="warp.MarchingCubes"><code class="xref py py-class docutils literal notranslate"><span class="pre">wp.MarchingCubes</span></code></a> class can be used to extract a 2-D mesh approximating an
isosurface of a 3-D scalar field. The resulting triangle mesh can be saved to a USD
file using the <a class="reference internal" href="render.html#warp.render.UsdRenderer" title="warp.render.UsdRenderer"><code class="xref py py-class docutils literal notranslate"><span class="pre">warp.render.UsdRenderer</span></code></a>.</p>
<p>See <a class="extlink-github reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/examples/core/example_marching_cubes.py">warp/examples/core/example_marching_cubes.py</a> for a usage example.</p>
<dl class="py class">
<dt class="sig sig-object py" id="warp.MarchingCubes">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">MarchingCubes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/marching_cubes.py#L484-L709"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.MarchingCubes" title="Link to this definition">#</a></dt>
<dd><p>A reusable context for marching cubes surface extraction.</p>
<p>This class provides a stateful interface for isosurface extraction. You
can initialize it with a specific grid configuration and then call the
<a class="reference internal" href="#warp.MarchingCubes.surface" title="warp.MarchingCubes.surface"><code class="xref py py-meth docutils literal notranslate"><span class="pre">surface()</span></code></a> method multiple times, which is efficient for processing
fields of the same size.</p>
<p>For a simpler, stateless operation, use the static method
<a class="reference internal" href="#warp.MarchingCubes.extract_surface_marching_cubes" title="warp.MarchingCubes.extract_surface_marching_cubes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">extract_surface_marching_cubes()</span></code></a>.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="warp.MarchingCubes.nx">
<span class="sig-name descname"><span class="pre">nx</span></span><a class="headerlink" href="#warp.MarchingCubes.nx" title="Link to this definition">#</a></dt>
<dd><p>The number of grid nodes in the x-direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.MarchingCubes.ny">
<span class="sig-name descname"><span class="pre">ny</span></span><a class="headerlink" href="#warp.MarchingCubes.ny" title="Link to this definition">#</a></dt>
<dd><p>The number of grid nodes in the y-direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.MarchingCubes.nz">
<span class="sig-name descname"><span class="pre">nz</span></span><a class="headerlink" href="#warp.MarchingCubes.nz" title="Link to this definition">#</a></dt>
<dd><p>The number of grid nodes in the z-direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.MarchingCubes.domain_bounds_lower_corner">
<span class="sig-name descname"><span class="pre">domain_bounds_lower_corner</span></span><a class="headerlink" href="#warp.MarchingCubes.domain_bounds_lower_corner" title="Link to this definition">#</a></dt>
<dd><p>The lower bound
for the mesh coordinate scaling. See the documentation in
<a class="reference internal" href="#warp.MarchingCubes.extract_surface_marching_cubes" title="warp.MarchingCubes.extract_surface_marching_cubes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">extract_surface_marching_cubes()</span></code></a> for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>wp.vec3 | <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a> | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.MarchingCubes.domain_bounds_upper_corner">
<span class="sig-name descname"><span class="pre">domain_bounds_upper_corner</span></span><a class="headerlink" href="#warp.MarchingCubes.domain_bounds_upper_corner" title="Link to this definition">#</a></dt>
<dd><p>The upper bound
for the mesh coordinate scaling. See the documentation in
<a class="reference internal" href="#warp.MarchingCubes.extract_surface_marching_cubes" title="warp.MarchingCubes.extract_surface_marching_cubes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">extract_surface_marching_cubes()</span></code></a> for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>wp.vec3 | <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a> | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.MarchingCubes.verts">
<span class="sig-name descname"><span class="pre">verts</span></span><a class="headerlink" href="#warp.MarchingCubes.verts" title="Link to this definition">#</a></dt>
<dd><p>An array of vertex positions of type
<a class="reference internal" href="functions.html#warp.vec3f" title="warp.vec3f"><code class="xref py py-class docutils literal notranslate"><span class="pre">warp.vec3f</span></code></a> for the output mesh.
This is populated by calling the <a class="reference internal" href="#warp.MarchingCubes.surface" title="warp.MarchingCubes.surface"><code class="xref py py-meth docutils literal notranslate"><span class="pre">surface()</span></code></a> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#warp.array" title="warp.array">warp.array</a> | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.MarchingCubes.indices">
<span class="sig-name descname"><span class="pre">indices</span></span><a class="headerlink" href="#warp.MarchingCubes.indices" title="Link to this definition">#</a></dt>
<dd><p>An array of triangle indices of type
<a class="reference internal" href="functions.html#warp.int32" title="warp.int32"><code class="xref py py-class docutils literal notranslate"><span class="pre">warp.int32</span></code></a> for the output mesh.
This is populated by calling the <a class="reference internal" href="#warp.MarchingCubes.surface" title="warp.MarchingCubes.surface"><code class="xref py py-meth docutils literal notranslate"><span class="pre">surface()</span></code></a> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#warp.array" title="warp.array">warp.array</a> | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warp.MarchingCubes.device">
<span class="sig-name descname"><span class="pre">device</span></span><a class="headerlink" href="#warp.MarchingCubes.device" title="Link to this definition">#</a></dt>
<dd><p>The device on which the context was created. This
attribute is for backward compatibility and is not used by the
class’s methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>warp.Device</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.MarchingCubes.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">nx</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">ny</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">nz</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">max_verts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">max_tris</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">domain_bounds_lower_corner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">domain_bounds_upper_corner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/marching_cubes.py#L520-L569"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.MarchingCubes.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize the marching cubes context with a grid configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of grid nodes in the x-direction.</p></li>
<li><p><strong>ny</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of grid nodes in the y-direction.</p></li>
<li><p><strong>nz</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of grid nodes in the z-direction.</p></li>
<li><p><strong>max_verts</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – (Deprecated) This argument is ignored.</p></li>
<li><p><strong>max_tris</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – (Deprecated) This argument is ignored.</p></li>
<li><p><strong>device</strong> (<em>Devicelike</em>) – (Deprecated) The value is assigned to
<cite>self.device</cite> for backward compatibility but is not used by the
class’s methods. It may be removed in a future version.</p></li>
<li><p><strong>domain_bounds_lower_corner</strong> – See the documentation in
<a class="reference internal" href="#warp.MarchingCubes.extract_surface_marching_cubes" title="warp.MarchingCubes.extract_surface_marching_cubes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">extract_surface_marching_cubes()</span></code></a>.</p></li>
<li><p><strong>domain_bounds_upper_corner</strong> – See the documentation in
<a class="reference internal" href="#warp.MarchingCubes.extract_surface_marching_cubes" title="warp.MarchingCubes.extract_surface_marching_cubes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">extract_surface_marching_cubes()</span></code></a>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.MarchingCubes.resize">
<span class="sig-name descname"><span class="pre">resize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ny</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_verts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_tris</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/marching_cubes.py#L570-L587"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.MarchingCubes.resize" title="Link to this definition">#</a></dt>
<dd><p>Update the grid dimensions for the context.</p>
<p>This allows the instance to be reused for scalar fields of a different
resolution. The new dimensions take effect on the next call to
<a class="reference internal" href="#warp.MarchingCubes.surface" title="warp.MarchingCubes.surface"><code class="xref py py-meth docutils literal notranslate"><span class="pre">surface()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – New number of nodes in the x-direction.</p></li>
<li><p><strong>ny</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – New number of nodes in the y-direction.</p></li>
<li><p><strong>nz</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – New number of nodes in the z-direction.</p></li>
<li><p><strong>max_verts</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – (Deprecated) This argument is ignored.</p></li>
<li><p><strong>max_tris</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – (Deprecated) This argument is ignored.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.MarchingCubes.surface">
<span class="sig-name descname"><span class="pre">surface</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/marching_cubes.py#L588-L619"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.MarchingCubes.surface" title="Link to this definition">#</a></dt>
<dd><p>Compute a 2D surface mesh of a given isosurface from a 3D scalar field.</p>
<p>This method is a convenience wrapper that calls the core static method
and stores the resulting mesh data in the <a class="reference internal" href="#warp.MarchingCubes.verts" title="warp.MarchingCubes.verts"><code class="xref py py-attr docutils literal notranslate"><span class="pre">verts</span></code></a> and
<a class="reference internal" href="#warp.MarchingCubes.indices" title="warp.MarchingCubes.indices"><code class="xref py py-attr docutils literal notranslate"><span class="pre">indices</span></code></a> attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>field</strong> (<a class="reference internal" href="#warp.array" title="warp.array"><em>array</em></a><em>(</em><em>ndim=3</em><em>, </em><em>dtype=float32</em><em>)</em>) – A 3D scalar field whose shape must match the grid dimensions
(nx, ny, nz) of the instance.</p></li>
<li><p><strong>threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The field value defining the isosurface to extract.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If the shape of <code class="docutils literal notranslate"><span class="pre">field</span></code> does not match the configured
    grid dimensions of the instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="warp.MarchingCubes.extract_surface_marching_cubes">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">extract_surface_marching_cubes</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">domain_bounds_lower_corner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">domain_bounds_upper_corner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/marching_cubes.py#L620-L706"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.MarchingCubes.extract_surface_marching_cubes" title="Link to this definition">#</a></dt>
<dd><p>Extract a triangular mesh from a 3D scalar field.</p>
<p>This function generates an isosurface by processing the entire input <code class="docutils literal notranslate"><span class="pre">field</span></code>.
The resolution of the output mesh is determined by the shape of the <code class="docutils literal notranslate"><span class="pre">field</span></code>
array and may differ along each dimension.</p>
<p>The coordinates of the mesh can be scaled to a specific bounding box
using the <code class="docutils literal notranslate"><span class="pre">domain_bounds_lower_corner</span></code> and
<code class="docutils literal notranslate"><span class="pre">domain_bounds_upper_corner</span></code> parameters. If a bound is not provided
(i.e., left as <code class="docutils literal notranslate"><span class="pre">None</span></code>), it will be assigned a default value that
aligns the mesh with the integer indices of the input grid.</p>
<p>For example, setting the bounds to <code class="docutils literal notranslate"><span class="pre">wp.vec3(0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0)</span></code> and
<code class="docutils literal notranslate"><span class="pre">wp.vec3(1.0,</span> <span class="pre">1.0,</span> <span class="pre">1.0)</span></code> will scale the output mesh to fit
within the unit cube.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>field</strong> (<a class="reference internal" href="#warp.array" title="warp.array"><em>array</em></a><em>(</em><em>ndim=3</em><em>, </em><em>dtype=float32</em><em>)</em>) – A 3D array representing the scalar values on a regular grid.</p></li>
<li><p><strong>threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The field value defining the isosurface to extract.</p></li>
<li><p><strong>domain_bounds_lower_corner</strong> (<em>vec3f</em><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>] </em><em>| </em><em>None</em>) – The 3D coordinate that the grid’s corner
at index (0,0,0) maps to. Defaults to <code class="docutils literal notranslate"><span class="pre">(0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0)</span></code>
if <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>domain_bounds_upper_corner</strong> (<em>vec3f</em><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>] </em><em>| </em><em>None</em>) – The 3D coordinate that the grid’s corner
at index (nx-1, ny-1, nz-1) maps to. Defaults to align with the
grid’s maximal indices if <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple <code class="docutils literal notranslate"><span class="pre">(vertices,</span> <span class="pre">indices)</span></code> containing the output mesh data. The
<code class="docutils literal notranslate"><span class="pre">indices</span></code> array is a flat list where each group of three consecutive
integers forms a single triangle by referencing vertices in the
<code class="docutils literal notranslate"><span class="pre">vertices</span></code> array.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">field</span></code> is not a 3D array or is empty.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a> – If the <code class="docutils literal notranslate"><span class="pre">field</span></code> data type is not <code class="docutils literal notranslate"><span class="pre">wp.float32</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>[<a class="reference internal" href="#warp.array" title="warp.array">array</a>(ndim=1, dtype=vec3f), <a class="reference internal" href="#warp.array" title="warp.array">array</a>(ndim=1, dtype=int32)]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="profiling">
<h2>Profiling<a class="headerlink" href="#profiling" title="Link to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">wp.ScopedTimer</span></code> objects can be used to gain some basic insight into the performance of Warp applications:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">wp</span><span class="o">.</span><span class="n">ScopedTimer</span><span class="p">(</span><span class="s2">&quot;grid build&quot;</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">point_radius</span><span class="p">)</span>
</pre></div>
</div>
<p>This results in a printout at runtime to the standard output stream like:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">grid build took 0.06 ms</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="../profiling.html"><span class="doc">Profiling</span></a> documentation for more information.</p>
<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">ScopedTimer</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">active</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">print</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">detailed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">use_nvtx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rapids'</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">synchronize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">cuda_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">report_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">skip_tape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/utils.py#L1295-L1425"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>active</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>)</p></li>
<li><p><strong>print</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>)</p></li>
<li><p><strong>detailed</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>)</p></li>
<li><p><strong>dict</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>]</em><em>] </em><em>| </em><em>None</em>)</p></li>
<li><p><strong>use_nvtx</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>)</p></li>
<li><p><strong>color</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>synchronize</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>)</p></li>
<li><p><strong>cuda_filter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>report_func</strong> (<em>Callable</em><em>[</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference internal" href="../profiling.html#warp.TimingResult" title="warp.TimingResult"><em>TimingResult</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em><em>, </em><em>None</em><em>] </em><em>| </em><em>None</em>)</p></li>
<li><p><strong>skip_tape</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">indent</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">-1</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">enabled</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">active</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">print</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">detailed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">use_nvtx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rapids'</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">synchronize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">cuda_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">report_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">skip_tape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/utils.py#L1300-L1352"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Context manager object for a timer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of timer</p></li>
<li><p><strong>active</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – Enables this timer</p></li>
<li><p><strong>print</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – At context manager exit, print elapsed time to <code class="docutils literal notranslate"><span class="pre">sys.stdout</span></code></p></li>
<li><p><strong>detailed</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – Collects additional profiling data using cProfile and calls <code class="docutils literal notranslate"><span class="pre">print_stats()</span></code> at context exit</p></li>
<li><p><strong>dict</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>]</em><em>] </em><em>| </em><em>None</em>) – A dictionary of lists to which the elapsed time will be appended using <code class="docutils literal notranslate"><span class="pre">name</span></code> as a key</p></li>
<li><p><strong>use_nvtx</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – If true, timing functionality is replaced by an NVTX range</p></li>
<li><p><strong>color</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – ARGB value (e.g. 0x00FFFF) or color name (e.g. ‘cyan’) associated with the NVTX range</p></li>
<li><p><strong>synchronize</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – Synchronize the CPU thread with any outstanding CUDA work to return accurate GPU timings</p></li>
<li><p><strong>cuda_filter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Filter flags for CUDA activity timing, e.g. <code class="docutils literal notranslate"><span class="pre">warp.TIMING_KERNEL</span></code> or <code class="docutils literal notranslate"><span class="pre">warp.TIMING_ALL</span></code></p></li>
<li><p><strong>report_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><em>Callable</em></a><em>[</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference internal" href="../profiling.html#warp.TimingResult" title="warp.utils.TimingResult"><em>TimingResult</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em><em>, </em><em>None</em><em>] </em><em>| </em><em>None</em>) – A callback function to print the activity report.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>,  <a class="reference internal" href="../profiling.html#warp.timing_print" title="warp.timing_print"><code class="xref py py-func docutils literal notranslate"><span class="pre">wp.timing_print()</span></code></a> will be used.</p></li>
<li><p><strong>skip_tape</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – If true, the timer will not be recorded in the tape</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">extra_msg</span></span></dt>
<dd><p>Can be set to a string that will be added to the printout at context exit.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">elapsed</span></span></dt>
<dd><p>The duration of the <code class="docutils literal notranslate"><span class="pre">with</span></code> block used with this object</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">timing_results</span></span></dt>
<dd><p>The list of activity timing results, if collection was requested using <code class="docutils literal notranslate"><span class="pre">cuda_filter</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a>[<a class="reference internal" href="../profiling.html#warp.TimingResult" title="warp.TimingResult">TimingResult</a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</dd></dl>

</section>
<section id="interprocess-communication-ipc">
<h2>Interprocess Communication (IPC)<a class="headerlink" href="#interprocess-communication-ipc" title="Link to this heading">#</a></h2>
<p>Interprocess communication can be used to share Warp arrays and events across
processes without creating copies of the underlying data.</p>
<p>Some basic requirements for using IPC include:</p>
<ul>
<li><p>Linux operating system (note however that integrated devices like NVIDIA
Jetson do not support CUDA IPC)</p></li>
<li><p>The array must be allocated on a GPU device using the default memory allocator (see <a class="reference internal" href="allocators.html"><span class="doc">Allocators</span></a>)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">wp.ScopedMempool</span></code> context manager is useful for temporarily disabling
memory pools for the purpose of allocating arrays that can be shared using IPC.</p>
</li>
</ul>
<p>Support for IPC on a device is indicated by the <a class="reference internal" href="devices.html#warp.context.Device.is_ipc_supported" title="warp.context.Device.is_ipc_supported"><code class="xref py py-attr docutils literal notranslate"><span class="pre">is_ipc_supported</span></code></a>
attribute of the <a class="reference internal" href="devices.html#warp.context.Device" title="warp.context.Device"><code class="xref py py-class docutils literal notranslate"><span class="pre">Device</span></code></a>. If the Warp library has
been compiled with CUDA 11, this device attribute will be <code class="docutils literal notranslate"><span class="pre">None</span></code> to indicate
that IPC support could not be determined using the CUDA API.</p>
<p>To share a Warp array between processes, use <a class="reference internal" href="#warp.array.ipc_handle" title="warp.array.ipc_handle"><code class="xref py py-meth docutils literal notranslate"><span class="pre">array.ipc_handle()</span></code></a> in the
originating process to obtain an IPC handle for the array’s memory allocation.
The handle is a <code class="docutils literal notranslate"><span class="pre">bytes</span></code> object with a length of 64.
The IPC handle along with information about the array (data type, shape, and
optionally strides) should be shared with another process, e.g. via shared
memory or files.
Another process can use this information to import the original array by
calling <a class="reference internal" href="#warp.from_ipc_handle" title="warp.from_ipc_handle"><code class="xref py py-func docutils literal notranslate"><span class="pre">from_ipc_handle()</span></code></a>.</p>
<p>Events can be shared in a similar manner, but they must be constructed with
<code class="docutils literal notranslate"><span class="pre">interprocess=True</span></code>. Additionally, events cannot be created with both
<code class="docutils literal notranslate"><span class="pre">interprocess=True</span></code> and <code class="docutils literal notranslate"><span class="pre">enable_timing=True</span></code>. Use <a class="reference internal" href="#warp.Event.ipc_handle" title="warp.Event.ipc_handle"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Event.ipc_handle()</span></code></a>
in the originating process to obtain an IPC handle for the event. Another
process can use this information to import the original event by calling
<a class="reference internal" href="#warp.event_from_ipc_handle" title="warp.event_from_ipc_handle"><code class="xref py py-func docutils literal notranslate"><span class="pre">event_from_ipc_handle()</span></code></a>.</p>
<dl class="py function">
<dt class="sig sig-object py" id="warp.from_ipc_handle">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">from_ipc_handle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">handle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strides</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/types.py#L3594-L3633"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.from_ipc_handle" title="Link to this definition">#</a></dt>
<dd><p>Create an array from an IPC handle.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">dtype</span></code>, <code class="docutils literal notranslate"><span class="pre">shape</span></code>, and optional <code class="docutils literal notranslate"><span class="pre">strides</span></code> arguments should
match the values from the <a class="reference internal" href="#warp.array" title="warp.array"><code class="xref py py-class docutils literal notranslate"><span class="pre">array</span></code></a> from which <code class="docutils literal notranslate"><span class="pre">handle</span></code> was created.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>handle</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.13)"><em>bytes</em></a>) – The interprocess memory handle for an existing device memory allocation.</p></li>
<li><p><strong>dtype</strong> – <p>One of the available <a class="reference external" href="#data-types">data types</a>, such as <a class="reference internal" href="functions.html#warp.float32" title="warp.float32"><code class="xref py py-class docutils literal notranslate"><span class="pre">warp.float32</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">warp.mat33</span></code>, or a custom <a class="reference external" href="#structs">struct</a>.</p>
</p></li>
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>...</em><em>]</em>) – Dimensions of the array.</p></li>
<li><p><strong>strides</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>...</em><em>] </em><em>| </em><em>None</em>) – Number of bytes in each dimension between successive elements of the array.</p></li>
<li><p><strong>device</strong> (<em>Devicelike</em>) – Device to associate with the array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>An array created from the existing memory allocation described by the interprocess memory handle <code class="docutils literal notranslate"><span class="pre">handle</span></code>.</p>
<p>A copy of the underlying data is not made. Modifications to the array’s data will be reflected in the
original process from which <code class="docutils literal notranslate"><span class="pre">handle</span></code> was exported.</p>
</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.13)"><strong>RuntimeError</strong></a> – IPC is not supported on <code class="docutils literal notranslate"><span class="pre">device</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#warp.array" title="warp.types.array"><em>array</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.event_from_ipc_handle">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">event_from_ipc_handle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">handle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L5700-L5732"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.event_from_ipc_handle" title="Link to this definition">#</a></dt>
<dd><p>Create an event from an IPC handle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>handle</strong> – The interprocess event handle for an existing CUDA event.</p></li>
<li><p><strong>device</strong> (<em>Devicelike</em>) – Device to associate with the array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An event created from the interprocess event handle <code class="docutils literal notranslate"><span class="pre">handle</span></code>.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.13)"><strong>RuntimeError</strong></a> – IPC is not supported on <code class="docutils literal notranslate"><span class="pre">device</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#warp.Event" title="warp.context.Event"><em>Event</em></a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="lto-cache">
<h2>LTO Cache<a class="headerlink" href="#lto-cache" title="Link to this heading">#</a></h2>
<p><a class="reference internal" href="tiles.html#mathdx"><span class="std std-ref">MathDx</span></a> generates Link-Time Optimization (LTO) files for GEMM, Cholesky, and FFT tile operations.
Warp caches these to speed up kernel compilation. Each LTO file maps to a specific Linear Algebra
solver configuration, and is otherwise independent of the kernel in which its corresponding routine
is called. Therefore, LTOs are stored in a cache that is independent of a given module’s kernel cache,
and will remain cached even if <a class="reference internal" href="#warp.clear_kernel_cache" title="warp.clear_kernel_cache"><code class="xref py py-func docutils literal notranslate"><span class="pre">wp.clear_kernel_cache()</span></code></a> is called.
<a class="reference internal" href="#warp.clear_lto_cache" title="warp.clear_lto_cache"><code class="xref py py-func docutils literal notranslate"><span class="pre">wp.clear_lto_cache()</span></code></a> can be used to clear the LTO cache.</p>
<dl class="py function">
<dt class="sig sig-object py" id="warp.clear_lto_cache">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">clear_lto_cache</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/build.py#L168-L186"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.clear_lto_cache" title="Link to this definition">#</a></dt>
<dd><p>Clear the LTO cache directory of previously generated LTO code.</p>
<p>The LTO cache is stored within a subdirectory of the kernel cache directory.
This function only clears the cache for the current Warp version.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-management">
<h2>Module Management<a class="headerlink" href="#module-management" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="warp.compile_aot_module">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">compile_aot_module</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">module</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">arch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">module_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">use_ptx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">strip_hash</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L6606-L6671"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.compile_aot_module" title="Link to this definition">#</a></dt>
<dd><p>Compile a module (ahead of time) for a given device.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>module</strong> (<em>Module</em><em> | </em><a class="reference external" href="https://docs.python.org/3/library/types.html#types.ModuleType" title="(in Python v3.13)"><em>ModuleType</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The module to compile.</p></li>
<li><p><strong>device</strong> (<a class="reference internal" href="devices.html#warp.context.Device" title="warp.context.Device"><em>Device</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference internal" href="devices.html#warp.context.Device" title="warp.context.Device"><em>Device</em></a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>] </em><em>| </em><em>None</em>) – The device or devices to compile the module for. If <code class="docutils literal notranslate"><span class="pre">None</span></code>,
and <code class="docutils literal notranslate"><span class="pre">arch</span></code> is not specified, compile the module for the current device.</p></li>
<li><p><strong>arch</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.13)"><em>Iterable</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>] </em><em>| </em><em>None</em>) – The architecture or architectures to compile the module for. If <code class="docutils literal notranslate"><span class="pre">None</span></code>,
the architecture to compile for will be inferred from the current device.</p></li>
<li><p><strong>module_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/os.html#os.PathLike" title="(in Python v3.13)"><em>PathLike</em></a><em> | </em><em>None</em>) – The directory to save the source, meta, and compiled files to.
If not specified, the module will be compiled to the default cache directory.</p></li>
<li><p><strong>use_ptx</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a><em> | </em><em>None</em>) – Whether to compile the module to PTX. This setting is only used
when compiling modules for the GPU. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, Warp will decide an
appropriate setting based on the runtime environment.</p></li>
<li><p><strong>strip_hash</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a><em> | </em><em>None</em>) – <p>Whether to strip the hash from the module and kernel names.
Setting this value to <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code> will update the module’s
<code class="docutils literal notranslate"><span class="pre">&quot;strip_hash&quot;</span></code> option. If left at <code class="docutils literal notranslate"><span class="pre">None</span></code>, the current value will
be used.</p>
<p>Warning: Do not enable <code class="docutils literal notranslate"><span class="pre">strip_hash</span></code> for modules that contain generic
kernels. Generic kernels compile to multiple overloads, and the
per-overload hash is required to distinguish them. Stripping the hash
in this case will cause the module to fail to compile.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a> – If the module argument is not a Module, a types.ModuleType, or a string.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="warp.load_aot_module">
<span class="sig-prename descclassname"><span class="pre">warp.</span></span><span class="sig-name descname"><span class="pre">load_aot_module</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">module</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">arch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">module_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">use_ptx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">strip_hash</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="reference external" href="https://github.com/NVIDIA/warp/blob/v1.9.1/warp/context.py#L6673-L6775"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#warp.load_aot_module" title="Link to this definition">#</a></dt>
<dd><p>Load a previously compiled module (ahead of time).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>module</strong> (<em>Module</em><em> | </em><a class="reference external" href="https://docs.python.org/3/library/types.html#types.ModuleType" title="(in Python v3.13)"><em>ModuleType</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The module to load.</p></li>
<li><p><strong>device</strong> (<a class="reference internal" href="devices.html#warp.context.Device" title="warp.context.Device"><em>Device</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference internal" href="devices.html#warp.context.Device" title="warp.context.Device"><em>Device</em></a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>] </em><em>| </em><em>None</em>) – The device or devices to load the module on. If <code class="docutils literal notranslate"><span class="pre">None</span></code>,
load the module for the current device.</p></li>
<li><p><strong>arch</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><em>None</em>) – The architecture to load the module for on all devices.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the architecture to load for will be inferred from the
current device.</p></li>
<li><p><strong>module_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/os.html#os.PathLike" title="(in Python v3.13)"><em>PathLike</em></a><em> | </em><em>None</em>) – The directory to load the module from.
If not specified, the module will be loaded from the default cache directory.</p></li>
<li><p><strong>use_ptx</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a><em> | </em><em>None</em>) – Whether to load the module from PTX. This setting is only used
when loading modules for the GPU. If <code class="docutils literal notranslate"><span class="pre">None</span></code> on a CUDA device, Warp will
try both PTX and CUBIN (PTX first) and load the first that exists.
If neither exists, a <code class="docutils literal notranslate"><span class="pre">FileNotFoundError</span></code> is raised listing all
attempted paths.</p></li>
<li><p><strong>strip_hash</strong> (<a class="reference internal" href="functions.html#warp.bool" title="warp.bool"><em>bool</em></a>) – <p>Whether to strip the hash from the module and kernel names.
Setting this value to <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code> will update the module’s
<code class="docutils literal notranslate"><span class="pre">&quot;strip_hash&quot;</span></code> option. If left at <code class="docutils literal notranslate"><span class="pre">None</span></code>, the current value will
be used.</p>
<p>Warning: Do not enable <code class="docutils literal notranslate"><span class="pre">strip_hash</span></code> for modules that contain generic
kernels. Generic kernels compile to multiple overloads, and the
per-overload hash is required to distinguish them. Stripping the hash
in this case will cause the module to fail to compile.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#FileNotFoundError" title="(in Python v3.13)"><strong>FileNotFoundError</strong></a> – If no matching binary is found. When <code class="docutils literal notranslate"><span class="pre">use_ptx</span></code> is
    <code class="docutils literal notranslate"><span class="pre">None</span></code> on a CUDA device, both PTX and CUBIN candidates are tried
    before raising.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a> – If the module argument is not a Module, a types.ModuleType, or a string.</p></li>
</ul>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../profiling.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Profiling</p>
      </div>
    </a>
    <a class="right-next"
       href="functions.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Built-Ins Reference</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            


              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#kernels">Kernels</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.kernel"><code class="docutils literal notranslate"><span class="pre">kernel()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.launch"><code class="docutils literal notranslate"><span class="pre">launch()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.launch_tiled"><code class="docutils literal notranslate"><span class="pre">launch_tiled()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.clear_kernel_cache"><code class="docutils literal notranslate"><span class="pre">clear_kernel_cache()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#runtime-kernel-creation">Runtime Kernel Creation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#launch-objects">Launch Objects</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Launch"><code class="docutils literal notranslate"><span class="pre">Launch</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Launch.device"><code class="docutils literal notranslate"><span class="pre">device</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Launch.bounds"><code class="docutils literal notranslate"><span class="pre">bounds</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Launch.max_blocks"><code class="docutils literal notranslate"><span class="pre">max_blocks</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Launch.block_dim"><code class="docutils literal notranslate"><span class="pre">block_dim</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Launch.adjoint"><code class="docutils literal notranslate"><span class="pre">adjoint</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Launch.set_dim"><code class="docutils literal notranslate"><span class="pre">set_dim()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Launch.set_param_at_index"><code class="docutils literal notranslate"><span class="pre">set_param_at_index()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Launch.set_param_at_index_from_ctype"><code class="docutils literal notranslate"><span class="pre">set_param_at_index_from_ctype()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Launch.set_param_by_name"><code class="docutils literal notranslate"><span class="pre">set_param_by_name()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Launch.set_param_by_name_from_ctype"><code class="docutils literal notranslate"><span class="pre">set_param_by_name_from_ctype()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Launch.set_params"><code class="docutils literal notranslate"><span class="pre">set_params()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Launch.set_params_from_ctypes"><code class="docutils literal notranslate"><span class="pre">set_params_from_ctypes()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Launch.launch"><code class="docutils literal notranslate"><span class="pre">launch()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#arrays">Arrays</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.array"><code class="docutils literal notranslate"><span class="pre">array</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.array.dtype"><code class="docutils literal notranslate"><span class="pre">dtype</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.array.ndim"><code class="docutils literal notranslate"><span class="pre">ndim</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.array.size"><code class="docutils literal notranslate"><span class="pre">size</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.array.capacity"><code class="docutils literal notranslate"><span class="pre">capacity</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.array.shape"><code class="docutils literal notranslate"><span class="pre">shape</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.array.strides"><code class="docutils literal notranslate"><span class="pre">strides</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.array.ptr"><code class="docutils literal notranslate"><span class="pre">ptr</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.array.device"><code class="docutils literal notranslate"><span class="pre">device</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.array.pinned"><code class="docutils literal notranslate"><span class="pre">pinned</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.array.is_contiguous"><code class="docutils literal notranslate"><span class="pre">is_contiguous</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.array.deleter"><code class="docutils literal notranslate"><span class="pre">deleter</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.array.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.array.grad"><code class="docutils literal notranslate"><span class="pre">grad</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.array.requires_grad"><code class="docutils literal notranslate"><span class="pre">requires_grad</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.array.mark_init"><code class="docutils literal notranslate"><span class="pre">mark_init()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.array.mark_read"><code class="docutils literal notranslate"><span class="pre">mark_read()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.array.mark_write"><code class="docutils literal notranslate"><span class="pre">mark_write()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.array.zero_"><code class="docutils literal notranslate"><span class="pre">zero_()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.array.fill_"><code class="docutils literal notranslate"><span class="pre">fill_()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.array.assign"><code class="docutils literal notranslate"><span class="pre">assign()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.array.numpy"><code class="docutils literal notranslate"><span class="pre">numpy()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.array.cptr"><code class="docutils literal notranslate"><span class="pre">cptr()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.array.list"><code class="docutils literal notranslate"><span class="pre">list()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.array.to"><code class="docutils literal notranslate"><span class="pre">to()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.array.flatten"><code class="docutils literal notranslate"><span class="pre">flatten()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.array.reshape"><code class="docutils literal notranslate"><span class="pre">reshape()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.array.view"><code class="docutils literal notranslate"><span class="pre">view()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.array.contiguous"><code class="docutils literal notranslate"><span class="pre">contiguous()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.array.transpose"><code class="docutils literal notranslate"><span class="pre">transpose()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.array.ipc_handle"><code class="docutils literal notranslate"><span class="pre">ipc_handle()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multi-dimensional-arrays">Multi-dimensional Arrays</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.zeros"><code class="docutils literal notranslate"><span class="pre">zeros()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.zeros_like"><code class="docutils literal notranslate"><span class="pre">zeros_like()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.ones"><code class="docutils literal notranslate"><span class="pre">ones()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.ones_like"><code class="docutils literal notranslate"><span class="pre">ones_like()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.full"><code class="docutils literal notranslate"><span class="pre">full()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.full_like"><code class="docutils literal notranslate"><span class="pre">full_like()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.empty"><code class="docutils literal notranslate"><span class="pre">empty()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.empty_like"><code class="docutils literal notranslate"><span class="pre">empty_like()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.copy"><code class="docutils literal notranslate"><span class="pre">copy()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.clone"><code class="docutils literal notranslate"><span class="pre">clone()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#indexed-arrays">Indexed Arrays</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.indexedarray"><code class="docutils literal notranslate"><span class="pre">indexedarray</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.indexedarray.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-an-indexed-array">Creating an Indexed Array</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.indexedarray1d"><code class="docutils literal notranslate"><span class="pre">indexedarray1d()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.indexedarray2d"><code class="docutils literal notranslate"><span class="pre">indexedarray2d()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.indexedarray3d"><code class="docutils literal notranslate"><span class="pre">indexedarray3d()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.indexedarray4d"><code class="docutils literal notranslate"><span class="pre">indexedarray4d()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#interoperability-with-other-frameworks">Interoperability With Other Frameworks</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#structured-arrays">Structured Arrays</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-and-viewing-struct-arrays">Creating and Viewing Struct Arrays</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#initializing-via-numpy-and-converting-to-a-warp-array">Initializing via NumPy and Converting to a Warp Array</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nested-structs-and-vector-types">Nested Structs and Vector Types</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#local-arrays">Local Arrays</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Data Types</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scalar-types">Scalar Types</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vectors">Vectors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matrices">Matrices</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#quaternions">Quaternions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transforms">Transforms</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#structs">Structs</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-using-a-struct-in-gradient-computation">Example: Using a struct in gradient computation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-defining-operator-overloads">Example: Defining Operator Overloads</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#indexing-and-slicing">Indexing and Slicing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#type-conversions">Type Conversions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#constants">Constants</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#predefined-constants">Predefined Constants</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#operators">Operators</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#boolean-operators">Boolean Operators</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparison-operators">Comparison Operators</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#arithmetic-operators">Arithmetic Operators</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mapping-functions">Mapping Functions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.utils.map"><code class="docutils literal notranslate"><span class="pre">map()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#streams">Streams</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Stream"><code class="docutils literal notranslate"><span class="pre">Stream</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Stream.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Stream.record_event"><code class="docutils literal notranslate"><span class="pre">record_event()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Stream.wait_event"><code class="docutils literal notranslate"><span class="pre">wait_event()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Stream.wait_stream"><code class="docutils literal notranslate"><span class="pre">wait_stream()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Stream.is_complete"><code class="docutils literal notranslate"><span class="pre">is_complete</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Stream.is_capturing"><code class="docutils literal notranslate"><span class="pre">is_capturing</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Stream.priority"><code class="docutils literal notranslate"><span class="pre">priority</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.get_stream"><code class="docutils literal notranslate"><span class="pre">get_stream()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.set_stream"><code class="docutils literal notranslate"><span class="pre">set_stream()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.wait_stream"><code class="docutils literal notranslate"><span class="pre">wait_stream()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.synchronize_stream"><code class="docutils literal notranslate"><span class="pre">synchronize_stream()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.ScopedStream"><code class="docutils literal notranslate"><span class="pre">ScopedStream</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.ScopedStream.stream"><code class="docutils literal notranslate"><span class="pre">stream</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.ScopedStream.saved_stream"><code class="docutils literal notranslate"><span class="pre">saved_stream</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.ScopedStream.sync_enter"><code class="docutils literal notranslate"><span class="pre">sync_enter</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.ScopedStream.sync_exit"><code class="docutils literal notranslate"><span class="pre">sync_exit</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.ScopedStream.device"><code class="docutils literal notranslate"><span class="pre">device</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.ScopedStream.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#events">Events</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Event"><code class="docutils literal notranslate"><span class="pre">Event</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Event.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Event.ipc_handle"><code class="docutils literal notranslate"><span class="pre">ipc_handle()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Event.is_complete"><code class="docutils literal notranslate"><span class="pre">is_complete</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.record_event"><code class="docutils literal notranslate"><span class="pre">record_event()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.wait_event"><code class="docutils literal notranslate"><span class="pre">wait_event()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.synchronize_event"><code class="docutils literal notranslate"><span class="pre">synchronize_event()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.get_event_elapsed_time"><code class="docutils literal notranslate"><span class="pre">get_event_elapsed_time()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#graphs">Graphs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conditional-execution">Conditional Execution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#graph-api-reference">Graph API Reference</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.capture_begin"><code class="docutils literal notranslate"><span class="pre">capture_begin()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.capture_end"><code class="docutils literal notranslate"><span class="pre">capture_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.capture_launch"><code class="docutils literal notranslate"><span class="pre">capture_launch()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.capture_if"><code class="docutils literal notranslate"><span class="pre">capture_if()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.capture_while"><code class="docutils literal notranslate"><span class="pre">capture_while()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.capture_debug_dot_print"><code class="docutils literal notranslate"><span class="pre">capture_debug_dot_print()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.ScopedCapture"><code class="docutils literal notranslate"><span class="pre">ScopedCapture</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.ScopedCapture.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-computing-primitives">Spatial Computing Primitives</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meshes">Meshes</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Mesh"><code class="docutils literal notranslate"><span class="pre">Mesh</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Mesh.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Mesh.id"><code class="docutils literal notranslate"><span class="pre">id</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Mesh.device"><code class="docutils literal notranslate"><span class="pre">device</span></code></a></li>
</ul>
</li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Mesh.refit"><code class="docutils literal notranslate"><span class="pre">refit()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Mesh.points"><code class="docutils literal notranslate"><span class="pre">points</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Mesh.velocities"><code class="docutils literal notranslate"><span class="pre">velocities</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hash-grids">Hash Grids</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.HashGrid"><code class="docutils literal notranslate"><span class="pre">HashGrid</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.HashGrid.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.HashGrid.id"><code class="docutils literal notranslate"><span class="pre">id</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.HashGrid.device"><code class="docutils literal notranslate"><span class="pre">device</span></code></a></li>
</ul>
</li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.HashGrid.build"><code class="docutils literal notranslate"><span class="pre">build()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.HashGrid.reserve"><code class="docutils literal notranslate"><span class="pre">reserve()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#volumes">Volumes</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume"><code class="docutils literal notranslate"><span class="pre">Volume</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.CLOSEST"><code class="docutils literal notranslate"><span class="pre">CLOSEST</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.LINEAR"><code class="docutils literal notranslate"><span class="pre">LINEAR</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.array"><code class="docutils literal notranslate"><span class="pre">array()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.get_tile_count"><code class="docutils literal notranslate"><span class="pre">get_tile_count()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.get_tiles"><code class="docutils literal notranslate"><span class="pre">get_tiles()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.get_voxel_count"><code class="docutils literal notranslate"><span class="pre">get_voxel_count()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.get_voxels"><code class="docutils literal notranslate"><span class="pre">get_voxels()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.get_voxel_size"><code class="docutils literal notranslate"><span class="pre">get_voxel_size()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.GridInfo"><code class="docutils literal notranslate"><span class="pre">GridInfo</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.GridInfo.name"><code class="docutils literal notranslate"><span class="pre">name</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.GridInfo.size_in_bytes"><code class="docutils literal notranslate"><span class="pre">size_in_bytes</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.GridInfo.grid_index"><code class="docutils literal notranslate"><span class="pre">grid_index</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.GridInfo.grid_count"><code class="docutils literal notranslate"><span class="pre">grid_count</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.GridInfo.type_str"><code class="docutils literal notranslate"><span class="pre">type_str</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.GridInfo.translation"><code class="docutils literal notranslate"><span class="pre">translation</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.GridInfo.transform_matrix"><code class="docutils literal notranslate"><span class="pre">transform_matrix</span></code></a></li>
</ul>
</li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.get_grid_info"><code class="docutils literal notranslate"><span class="pre">get_grid_info()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.dtype"><code class="docutils literal notranslate"><span class="pre">dtype</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.is_index"><code class="docutils literal notranslate"><span class="pre">is_index</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.get_feature_array_count"><code class="docutils literal notranslate"><span class="pre">get_feature_array_count()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.FeatureArrayInfo"><code class="docutils literal notranslate"><span class="pre">FeatureArrayInfo</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.FeatureArrayInfo.name"><code class="docutils literal notranslate"><span class="pre">name</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.FeatureArrayInfo.ptr"><code class="docutils literal notranslate"><span class="pre">ptr</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.FeatureArrayInfo.value_size"><code class="docutils literal notranslate"><span class="pre">value_size</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.FeatureArrayInfo.value_count"><code class="docutils literal notranslate"><span class="pre">value_count</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.FeatureArrayInfo.type_str"><code class="docutils literal notranslate"><span class="pre">type_str</span></code></a></li>
</ul>
</li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.get_feature_array_info"><code class="docutils literal notranslate"><span class="pre">get_feature_array_info()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.feature_array"><code class="docutils literal notranslate"><span class="pre">feature_array()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.load_from_nvdb"><code class="docutils literal notranslate"><span class="pre">load_from_nvdb()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.save_to_nvdb"><code class="docutils literal notranslate"><span class="pre">save_to_nvdb()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.load_from_address"><code class="docutils literal notranslate"><span class="pre">load_from_address()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.load_next_grid"><code class="docutils literal notranslate"><span class="pre">load_next_grid()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.load_from_numpy"><code class="docutils literal notranslate"><span class="pre">load_from_numpy()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.allocate"><code class="docutils literal notranslate"><span class="pre">allocate()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.allocate_by_tiles"><code class="docutils literal notranslate"><span class="pre">allocate_by_tiles()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Volume.allocate_by_voxels"><code class="docutils literal notranslate"><span class="pre">allocate_by_voxels()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bounding-value-hierarchies-bvh">Bounding Value Hierarchies (BVH)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Bvh"><code class="docutils literal notranslate"><span class="pre">Bvh</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Bvh.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Bvh.id"><code class="docutils literal notranslate"><span class="pre">id</span></code></a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Bvh.device"><code class="docutils literal notranslate"><span class="pre">device</span></code></a></li>
</ul>
</li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.Bvh.refit"><code class="docutils literal notranslate"><span class="pre">refit()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-bvh-ray-traversal">Example: BVH Ray Traversal</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-bvh-volume-traversal">Example: BVH Volume Traversal</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#object-lifetime-pitfall">Object Lifetime Pitfall</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#marching-cubes">Marching Cubes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.MarchingCubes"><code class="docutils literal notranslate"><span class="pre">MarchingCubes</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.MarchingCubes.nx"><code class="docutils literal notranslate"><span class="pre">nx</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.MarchingCubes.ny"><code class="docutils literal notranslate"><span class="pre">ny</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.MarchingCubes.nz"><code class="docutils literal notranslate"><span class="pre">nz</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.MarchingCubes.domain_bounds_lower_corner"><code class="docutils literal notranslate"><span class="pre">domain_bounds_lower_corner</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.MarchingCubes.domain_bounds_upper_corner"><code class="docutils literal notranslate"><span class="pre">domain_bounds_upper_corner</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.MarchingCubes.verts"><code class="docutils literal notranslate"><span class="pre">verts</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.MarchingCubes.indices"><code class="docutils literal notranslate"><span class="pre">indices</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.MarchingCubes.device"><code class="docutils literal notranslate"><span class="pre">device</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.MarchingCubes.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.MarchingCubes.resize"><code class="docutils literal notranslate"><span class="pre">resize()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.MarchingCubes.surface"><code class="docutils literal notranslate"><span class="pre">surface()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.MarchingCubes.extract_surface_marching_cubes"><code class="docutils literal notranslate"><span class="pre">extract_surface_marching_cubes()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#profiling">Profiling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interprocess-communication-ipc">Interprocess Communication (IPC)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.from_ipc_handle"><code class="docutils literal notranslate"><span class="pre">from_ipc_handle()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.event_from_ipc_handle"><code class="docutils literal notranslate"><span class="pre">event_from_ipc_handle()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lto-cache">LTO Cache</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.clear_lto_cache"><code class="docutils literal notranslate"><span class="pre">clear_lto_cache()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-management">Module Management</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.compile_aot_module"><code class="docutils literal notranslate"><span class="pre">compile_aot_module()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#warp.load_aot_module"><code class="docutils literal notranslate"><span class="pre">load_aot_module()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/NVIDIA/warp/edit/v1.9.1/docs/modules/runtime.rst">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

</div></div>
              
            

          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
<a class="footer-brand logo" href="https://www.nvidia.com">
  <img src="../_static/nvidia-logo-horiz-rgb-1c-blk-for-screen.svg" class="logo__image only-light" alt="NVIDIA"/>
  <img src="../_static/nvidia-logo-horiz-rgb-1c-wht-for-screen.svg" class="logo__image only-dark" alt="NVIDIA"/>
</a></div>
      
        <div class="footer-item">




  <p class="copyright">
    
      Copyright © 2022-2025 NVIDIA Corporation.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
  
</div>

  </footer>
  </body>
</html>